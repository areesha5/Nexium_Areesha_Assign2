!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="dd1c933a-299d-4c3f-951c-fdee124e3253",e._sentryDebugIdIdentifier="sentry-dbid-dd1c933a-299d-4c3f-951c-fdee124e3253")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7246],{4195:(e,n,t)=>{"use strict";t.d(n,{O:()=>c});var a=t(32144),r=t(80251),s=t(73969),i=t(48678),o=t(82681);async function l(e){let{id:n,branchName:t,gitBranch:a,persistent:r,requestReview:s}=e,{data:o,error:l}=await (0,i.F6)("/v1/branches/{branch_id}",{params:{path:{branch_id:n}},body:{branch_name:t,git_branch:a,persistent:r,request_review:s}});return l&&(0,i.H4)(l),o}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,r.n)(e=>l(e),{async onSuccess(n,t,a){let{projectRef:r}=t;await i.invalidateQueries(o.N.list(r)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?s.oR.error("Failed to update branch: ".concat(e.message)):n(e,t,a)},...t})}},9951:(e,n,t)=>{"use strict";t.d(n,{b:()=>o});var a=t(56947),r=t(48678),s=t(63188);async function i(e,n){let{organization_integration_id:t}=e;if(!t)throw Error("organization_integration_id is required");let{data:a,error:s}=await (0,r.Jt)("/platform/integrations/vercel/projects/{organization_integration_id}",{params:{path:{organization_integration_id:t},query:{limit:1e3}},signal:n});return s&&(0,r.H4)(s),a.projects}let o=function(e){let{organization_integration_id:n}=e,{enabled:t=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.Z.vercelProjectList(n),e=>{let{signal:t}=e;return i({organization_integration_id:n},t)},{enabled:t&&void 0!==n,...r})}},11243:(e,n,t)=>{"use strict";t.d(n,{I:()=>o,U:()=>l});var a=t(48678),r=t(29760),s=t(90043);async function i(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=await (0,a.x8)(e);if(!t.ok)return{error:new r.o(t.statusText,t.status)};try{return n?await t.json():await t.text()}catch(e){return{error:new r.o(e.message,500)}}}async function o(e){var n,t;if(!e)return null;let[,,,a,r,,o,...l]=null!=(t=null==e?void 0:e.split("/"))?t:[],c=l.join("/"),d="https://api.github.com/repos/".concat(a,"/").concat(r,"/contents/").concat(c),u="".concat(d,"/supabase?ref=").concat(o),m="".concat(d,"/").concat("supabase/migrations").concat(o?"?ref=".concat(o):""),[x,h]=await Promise.all([i(u),i(m)]);if(!(0,s.IP)(x))return console.warn("Failed to fetch supabase files from GitHub: ".concat(x.error)),null;if(!(0,s.IP)(h))return console.warn("Failed to fetch migration files from GitHub: ".concat(h.error)),null;let p=null==(n=x.find(e=>"seed.sql"===e.name))?void 0:n.download_url,f=h.sort((e,n)=>e.name<n.name?-1:+(e.name>n.name)),g=f.map(e=>i(e.download_url,!1)),[y,...j]=await Promise.all([p?i(p,!1):Promise.resolve(""),...g]),v=j.filter(e=>(0,s.IP)(e)).join(";"),b=(0,s.IP)(y)?y:"",w="\n    create schema if not exists supabase_migrations;\n    create table if not exists supabase_migrations.schema_migrations (\n      version text not null primary key,\n      statements text[],\n      name text\n    );\n    ".concat(f.map((e,n)=>{let t=j[n];if(!(0,s.IP)(t))return"";let a=e.name.split("_")[0],r=JSON.stringify(t.split(";").map(e=>e.trim()).filter(Boolean));return"\n        insert into supabase_migrations.schema_migrations (version, statements, name)\n        select '".concat(a,"', array_agg(jsonb_statements)::text[], '").concat(e.name,"'\n        from jsonb_array_elements_text($statements$").concat(r,"$statements$::jsonb) as jsonb_statements;\n      ")}),"\n  ");return"".concat(v,";").concat(w,";").concat(b)}function l(e){var n,t,a,r,s,i,o,l;return"Vercel"===e.integration.name?(n=e,"https://vercel.com/dashboard/".concat((null==(t=n.metadata)?void 0:t.account.type)==="Team"?"".concat(null==(a=n.metadata)?void 0:a.account.team_slug,"/"):"","integrations/").concat(null==(r=n.metadata)?void 0:r.configuration_id)):"GitHub"===e.integration.name?(s=e,"https://github.com/".concat((null==(i=s.metadata)?void 0:i.account.type)==="Organization"?"organizations/".concat(null==(o=s.metadata)?void 0:o.account.name,"/"):"","settings/installations/").concat(null==(l=s.metadata)?void 0:l.installation_id)):""}},15910:(e,n,t)=>{"use strict";t.d(n,{L:()=>c});var a=t(32144),r=t(80251),s=t(73969),i=t(48678),o=t(63188);async function l(e,n){let{connectionId:t}=e,{data:a,error:r}=await (0,i.yH)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n});return r&&(0,i.H4)(r),a}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,r.n)(e=>l(e),{async onSuccess(n,t,a){await Promise.all([i.invalidateQueries(o.Z.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?s.oR.error("Failed to delete Github connection: ".concat(e.message)):n(e,t,a)},...t})}},18192:(e,n,t)=>{"use strict";t.d(n,{T:()=>d});var a=t(32144),r=t(80251),s=t(73969),i=t(48678),o=t(23172),l=t(63188);async function c(e){let{organizationIntegrationId:n,connection:t}=e,{data:a,error:r}=await (0,i.bE)("/platform/integrations/vercel/connections",{body:{organization_integration_id:n,connection:{foreign_project_id:t.foreign_project_id,supabase_project_ref:t.supabase_project_ref,metadata:t.metadata}}});return r&&(0,i.H4)(r),a}let d=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)(),d=(0,o.yr)();return(0,r.n)(e=>c(e),{async onSuccess(n,t,a){await Promise.all([i.invalidateQueries(l.Z.integrationsList()),i.invalidateQueries(l.Z.integrationsListWithOrg(t.orgSlug)),i.invalidateQueries(l.Z.vercelProjectList(t.organizationIntegrationId)),i.invalidateQueries(l.Z.vercelConnectionsList(t.organizationIntegrationId))]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){d.setLoading(!1),void 0===n?s.oR.error("Failed to create connection: ".concat(e.message)):n(e,t,a)},...t})}},23172:(e,n,t)=>{"use strict";t.d(n,{yr:()=>i});var a=t(56028),r=t(12532);let s=(0,a.BX)({loading:!1,setLoading:e=>{s.loading=e}}),i=e=>(0,r.s)(s,e)},24717:(e,n,t)=>{"use strict";t.d(n,{BS:()=>o,Dm:()=>d,HJ:()=>j,Rf:()=>g,Uw:()=>c,Vw:()=>w,Xr:()=>b,aw:()=>p,bV:()=>i,cJ:()=>x,dX:()=>u,eh:()=>l,fh:()=>v,gu:()=>m,sZ:()=>h,tn:()=>y,xp:()=>f});var a=t(80263),r=t(53239),s=t(82457);let i="mx-auto w-full max-w-[1200px]",o="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",l=(0,r.forwardRef)((e,n)=>{let{className:t,bottomPadding:r,size:i="default",...l}=e;return(0,a.jsx)("div",{ref:n,...l,className:(0,s.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[i],o,r&&"pb-16",t)})}),c=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("header",{...r,ref:n,className:(0,s.cn)("w-full","flex-col gap-3 py-6",t)})}),d=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("h1",{ref:n,...r,className:(0,s.cn)("text-2xl",t)})}),u=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:n,...r,className:(0,s.cn)("text-sm text-foreground-light",t)})}),m=(0,r.forwardRef)((e,n)=>{let{className:t,isFullWidth:r,topPadding:i,...o}=e;return(0,a.jsx)("div",{ref:n,...o,className:(0,s.cn)("flex flex-col first:pt-12 py-6",r?"w-full":"gap-3 lg:grid md:grid-cols-12",t)})}),x=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("w-full h-px bg-border",t)})}),h=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:n,...r,className:(0,s.cn)("text-foreground text-xl",t)})}),p=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:n,...r,className:(0,s.cn)("text-sm text-foreground-light",t)})}),f=(0,r.forwardRef)((e,n)=>{let{className:t,children:r,title:i,...o}=e;return(0,a.jsxs)("div",{ref:n,...o,className:(0,s.cn)("col-span-4 xl:col-span-5 prose text-sm",t),children:[i&&(0,a.jsx)("h2",{children:i}),r]})}),g=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",t)})}),y=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-col gap-3 items-center",t)})}),j=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex w-full items-center",t)})}),v=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-row gap-3",t)})}),b=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-col gap-3","min-w-[420px]",t)})}),w=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)(i,o,"my-8 flex flex-col gap-8",t)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",l.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",b.displayName="ScaffoldColumn",f.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",y.displayName="ScaffoldFilterAndContent",j.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",w.displayName="ScaffoldContainerLegacy",h.displayName="ScaffoldSectionTitle",p.displayName="ScaffoldSectionDescription"},27488:(e,n,t)=>{"use strict";t.d(n,{A:()=>N});var a=t(80263),r=t(30075),s=t.n(r),i=t(53239),o=t(73969),l=t(25481),c=t(30981),d=t(63837),u=t(63809),m=t(58078),x=t(77022),h=t(18192),p=t(9951),f=t(32912),g=t(45628),y=t(32211),j=t(2525),v=t(36710),b=t(96993);let w=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:"w-6",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})}),N=()=>{let{ref:e}=(0,l.g)(),n=(0,g.a)(),t=(0,v.bZ)(),r=t.vercelConnectionsIntegrationId,{data:N}=(0,x.$)({orgSlug:null==n?void 0:n.slug}),_=null==N?void 0:N.filter(e=>"Vercel"===e.integration.name),S=null==_?void 0:_.find(e=>e.id===r),{data:C}=(0,f.el)({enabled:void 0!==r}),I=(0,i.useMemo)(()=>{var e;return null!=(e=null==C?void 0:C.filter(e=>e.organization_id===(null==n?void 0:n.id)).map(e=>({name:e.name,ref:e.ref})))?e:j.Oj},[null==n?void 0:n.id,C]),{data:k}=(0,p.b)({organization_integration_id:r},{enabled:void 0!==r}),P=(0,i.useMemo)(()=>null!=k?k:j.Oj,[k]),R=(0,i.useMemo)(()=>s()(P,"id"),[P]),A=(0,i.useCallback)(e=>{let n=R[e.id];return(null==n?void 0:n.framework)?(0,a.jsx)("img",{src:"".concat(y.o2,"/img/icons/frameworks/").concat(n.framework,".svg"),width:21,height:21,alt:"icon"}):m.d},[R]),{mutate:E,isLoading:L}=(0,h.T)({async onSuccess(e){let{env_sync_error:n}=e;n&&o.oR.error("Failed to sync environment variables: ".concat(n.message,". Please try re-syncing manually from settings.")),t.setVercelConnectionsOpen(!1)}}),V=(0,i.useCallback)(e=>{E({...e,connection:{...e.connection,metadata:{...e.connection.metadata,supabaseConfig:{projectEnvVars:{write:!0}}}}})},[E]);return(0,a.jsx)(b.Ay,{hideFooter:!0,size:"large",header:"Add new Vercel project connection",visible:t.vercelConnectionsOpen,onCancel:()=>t.setVercelConnectionsOpen(!1),"data-sentry-element":"SidePanel","data-sentry-component":"SidePanelVercelProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsxs)("div",{className:"py-6 flex flex-col gap-6 bg-studio h-full",children:[(0,a.jsx)(b.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)(u.o,{content:"\n### Choose repository to connect to\n\nCheck the details below before proceeding\n          ","data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})}),(0,a.jsxs)(b.Ay.Content,{className:"flex flex-col gap-2","data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:[(0,a.jsx)(d.A,{defaultSupabaseProjectRef:e,organizationIntegrationId:null==S?void 0:S.id,foreignProjects:P,supabaseProjects:I,onCreateConnections:V,installedConnections:null==S?void 0:S.connections,isLoading:L,integrationIcon:w,getForeignProjectIcon:A,choosePrompt:"Choose Vercel Project",mode:"Vercel","data-sentry-element":"ProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"}),(0,a.jsx)(u.o,{content:"\nThe following environment variables will be added:\n\n".concat(c.O.map(e=>"\n - `".concat(e,"`")),"\n"),"data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})]}),(0,a.jsx)(b.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{className:"border px-10"})})})]})})}},30075:(e,n,t)=>{var a=t(50117);e.exports=t(16658)(function(e,n,t){a(e,t,n)})},30981:(e,n,t)=>{"use strict";t.d(n,{O:()=>a});let a=Object.values({POSTGRES_URL:{key:"POSTGRES_URL",type:"encrypted"},POSTGRES_PRISMA_URL:{key:"POSTGRES_PRISMA_URL",type:"encrypted"},POSTGRES_URL_NON_POOLING:{key:"POSTGRES_URL_NON_POOLING",type:"encrypted"},POSTGRES_USER:{key:"POSTGRES_USER",type:"encrypted"},POSTGRES_HOST:{key:"POSTGRES_HOST",type:"encrypted"},POSTGRES_PASSWORD:{key:"POSTGRES_PASSWORD",type:"encrypted"},POSTGRES_DATABASE:{key:"POSTGRES_DATABASE",type:"encrypted"},SUPABASE_ANON_KEY:{key:"SUPABASE_ANON_KEY",type:"encrypted"},SUPABASE_URL:{key:"SUPABASE_URL",type:"encrypted"},SUPABASE_SERVICE_ROLE_KEY:{key:"SUPABASE_SERVICE_ROLE_KEY",type:"encrypted"},SUPABASE_JWT_SECRET:{key:"SUPABASE_JWT_SECRET",type:"encrypted"},NEXT_PUBLIC_SUPABASE_ANON_KEY:{key:"NEXT_PUBLIC_SUPABASE_ANON_KEY",type:"encrypted"},NEXT_PUBLIC_SUPABASE_URL:{key:"NEXT_PUBLIC_SUPABASE_URL",type:"encrypted"}}).map(e=>e.key)},35443:(e,n,t)=>{"use strict";t.d(n,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>i,aR:()=>o,wL:()=>u});var a=t(80263),r=t(53239),s=t(82457);let i=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("rounded-lg border bg-surface-100 text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let o=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("flex flex-col space-y-1.5 py-4 px-6 border-b",t),...r})});o.displayName="CardHeader";let l=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:n,className:(0,s.cn)("text-xs font-mono uppercase",t),...r})});l.displayName="CardTitle";let c=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:n,className:(0,s.cn)("text-sm text-foreground-muted",t),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)("py-4 px-6 border-b last:border-none",t),...r})});d.displayName="CardContent";let u=r.forwardRef((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,className:(0,s.cn)(" flex items-center py-4 px-6",t),...r})});u.displayName="CardFooter"},36710:(e,n,t)=>{"use strict";t.d(n,{bZ:()=>i});var a=t(56028),r=t(12532);let s=(0,a.BX)({vercelConnectionsOpen:!1,setVercelConnectionsOpen:e=>{s.vercelConnectionsOpen=e},vercelConnectionsIntegrationId:void 0,setVercelConnectionsIntegrationId:e=>{s.vercelConnectionsIntegrationId=e}}),i=e=>(0,r.s)(s,e)},58078:(e,n,t)=>{"use strict";t.d(n,{d:()=>s});var a=t(80263),r=t(41741);let s=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-black p-1",children:(0,a.jsx)("svg",{className:"m-auto fill-current text-white",width:"12px",height:"12px",viewBox:"0 0 1155 1000",children:(0,a.jsx)("path",{d:"M577.344 0L1154.69 1000H0L577.344 0Z"})})});r.A},62366:(e,n,t)=>{"use strict";t.d(n,{S:()=>_});var a=t(80263),r=t(47330),s=t(58394),i=t(24716),o=t(98990),l=t(8758),c=t.n(l),d=t(87355),u=t(53239),m=t(73969),x=t(65144),h=t(13933),p=t(80251),f=t(48678);async function g(e){let{connectionId:n}=e,{data:t,error:a}=await (0,f.bE)("/platform/integrations/vercel/connections/{connection_id}/sync-envs",{params:{path:{connection_id:n}}});return a&&(0,f.H4)(a),t}let y=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,p.n)(e=>g(e),{async onSuccess(n,t,a){await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?m.oR.error("Failed to sync environment variables: ".concat(e.message)):n(e,t,a)},...t})};var j=t(32912),v=t(42206),b=t(37263),w=t(54097),N=t(45628);let _=(0,u.forwardRef)((e,n)=>{let{disabled:t,onDeleteConnection:l,...p}=e,f=(0,d.useRouter)(),g=(0,N.a)(),{type:_,connection:S}=p,{data:C}=(0,j.el)(),I=null==C?void 0:C.find(e=>e.ref===S.supabase_project_ref),k=(null==I?void 0:I.is_branch_enabled)===!0,[P,R]=(0,u.useState)(!1),[A,E]=(0,u.useState)(!1),[L,V]=(0,u.useState)(!1),G=(0,u.useCallback)(async()=>{try{E(!0),await l(S)}catch(e){}finally{E(!1),R(!1)}},[S,l]),z=(0,u.useCallback)(()=>{R(!1)},[]),{mutate:F,isLoading:H}=y({onSuccess:()=>{m.oR.success("Successfully synced environment variables"),V(!1)}}),T=(0,u.useCallback)(async()=>{F({connectionId:S.id})},[S,F]),O="/project/[ref]/settings/integrations";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.LT,{showNode:!1,actions:t?(0,a.jsx)(h.G,{disabled:!0,iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this connection"}},children:"Manage"}):(0,a.jsxs)(v.rI,{open:L,onOpenChange:()=>V(!L),modal:!1,children:[(0,a.jsx)(v.ty,{asChild:!0,children:(0,a.jsx)(b.$,{iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})})}),(0,a.jsxs)(v.SQ,{side:"bottom",align:"end",children:[f.pathname!==O&&(0,a.jsx)(v._2,{asChild:!0,children:(0,a.jsx)(c(),{href:O.replace("[ref]",S.supabase_project_ref),children:"Configure connection"})}),"Vercel"===_&&(null==g?void 0:g.managed_by)!=="vercel-marketplace"&&(0,a.jsxs)(v._2,{className:"space-x-2",onSelect:e=>{e.preventDefault(),T()},disabled:H,children:[H?(0,a.jsx)(s.A,{className:"animate-spin",size:14}):(0,a.jsx)(i.A,{size:14}),(0,a.jsx)("p",{children:"Resync environment variables"})]}),("Vercel"===_&&(null==g?void 0:g.managed_by)!=="vercel-marketplace"||f.pathname!==O)&&(0,a.jsx)(v.mB,{}),(0,a.jsxs)(v._2,{className:"space-x-2",onSelect:()=>R(!0),children:[(0,a.jsx)(o.A,{size:14}),(0,a.jsx)("p",{children:"Delete connection"})]})]})]}),...p}),(0,a.jsx)(w.A,{variant:"destructive",size:"GitHub"===_&&k?"medium":"small",visible:P,title:"Confirm to delete ".concat(_," connection"),confirmLabel:"Delete connection",onCancel:z,onConfirm:G,loading:A,children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Deleting this GitHub connection will stop automatic creation and merging of preview branches. Existing preview branches will remain unchanged."})})]})});_.displayName="IntegrationConnectionItem"},63837:(e,n,t)=>{"use strict";t.d(n,{A:()=>y});var a=t(80263),r=t(47330),s=t(55060),i=t(87355),o=t(53239),l=t(73969),c=t(8991),d=t(45628),u=t(32211),m=t(82868),x=t(2525),h=t(82457),p=t(67928),f=t(37263),g=t(85936);let y=e=>{var n,t,y,j;let{organizationIntegrationId:v,foreignProjects:b,supabaseProjects:w,onCreateConnections:N,installedConnections:_=x.Oj,isLoading:S,integrationIcon:C,getForeignProjectIcon:I,choosePrompt:k="Choose a project",onSkip:P,loadingForeignProjects:R,loadingSupabaseProjects:A,showNoEntitiesState:E=!0,defaultSupabaseProjectRef:L,defaultForeignProjectId:V,mode:G}=e,z=(0,i.useRouter)(),[F,H]=(0,o.useState)(!1),[T,O]=(0,o.useState)(!1),B=(0,o.useRef)(null),M=(0,o.useRef)(null),D=(0,d.a)(),[U,$]=(0,o.useState)(L);(0,o.useEffect)(()=>{void 0!==L&&void 0===U&&$(L)},[L,U]);let[Z,J]=(0,o.useState)(V);(0,o.useEffect)(()=>{void 0!==V&&void 0===Z&&J(V)},[V,Z]);let W=new Set(_.map(e=>e.foreign_project_id)),Y=U?w.find(e=>{var n;return(null==(n=e.ref)?void 0:n.toLowerCase())===(null==U?void 0:U.toLowerCase())}):void 0,Q=Z?b.find(e=>{var n;return(null==(n=e.id)?void 0:n.toLowerCase())===(null==Z?void 0:Z.toLowerCase())}):void 0,X=e=>{let{children:n,className:t,...r}=e;return(0,a.jsx)("div",{className:(0,h.cn)("flex-1 min-w-0 flex flex-col grow gap-6 px-5 mx-auto w-full justify-center items-center",t),...r,"data-sentry-component":"Panel","data-sentry-source-file":"ProjectLinker.tsx",children:n})},q=0===w.length,K=0===b.length,ee=q?"Supabase":G,en=q?G:"Supabase";return(0,a.jsxs)("div",{className:"flex flex-col bg border shadow rounded-lg overflow-hidden","data-sentry-component":"ProjectLinker","data-sentry-source-file":"ProjectLinker.tsx",children:[(0,a.jsxs)("div",{className:"relative p-12 border-b border-muted",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-grid-black/5 [mask-image:linear-gradient(0deg,#fff,rgba(255,255,255,0.6))] dark:bg-grid-white/5 dark:[mask-image:linear-gradient(0deg,rgba(255,255,255,0.1),rgba(255,255,255,0.5))]",style:{backgroundPosition:"10px 10px"}}),R||A?(0,a.jsxs)("div",{className:"w-1/2 mx-auto space-y-2 py-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground text-center",children:"Loading projects"}),(0,a.jsx)(c.A,{active:!0})]}):E&&(q||K)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("h5",{className:"text-foreground",children:["No ",ee," Projects found"]}),(0,a.jsxs)("p",{className:"text-foreground-light text-sm",children:["You will need to create a ",ee," Project to link to a ",en," ","Project.",(0,a.jsx)("br",{}),"You can skip this and create a Project Connection later."]})]}):(0,a.jsxs)("div",{className:"flex justify-center gap-0 w-full relative",children:[(0,a.jsxs)(X,{children:[(0,a.jsx)("div",{className:"bg-white shadow border rounded p-1 w-12 h-12 flex justify-center items-center",children:(0,a.jsx)("img",{src:"".concat(u.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-6"})}),(0,a.jsxs)(p.AM,{open:F,onOpenChange:H,children:[(0,a.jsx)(p.Wv,{asChild:!0,children:(0,a.jsx)(f.$,{ref:B,type:"default",block:!0,disabled:void 0!==L||A,loading:A,className:"justify-start h-[34px]",icon:(0,a.jsx)("div",{className:"bg-white shadow border rounded p-1 w-6 h-6 flex justify-center items-center",children:(0,a.jsx)("img",{src:"".concat(u.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-4"})}),iconRight:void 0===L?(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(r.A,{})}):null,children:Y?Y.name:"Choose Supabase Project"})}),(0,a.jsx)(p.hl,{className:"p-0 !w-72",side:"bottom",align:"center",style:{width:null==(n=B.current)?void 0:n.offsetWidth},children:(0,a.jsxs)(g.uB,{children:[(0,a.jsx)(g.G7,{placeholder:"Search for a project"}),(0,a.jsxs)(g.oI,{className:"!max-h-[170px]",children:[(0,a.jsx)(g.xL,{children:"No results found."}),(0,a.jsxs)(g.L$,{children:[w.map((e,n)=>(0,a.jsxs)(g.h_,{value:"".concat(e.name.replaceAll('"',""),"-").concat(n),className:"flex gap-2 items-center",onSelect:()=>{e.ref&&$(e.ref),H(!1)},children:[(0,a.jsx)("div",{className:"bg-white shadow border rounded p-1 w-6 h-6 flex justify-center items-center",children:(0,a.jsx)("img",{src:"".concat(u.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-4"})}),(0,a.jsx)("span",{children:e.name})]},e.ref)),0===w.length&&(0,a.jsx)("p",{className:"text-xs text-foreground-lighter px-2 py-2",children:"No projects found in this organization"})]}),(0,a.jsx)(g.fx,{}),(0,a.jsx)(g.L$,{children:(0,a.jsxs)(g.h_,{className:"flex gap-2 items-center cursor-pointer",onClick:()=>z.push("/new/".concat(null==D?void 0:D.slug)),onSelect:()=>z.push("/new/".concat(null==D?void 0:D.slug)),children:[(0,a.jsx)(s.A,{size:16}),(0,a.jsx)("span",{children:"Create a new project"})]})})]})]})})]})]}),(0,a.jsx)("div",{className:"border border-foreground-lighter h-px w-8 border-dashed self-end mb-4"}),(0,a.jsxs)(X,{children:[(0,a.jsx)("div",{className:"bg-black shadow rounded p-1 w-12 h-12 flex justify-center items-center",children:C}),(0,a.jsxs)(p.AM,{open:T,onOpenChange:O,children:[(0,a.jsx)(p.Wv,{asChild:!0,children:(0,a.jsx)(f.$,{ref:M,type:"default",block:!0,disabled:R,loading:R,className:"justify-start h-[34px]",icon:(0,a.jsx)("div",{children:Q&&null!=(y=null==I?void 0:I(Q))?y:C}),iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(r.A,{})}),children:null!=(j=Q&&Q.name)?j:k})}),(0,a.jsx)(p.hl,{className:"p-0 !w-72",side:"bottom",align:"center",style:{width:null==(t=M.current)?void 0:t.offsetWidth},children:(0,a.jsxs)(g.uB,{children:[(0,a.jsx)(g.G7,{placeholder:"Search for a project"}),(0,a.jsxs)(g.oI,{className:"!max-h-[170px]",children:[(0,a.jsx)(g.xL,{children:"No results found."}),(0,a.jsxs)(g.L$,{children:[b.map((e,n)=>{var t;return(0,a.jsxs)(g.h_,{value:"".concat(e.name.replaceAll('"',""),"-").concat(n),className:"flex gap-2 items-center",onSelect:()=>{e.id&&J(e.id),O(!1)},children:[(0,a.jsx)("div",{children:null!=(t=null==I?void 0:I(e))?t:C}),(0,a.jsx)("span",{className:"truncate",title:e.name,children:e.name})]},e.id)}),0===b.length&&(0,a.jsx)(g.xL,{children:"No results found."})]}),"GitHub"===G&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.fx,{}),(0,a.jsx)(g.L$,{children:(0,a.jsxs)(g.h_,{className:"flex gap-2 items-center cursor-pointer",onSelect:()=>(0,m.Fd)("install"),children:[(0,a.jsx)(s.A,{size:16}),"Add GitHub Repositories"]})})]})]})]})})]})]})]})]}),(0,a.jsxs)("div",{className:"flex w-full justify-end gap-2 p-4 bg-surface-75",children:[void 0!==P&&(0,a.jsx)(f.$,{size:"medium",type:"default",onClick:()=>{P()},children:"Skip"}),(0,a.jsx)(f.$,{size:"medium",className:"self-end",onClick:function(){return(null==Q?void 0:Q.id)?(null==Y?void 0:Y.ref)?W.has(null!=Z?Z:"")?l.oR.error("Unable to connect to ".concat(Q.name,": Selected repository already has an installed connection to a project")):void N({organizationIntegrationId:v,connection:{foreign_project_id:null==Q?void 0:Q.id,supabase_project_ref:null==Y?void 0:Y.ref,integration_id:"0",metadata:{...Q}},orgSlug:null==D?void 0:D.slug,new:{installation_id:Q.installation_id,project_ref:Y.ref,repository_id:Number(Q.id)}}):console.error("No Supabase project ref set"):console.error("No Foreign project ID set")},loading:S,disabled:R||A||S||!Y||!Q,"data-sentry-element":"Button","data-sentry-source-file":"ProjectLinker.tsx",children:"Connect project"})]})]})}},64477:(e,n,t)=>{"use strict";t.d(n,{d:()=>d});var a=t(80263),r=t(44893),s=t(79279),i=t(53239),o=t(82457);let l=(0,s.F)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,s.F)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=i.forwardRef((e,n)=>{let{className:t,size:s,...i}=e;return(0,a.jsx)(r.bL,{className:(0,o.cn)(l({size:s}),t),...i,ref:n,children:(0,a.jsx)(r.zi,{className:(0,o.cn)(c({size:s}))})})});d.displayName=r.bL.displayName},65144:(e,n,t)=>{"use strict";t.d(n,{LT:()=>S,MJ:()=>I,Q7:()=>k,Tt:()=>_});var a=t(80263),r=t(53434),s=t.n(r),i=t(18567),o=t(90354),l=t(83298),c=t(32491),d=t.n(c),u=t(8758),m=t.n(u),x=t(53239),h=t(63809),p=t(13933),f=t(32912),g=t(32211),y=t(11243),j=t(82457),v=t(72470),b=t(37263);let w=e=>{let{type:n,className:t}=e;switch(n){case"GitHub":return(0,a.jsx)(i.A,{strokeWidth:2,size:14});case"Vercel":return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:(0,j.cn)("w-3.5",t),children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})});case"Supabase":return(0,a.jsx)("img",{src:"".concat(g.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-3.5"});default:return(0,a.jsx)(a.Fragment,{})}},N=e=>{let{src:n}=e;return(0,a.jsx)("div",{className:"relative border shadow-lg w-8 h-8 rounded-full overflow-hidden","data-sentry-component":"Avatar","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(d(),{src:n||"",width:30,height:30,layout:"fill",alt:"avatar",className:"relative","data-sentry-element":"Image","data-sentry-source-file":"IntegrationPanels.tsx"})})},_=(0,x.forwardRef)((e,n)=>{var t,r,i,l,c;let{integration:d,disabled:u,...x}=e;return(0,a.jsxs)("li",{ref:n,className:"bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg",...x,children:[(0,a.jsxs)("div",{className:"flex gap-6 items-center",children:[(0,a.jsx)("div",{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"flex -space-x-1",children:[(0,a.jsx)(()=>(0,a.jsx)("div",{className:"bg-black text-white w-8 h-8 rounded flex items-center justify-center","data-sentry-component":"IntegrationIconBlock","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(w,{type:d.integration.name,"data-sentry-element":"HandleIcon","data-sentry-source-file":"IntegrationPanels.tsx"})}),{}),(0,a.jsx)(N,{src:null==d||null==(t=d.metadata)?void 0:t.account.avatar})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-foreground text-sm font-medium",children:(null==(r=d.metadata)?void 0:r.account.name)||void 0!==d.metadata&&"gitHubConnectionOwner"in d.metadata&&(null==(i=d.metadata)?void 0:i.gitHubConnectionOwner)}),(0,a.jsx)(v.E,{className:"capitalize",children:null==(l=d.metadata)?void 0:l.account.type})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Created ",s()(d.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==d||null==(c=d.added_by)?void 0:c.primary_email]})]})]})]}),(0,a.jsx)(b.$,{asChild:!0,disabled:u,type:"default",iconRight:(0,a.jsx)(o.A,{}),children:u?(0,a.jsx)("p",{children:"Manage"}):(0,a.jsx)(m(),{href:(0,y.U)(d),target:"_blank",rel:"noopener noreferrer",children:"Manage"})})]},d.id)}),S=(0,x.forwardRef)((e,n)=>{var t,r,i,o,c;let{connection:d,type:u,actions:m,showNode:x=!0,orientation:h="horizontal",className:p,...y}=e,{data:v}=(0,f.el)(),b=null==v?void 0:v.find(e=>e.ref===d.supabase_project_ref);return(0,a.jsxs)("li",{ref:n,...y,className:(0,j.cn)(x&&"pl-8 ml-6 border-l border-muted","relative"),children:[x&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-10 -left-px"}),(0,a.jsxs)("div",{className:(0,j.cn)("horizontal"===h?"flex items-center justify-between gap-2":"flex flex-col gap-3","bg-surface-100 border shadow-sm px-6 py-4 rounded-lg",p),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex gap-x-2 items-center max-w-40 ",children:[(0,a.jsx)(w,{type:"Supabase"}),(0,a.jsx)("span",{title:null==b?void 0:b.name,className:"text-sm truncate",children:null==b?void 0:b.name})]}),(0,a.jsx)(l.A,{size:14,className:"flex-shrink-0 text-foreground-lighter",strokeWidth:1.5}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex gap-2 items-center",children:[(null==d||null==(t=d.metadata)?void 0:t.framework)?(0,a.jsx)("img",{src:"".concat(g.o2,"/img/icons/frameworks/").concat(d.metadata.framework,".svg"),width:21,height:21,alt:"icon"}):(0,a.jsx)("div",{className:"bg-black text-white w-4 h-4 rounded flex items-center justify-center",children:(0,a.jsx)(w,{type:u,className:"!w-2.5"})}),"GitHub"===u?(0,a.jsx)("a",{title:d.metadata.name,href:"https://github.com/".concat(null==(r=d.metadata)?void 0:r.name),className:"text-sm truncate",target:"_blank",rel:"noreferrer",children:null==(i=d.metadata)?void 0:i.name}):(0,a.jsx)("span",{title:d.metadata.name,className:"text-sm truncate",children:null==(o=d.metadata)?void 0:o.name})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",s()(null==d?void 0:d.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==d||null==(c=d.added_by)?void 0:c.primary_email]})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:m})]})]},d.id)}),C=(0,x.forwardRef)((e,n)=>{let{connection:t,type:r,...i}=e,{data:o}=(0,f.el)(),c=null==o?void 0:o.find(e=>e.ref===t.supabase_project_ref);return(0,a.jsxs)("li",{ref:n,...i,className:(0,j.cn)("bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(w,{type:"Supabase"}),(0,a.jsx)("span",{className:"text-sm",children:null==c?void 0:c.name}),(0,a.jsx)(l.A,{size:14,className:"text-foreground-lighter",strokeWidth:1.5}),(0,a.jsx)(w,{type:r}),(0,a.jsx)("span",{className:"text-sm",children:t.metadata.name})]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",s()(t.inserted_at).fromNow()]})]}),(0,a.jsx)(b.$,{type:"default",children:"Connect"})]},t.id)}),I=(0,x.forwardRef)((e,n)=>{let{className:t,showNode:r=!0,onClick:s,disabled:i,...o}=e;return(0,a.jsxs)("div",{ref:n,...o,className:(0,j.cn)(r&&"ml-6 pl-8 mt-4 border-l","relative pb-2","last:border-l-transparent",t),children:[r&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-14 -top-4 -left-px"}),(0,a.jsx)("div",{className:(0,j.cn)("w-full","border border-dashed bg-surface-100 border-overlay","flex h-20 px-10 rounded-lg justify-center items-center"),children:(0,a.jsx)(p.G,{type:"default",disabled:i,onClick:()=>s(),tooltip:{content:{side:"bottom",text:i?"Additional permissions required to add connection":void 0}},children:"Add new project connection"})})]})}),k=(0,x.forwardRef)((e,n)=>{let{className:t,markdown:r="",showNode:s=!0,...i}=e;return(0,a.jsxs)("div",{...i,ref:n,className:(0,j.cn)(s&&"border-l border-muted ml-6 pl-8","py-4 prose text-sm",t),children:[i.title&&(0,a.jsx)("h5",{className:"text-foreground",children:i.title}),(0,a.jsx)(h.o,{content:r})]})});_.displayName="IntegrationInstallation",S.displayName="IntegrationConnection",k.displayName="IntegrationConnectionHeader",I.displayName="EmptyIntegrationConnection",C.displayName="IntegrationConnectionOption"},65272:(e,n,t)=>{"use strict";t.d(n,{U:()=>eo,A:()=>el});var a=t(80263),r=t(8758),s=t.n(r),i=t(27488),o=t(24717),l=t(97008),c=t(32211),d=t(96773),u=t(58173),m=t(60045),x=t(53239),h=t(25481),p=t(98300),f=t(62836),g=t(20218),y=t(19070),j=t(45628),v=t(82457),b=t(32981),w=t(47330),N=t(55060),_=t(58394),S=t(87494),C=t(73969),I=t(39353),k=t(48104),P=t(4195),R=t(20160),A=t(27514),E=t(75198),L=t(32144),V=t(80251),G=t(48678),z=t(63188);async function F(e){let{connection:n}=e,{data:t,error:a}=await (0,G.bE)("/platform/integrations/github/connections",{body:n});return a&&(0,G.H4)(a),t}let H=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,L.jE)();return(0,V.n)(e=>F(e),{async onSuccess(n,t,r){await Promise.all([a.invalidateQueries(z.Z.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?C.oR.error("Failed to create Github connection: ".concat(e.message)):n(e,t,a)},...t})};var T=t(15910);async function O(e,n){let{connectionId:t,connection:a}=e,{data:r,error:s}=await (0,G.F6)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n,body:a});return s&&(0,G.H4)(s),r}let B=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,L.jE)();return(0,V.n)(e=>O(e),{async onSuccess(n,t,r){await Promise.all([a.invalidateQueries(z.Z.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?C.oR.error("Failed to update Github connection: ".concat(e.message)):n(e,t,a)},...t})};var M=t(56947);async function D(e){let{data:n,error:t}=await (0,G.Jt)("/platform/integrations/github/repositories",{signal:e});return t&&(0,G.H4)(t),n.repositories}let U=function(){let{enabled:e=!0,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,M.I)(z.Z.githubRepositoriesList(),e=>{let{signal:n}=e;return D(n)},{enabled:e,staleTime:0,...n})};var $=t(82868),Z=t(2525),J=t(35443),W=t(37263),Y=t(67963),Q=t(67928),X=t(85936),q=t(93263),K=t(64477),ee=t(54097),en=t(87916);let et=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 98 96",className:"w-6",children:(0,a.jsx)("path",{fill:"#ffffff",fillRule:"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",clipRule:"evenodd"})}),ea=e=>{let{disabled:n=!1,connection:t}=e,r=(0,l.KT)(),s=(0,j.a)(),[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(!1),[u,h]=(0,x.useState)(!1),p=!(null==r?void 0:r.parent_project_ref),f=(0,y.SE)(m.aG.UPDATE,"integrations.github_connections"),g=(0,y.SE)(m.aG.CREATE,"integrations.github_connections"),{data:L,isLoading:V}=(0,E.m)(),{data:G,isLoading:z}=U({enabled:!!L}),{mutate:F}=(0,P.O)(),{mutate:O}=(0,k.t)({onError:e=>{console.error("Failed to enable branching:",e)}}),{data:M}=(0,R.A)({projectRef:null==r?void 0:r.ref},{enabled:!!(null==r?void 0:r.ref)}),{mutateAsync:D,isLoading:ea}=(0,A.v)({onError:()=>{}}),{mutate:er,isLoading:es}=H(),{mutateAsync:ei,isLoading:eo}=(0,T.L)({onSuccess:()=>{C.oR.success("Successfully removed GitHub integration")}}),{mutate:el,isLoading:ec}=B(),ed=(0,x.useMemo)(()=>{var e;return null!=(e=null==G?void 0:G.map(e=>({id:e.id.toString(),name:e.name,installation_id:e.installation_id,default_branch:e.default_branch||"main"})))?e:Z.Oj},[G]),eu=null==M?void 0:M.find(e=>e.is_default),em=I.Ik({repositoryId:I.Yj().min(1,"Please select a repository"),enableProductionSync:I.zM().default(!0),branchName:I.Yj().default("main"),new_branch_per_pr:I.zM().default(!0),supabaseDirectory:I.Yj().default("."),supabaseChangesOnly:I.zM().default(!0),branchLimit:I.Yj().default("50")}).superRefine(async(e,n)=>{if(e.enableProductionSync&&e.branchName&&e.branchName.length>0){let a=e.repositoryId||(null==t?void 0:t.repository.id.toString());if(a)try{await D({repositoryId:Number(a),branchName:e.branchName})}catch(i){let r=ed.find(e=>e.id===a),s=(null==r?void 0:r.name)||(null==t?void 0:t.repository.name)||"selected repository";n.addIssue({code:I.eq.custom,message:'Branch "'.concat(e.branchName,'" not found in ').concat(s),path:["branchName"]})}}}),ex=(0,S.mN)({resolver:(0,b.u)(em),mode:"onSubmit",reValidateMode:"onBlur",defaultValues:{repositoryId:(null==t?void 0:t.repository.id.toString())||"",enableProductionSync:!0,branchName:"main",new_branch_per_pr:!0,supabaseDirectory:".",supabaseChangesOnly:!0,branchLimit:"50"}}),eh=ex.watch("enableProductionSync"),ep=ex.watch("new_branch_per_pr"),ef=ex.watch("repositoryId"),eg=ed.find(e=>e.id===ef),ey=async e=>{if((null==r?void 0:r.ref)&&(null==s?void 0:s.id))try{if(t){if(t.repository.id.toString()!==e.repositoryId)return void d(!0);await ev(e,t)}else{let n=ed.find(n=>n.id===e.repositoryId);if(!n)return void C.oR.error("Please select a repository");await ej(e,n)}}catch(e){console.error("Error managing connection:",e)}},ej=async(e,n)=>{(null==r?void 0:r.ref)&&(null==s?void 0:s.id)&&(er({organizationId:s.id,connection:{installation_id:n.installation_id,project_ref:r.ref,repository_id:Number(n.id),workdir:e.supabaseDirectory,supabase_changes_only:e.supabaseChangesOnly,branch_limit:Number(e.branchLimit),new_branch_per_pr:e.new_branch_per_pr}}),(null==eu?void 0:eu.id)?F({id:eu.id,projectRef:r.ref,gitBranch:e.branchName}):O({projectRef:r.ref,branchName:"main",gitBranch:e.branchName,is_default:!0}),C.oR.success("GitHub integration successfully updated"))},ev=async(e,n)=>{if(!(null==r?void 0:r.ref)||!(null==s?void 0:s.id))return;let t=null==eu?void 0:eu.git_branch;if(t&&e.branchName!==t&&e.enableProductionSync)return void o(!0);await eb(e,n)},eb=async(e,n)=>{(null==r?void 0:r.ref)&&(null==s?void 0:s.id)&&(el({connectionId:n.id,organizationId:s.id,connection:{workdir:e.supabaseDirectory,supabase_changes_only:e.supabaseChangesOnly,branch_limit:Number(e.branchLimit),new_branch_per_pr:e.new_branch_per_pr}}),(null==eu?void 0:eu.id)&&F({id:eu.id,projectRef:r.ref,gitBranch:e.enableProductionSync?e.branchName:""}),C.oR.success("GitHub integration successfully updated"),o(!1))},ew=async()=>{t&&await eb(ex.getValues(),t)},eN=async()=>{if(t&&(null==s?void 0:s.id))try{await ei({organizationId:s.id,connectionId:t.id}),ex.reset({repositoryId:"",enableProductionSync:!0,branchName:"main",new_branch_per_pr:!0,supabaseDirectory:".",supabaseChangesOnly:!0,branchLimit:"50"})}catch(e){console.error("Error removing integration:",e),C.oR.error("Failed to remove integration")}},e_=async()=>{let e=ex.getValues(),n=ed.find(n=>n.id===e.repositoryId);if(n&&t)try{await ei({organizationId:s.id,connectionId:t.id}),await ej(e,n),d(!1)}catch(e){console.error("Error changing repository:",e),C.oR.error("Failed to change repository")}};if((0,x.useEffect)(()=>{if(eg){var e;ex.setValue("branchName",(null==(e=ed.find(e=>e.id===eg.id))?void 0:e.default_branch)||"main")}},[eg]),(0,x.useEffect)(()=>{if(t){var e;let n=!!(null==eu||null==(e=eu.git_branch)?void 0:e.trim());ex.reset({repositoryId:t.repository.id.toString(),enableProductionSync:n,branchName:(null==eu?void 0:eu.git_branch)||"main",new_branch_per_pr:t.new_branch_per_pr,supabaseDirectory:t.workdir||"",supabaseChangesOnly:t.supabase_changes_only,branchLimit:String(t.branch_limit)})}},[t,eu,ex]),(0,x.useEffect)(()=>{eh?eh&&!ex.getValues().branchName&&ex.setValue("branchName","main"):ex.setValue("branchName","")},[eh,ex]),null===L)return(0,a.jsx)(J.Zp,{children:(0,a.jsxs)(J.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)("p",{className:"text-sm text-center",children:"Authorize with GitHub"}),(0,a.jsx)("p",{className:"text-sm text-center text-foreground-light mb-4",children:"Connect your GitHub account to access and select repositories for integration."}),(0,a.jsx)(W.$,{onClick:()=>{(0,$.Fd)("authorize")},children:"Authorize GitHub"})]})});let eS=es||ec||eo;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Y.lV,{...ex,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("form",{onSubmit:ex.handleSubmit(ey),className:(0,v.cn)(!p&&"opacity-25 pointer-events-none"),children:(0,a.jsxs)(J.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:[(0,a.jsx)(J.Wu,{className:"space-y-6","data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)(Y.zB,{control:ex.control,name:"repositoryId",render:e=>{let{field:n}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"GitHub Repository",description:t?"Change the connected repository":"Select the repository to connect to your project",children:(0,a.jsxs)(Q.AM,{open:u,onOpenChange:h,children:[(0,a.jsx)(Q.Wv,{asChild:!0,children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(W.$,{type:"default",className:"justify-start h-[34px] w-full",disabled:z,loading:z,icon:(0,a.jsx)("div",{className:"bg-black shadow rounded p-1 w-6 h-6 flex justify-center items-center",children:et}),iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(w.A,{})}),children:eg||t?(null==eg?void 0:eg.name)||(null==t?void 0:t.repository.name):"Choose GitHub Repository"})})}),(0,a.jsx)(Q.hl,{className:"p-0 w-80",side:"bottom",align:"start",children:(0,a.jsxs)(X.uB,{children:[(0,a.jsx)(X.G7,{placeholder:"Search repositories..."}),(0,a.jsxs)(X.oI,{className:"!max-h-[200px]",children:[(0,a.jsx)(X.xL,{children:"No repositories found."}),(0,a.jsx)(X.L$,{children:ed.map((e,t)=>(0,a.jsxs)(X.h_,{value:"".concat(e.name.replaceAll('"',""),"-").concat(t),className:"flex gap-2 items-center",onSelect:()=>{n.onChange(e.id),h(!1)},children:[(0,a.jsx)("div",{className:"bg-black shadow rounded p-1 w-5 h-5 flex justify-center items-center",children:et}),(0,a.jsx)("span",{className:"truncate",title:e.name,children:e.name})]},e.id))}),(0,a.jsx)(X.L$,{children:(0,a.jsxs)(X.h_,{className:"flex gap-2 items-center cursor-pointer",onSelect:()=>(0,$.Fd)("install"),children:[(0,a.jsx)(N.A,{size:16}),"Add GitHub Repositories"]})})]})]})})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})}),(0,a.jsx)(J.Wu,{className:(0,v.cn)(!ef&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)(Y.zB,{control:ex.control,name:"supabaseDirectory",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Supabase directory",description:"Relative path to your supabase folder",children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(q.p,{...t,placeholder:"supabase",autoComplete:"off",disabled:n||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})}),(0,a.jsx)(J.Wu,{className:(0,v.cn)(!ef&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Y.zB,{control:ex.control,name:"enableProductionSync",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Deploy to production",description:"Deploy changes to production on push including PR merges",children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(K.d,{checked:t.value,onCheckedChange:t.onChange,disabled:n||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)("div",{className:(0,v.cn)("space-y-4 pl-6 border-l",(!eh||n)&&"opacity-25 pointer-events-none"),children:(0,a.jsx)(Y.zB,{control:ex.control,name:"branchName",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Production branch name",description:"The GitHub branch to sync with your production database (e.g., main, master)",children:(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(q.p,{...t,autoComplete:"off",disabled:n||!f||!eh})}),(0,a.jsx)("div",{className:"absolute top-2.5 right-3 flex items-center gap-2",children:ea&&(0,a.jsx)(_.A,{size:14,className:"animate-spin"})})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})})]})}),(0,a.jsx)(J.Wu,{className:(0,v.cn)(!ef&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Y.zB,{control:ex.control,name:"new_branch_per_pr",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Automatic branching",description:"Create preview branches for every pull request",children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(K.d,{checked:t.value,onCheckedChange:t.onChange,disabled:n||!g})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsxs)("div",{className:(0,v.cn)("space-y-4 pl-6 border-l",(!ep||n)&&"opacity-25 pointer-events-none"),children:[(0,a.jsx)(Y.zB,{control:ex.control,name:"branchLimit",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Branch limit",description:"Maximum number of preview branches",children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(q.p,{...t,type:"number",autoComplete:"off",disabled:!ep||n||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)(Y.zB,{control:ex.control,name:"supabaseChangesOnly",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Supabase changes only",description:"Only create branches when Supabase files change",children:(0,a.jsx)(Y.MJ,{children:(0,a.jsx)(K.d,{checked:t.value,onCheckedChange:e=>t.onChange(e),disabled:!ep||n||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})]})]})}),(0,a.jsxs)(J.wL,{className:"flex justify-between items-center","data-sentry-element":"CardFooter","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:[(0,a.jsx)("div",{children:t&&(0,a.jsx)(W.$,{type:"outline",onClick:eN,disabled:n||eo,loading:eo,children:"Disable integration"})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[ex.formState.isDirty&&(0,a.jsx)(W.$,{type:"default",onClick:()=>{ex.reset()},disabled:n||!f,children:"Cancel"}),(0,a.jsx)(W.$,{type:"primary",htmlType:"submit",disabled:n||!t&&!g||t&&!f||ea||eS||!t&&!ex.getValues().repositoryId||t&&!ex.formState.isDirty,loading:ea||eS,"data-sentry-element":"Button","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:t?"Save changes":"Enable integration"})]})]})]})})}),(0,a.jsx)(ee.A,{variant:"warning",visible:i,title:"Changing production git branch",confirmLabel:"Confirm",size:"medium",onCancel:()=>o(!1),onConfirm:ew,loading:ec,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Open pull requests will only update your Supabase project on merge if the git base branch matches this new production git branch."})}),(0,a.jsx)(ee.A,{variant:"warning",visible:c,title:"Changing GitHub repository",confirmLabel:"Change repository",size:"medium",onCancel:()=>d(!1),onConfirm:e_,loading:eS,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This will disconnect your current repository and create a new connection with the selected repository. All existing Supabase branches that are connected to the old repository will no longer be synced."})})})]})},er=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(c.o2,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"GithubSection.tsx"})},es=()=>{var e;let{ref:n}=(0,h.g)(),t=(0,j.a)(),r=(0,y.SE)(m.aG.READ,"integrations.github_connections"),s=(0,j.a)(),i=(null==s||null==(e=s.plan)?void 0:e.id)!=="free",l=c.pe&&!i,{data:d}=(0,g.O)({organizationId:null==t?void 0:t.id},{enabled:!!n&&!!(null==t?void 0:t.id)}),u=(0,x.useMemo)(()=>null==d?void 0:d.find(e=>e.project.ref===n),[d,n]),b="GitHub Integration";return r?(0,a.jsx)(o.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"GitHubSection","data-sentry-source-file":"GithubSection.tsx",children:(0,a.jsxs)(o.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsxs)(o.xp,{title:b,"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsx)("p",{children:"Connect any of your GitHub repositories to a project."}),(0,a.jsx)(er,{title:"github","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"GithubSection.tsx"})]}),(0,a.jsx)(o.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"GithubSection.tsx",children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-foreground mb-2",children:"How does the GitHub integration work?"}),(0,a.jsx)("p",{className:"text-foreground-light text-sm mb-6",children:"Connecting to GitHub allows you to sync preview branches with a chosen GitHub branch, keep your production branch in sync, and automatically create preview branches for every pull request."}),l&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(f.A,{primaryText:"Upgrade to unlock GitHub integration",secondaryText:"Connect your GitHub repository to automatically sync preview branches and deploy changes.",source:"github-integration"})}),(0,a.jsx)("div",{className:(0,v.cn)(l&&"opacity-25 pointer-events-none"),children:(0,a.jsx)(ea,{connection:u,"data-sentry-element":"GitHubIntegrationConnectionForm","data-sentry-source-file":"GithubSection.tsx"})})]})})})]})}):(0,a.jsx)(o.eh,{children:(0,a.jsxs)(o.gu,{children:[(0,a.jsxs)(o.xp,{title:b,children:[(0,a.jsx)("p",{children:"Connect any of your GitHub repositories to a project."}),(0,a.jsx)(er,{title:"github"})]}),(0,a.jsx)(o.Rf,{children:(0,a.jsx)(p.A,{resourceText:"view this organization's GitHub connections"})})]})})};var ei=t(92517);let eo=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(c.o2,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"IntegrationsSettings.tsx"})},el=()=>{let e=(0,l.KT)(),n=(0,l.Ne)(null==e?void 0:e.parent_project_ref),t=(null==e?void 0:e.parent_project_ref)!==void 0;return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(o.eh,{children:(0,a.jsxs)(d.Fc,{variant:"default",className:"mt-6",children:[(0,a.jsx)(u.id,{}),(0,a.jsx)(d.XL,{children:"You are currently on a preview branch of your project"}),(0,a.jsxs)(d.TN,{children:["To adjust your project's integration settings, you may return to your"," ",(0,a.jsx)(s(),{href:"/project/".concat(null==n?void 0:n.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]})}),(0,a.jsx)(es,{"data-sentry-element":"GitHubSection","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(o.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(ei.A,{isProjectScoped:!0,"data-sentry-element":"VercelSection","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(i.A,{"data-sentry-element":"SidePanelVercelProjectLinker","data-sentry-source-file":"IntegrationsSettings.tsx"})]})}},75198:(e,n,t)=>{"use strict";t.d(n,{m:()=>o});var a=t(56947),r=t(48678),s=t(63188);async function i(e){let{data:n,error:t}=await (0,r.Jt)("/platform/integrations/github/authorization",{signal:e});return t?null:n}let o=function(){let{enabled:e=!0,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.I)(s.Z.githubAuthorization(),e=>{let{signal:n}=e;return i(n)},{enabled:e,staleTime:0,...n})}},75607:(e,n,t)=>{"use strict";t.d(n,{I:()=>s});var a=t(80263),r=t(37263);let s=e=>{let{form:n,hasChanges:t,handleReset:s,helper:i,disabled:o=!1,isSubmitting:l,submitText:c="Save"}=e,d=l||o||!t&&void 0!==t;return(0,a.jsxs)("div",{className:["flex w-full items-center gap-2",i?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[i&&(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:i}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{disabled:d,type:"default",htmlType:"reset",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,a.jsx)(r.$,{form:n,type:"primary",htmlType:"submit",disabled:d,loading:l,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:c})]})]})}},77022:(e,n,t)=>{"use strict";t.d(n,{$:()=>o});var a=t(56947),r=t(48678),s=t(63188);async function i(e,n){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{data:a,error:s}=await (0,r.Jt)("/platform/integrations/{slug}",{params:{path:{slug:t}}});return s&&(0,r.H4)(s),a}let o=function(e){let{orgSlug:n}=e,{enabled:t=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.Z.integrationsListWithOrg(n),e=>{let{signal:t}=e;return i({orgSlug:n},t)},{enabled:t&&void 0!==n,staleTime:18e5,...r})}},92517:(e,n,t)=>{"use strict";t.d(n,{A:()=>D});var a=t(80263),r=t(90354),s=t(8758),i=t.n(s),o=t(53239),l=t(73969),c=t(60045),d=t(62366),u=t(65144),m=t(63809),x=t(24717),h=t(98300),p=t(77022),f=t(32144),g=t(80251),y=t(48678),j=t(63188);async function v(e,n){let{organization_integration_id:t,id:a}=e;if(!t)throw Error("organization_integration_id is required");let{data:r,error:s}=await (0,y.yH)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:a}},signal:n});return s&&(0,y.H4)(s),r}let b=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.jE)();return(0,g.n)(e=>v(e),{async onSuccess(n,t,r){await Promise.all([a.invalidateQueries(j.Z.integrationsList()),a.invalidateQueries(j.Z.integrationsListWithOrg(t.orgSlug)),a.invalidateQueries(j.Z.vercelProjectList(t.organization_integration_id)),a.invalidateQueries(j.Z.vercelConnectionsList(t.organization_integration_id))]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?l.oR.error("Failed to delete Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var w=t(9951),N=t(19070),_=t(45628),S=t(97008),C=t(35416),I=t(11243),k=t(36710),P=t(82457),R=t(37263),A=t(65272),E=t(32981),L=t(87494),V=t(39353),G=t(75607);async function z(e){let{id:n,envSyncTargets:t,publicEnvVarPrefix:a}=e,{data:r,error:s}=await (0,y.F6)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:n}},body:{env_sync_targets:t,public_env_var_prefix:a}});return s&&(0,y.H4)(s),r}let F=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.jE)();return(0,g.n)(e=>z(e),{async onSuccess(n,t,r){await a.invalidateQueries(j.Z.vercelConnectionsList(t.organizationIntegrationId)),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?l.oR.error("Failed to update Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var H=t(67963),T=t(96773),O=t(64477),B=t(93263);let M=e=>{var n;let{disabled:t,connection:r,integration:s}=e,o=(0,_.a)(),c=(null==o?void 0:o.managed_by)==="vercel-marketplace"?[]:null!=(n=r.env_sync_targets)?n:[],d=V.Ik({environmentVariablesProduction:V.zM().default(c.includes("production")),environmentVariablesPreview:V.zM().default(c.includes("preview")),environmentVariablesDevelopment:V.zM().default(c.includes("development")),publicEnvVarPrefix:V.Yj().optional()}),u=(0,L.mN)({resolver:(0,E.u)(d),defaultValues:{environmentVariablesProduction:c.includes("production"),environmentVariablesPreview:c.includes("preview"),environmentVariablesDevelopment:c.includes("development"),publicEnvVarPrefix:r.public_env_var_prefix}}),{mutate:m,isLoading:x}=F({onSuccess:()=>{u.reset(u.getValues()),l.oR.success("Updated Vercel connection")}}),h="vercel-connection-form-".concat(r.id);return(0,a.jsx)(H.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"VercelIntegrationConnectionForm","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx",children:(0,a.jsx)("form",{id:h,onSubmit:u.handleSubmit(function(e){var n;let{environmentVariablesProduction:t,environmentVariablesPreview:a,environmentVariablesDevelopment:i}=e,o=[];t&&o.push("production"),a&&o.push("preview"),i&&o.push("development"),m({id:r.id,envSyncTargets:o,publicEnvVarPrefix:null==(n=e.publicEnvVarPrefix)?void 0:n.trim(),organizationIntegrationId:s.id})}),className:"w-full space-y-6",children:(0,a.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-4",children:[(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(null==o?void 0:o.managed_by)==="vercel-marketplace"?(0,a.jsxs)(T.Fc,{children:[(0,a.jsx)(T.XL,{className:"text-sm",children:"Vercel Marketplace managed project"}),(0,a.jsxs)(T.TN,{className:"text-xs",children:["This project is managed via Vercel Marketplace. Environment variables are automatically synchronized for your connected Vercel projects. This integration purpose is synchronizing preview deployments environment variables with our"," ",(0,a.jsx)(i(),{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/branching",className:"underline",children:"Branching"})," ","feature."]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-foreground text-sm",children:"Sync environment variables for selected target environments"}),(0,a.jsx)(H.zB,{control:u.control,name:"environmentVariablesProduction",render:e=>{let{field:n}=e;return(0,a.jsxs)(H.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(H.MJ,{children:(0,a.jsx)(O.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(H.lR,{className:"!text",children:"Production"}),(0,a.jsxs)(H.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"production"})," environment."]})]})]})}}),(0,a.jsx)(H.zB,{control:u.control,name:"environmentVariablesPreview",render:e=>{let{field:n}=e;return(0,a.jsxs)(H.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(H.MJ,{children:(0,a.jsx)(O.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(H.lR,{className:"!text",children:"Preview"}),(0,a.jsxs)(H.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"preview"})," environment."]})]})]})}}),(0,a.jsx)(H.zB,{control:u.control,name:"environmentVariablesDevelopment",render:e=>{let{field:n}=e;return(0,a.jsxs)(H.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(H.MJ,{children:(0,a.jsx)(O.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(H.lR,{className:"!text",children:"Development"}),(0,a.jsxs)(H.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"development"})," environment."]})]})]})}})]})}),(0,a.jsx)("h5",{className:"mt-2 text-foreground text-sm",children:"Customize public environment variable prefix"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(0,a.jsx)(H.zB,{control:u.control,name:"publicEnvVarPrefix",render:e=>{let{field:n}=e;return(0,a.jsxs)(H.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,a.jsx)(H.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Prefix"}),(0,a.jsx)(H.MJ,{className:"col-span-8",children:(0,a.jsx)(B.p,{...n,className:"w-full",disabled:t,placeholder:"An empty prefix will result in no public env vars"})}),(0,a.jsxs)(H.Rr,{className:"col-start-5 col-span-8 text-xs",children:["e.g."," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("NEXT_PUBLIC_")},children:"NEXT_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("VITE_PUBLIC_")},children:"VITE_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("PUBLIC_")},children:"PUBLIC_"}),", etc."]}),(0,a.jsx)(H.C5,{className:"col-start-5 col-span-8"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})}),u.formState.isDirty?(0,a.jsxs)("p",{className:"mt-2 text-sm text-warning-600",children:["Note: Changing these settings will ",(0,a.jsx)("strong",{children:"not"})," trigger a resync of environment variables."]}):(0,a.jsx)("div",{className:"mt-2 h-5 w-full"}),(0,a.jsx)(G.I,{disabled:t,form:h,hasChanges:u.formState.isDirty,isSubmitting:x,handleReset:()=>u.reset(),"data-sentry-element":"FormActions","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})]})})})},D=e=>{var n;let{isProjectScoped:t}=e,s=(0,S.KT)(),f=(0,_.a)(),{data:g}=(0,p.$)({orgSlug:null==f?void 0:f.slug}),y=(0,k.bZ)(),j=(null==s?void 0:s.parent_project_ref)!==void 0,v=(0,N.SE)(c.aG.READ,"integrations.vercel_connections"),E=(0,N.SE)(c.aG.CREATE,"integrations.vercel_connections"),L=(0,N.SE)(c.aG.UPDATE,"integrations.vercel_connections"),{mutate:V}=b({onSuccess:()=>{l.oR.success("Successfully deleted Vercel connection")}}),G=(0,o.useMemo)(()=>null==g?void 0:g.filter(e=>"Vercel"===e.integration.name).map(e=>{if(e.metadata&&"Vercel"===e.integration.name){let n=e.metadata.account.avatar||"Team"!==e.metadata.account.type?"https://vercel.com/api/www/avatar/".concat(e.metadata.account.avatar,"?s=48"):"https://vercel.com/api/www/avatar?teamId=".concat(e.metadata.account.team_id,"&s=48");e.metadata.account.avatar=n}return e}),[g]),z=null==G?void 0:G[0],{data:F}=(0,w.b)({organization_integration_id:null==z?void 0:z.id},{enabled:(null==z?void 0:z.id)!==void 0}),H=null!=(n=null==F?void 0:F.length)?n:0,T=(0,o.useCallback)(e=>{y.setVercelConnectionsIntegrationId(e),y.setVercelConnectionsOpen(!0)},[y]),O=(0,o.useCallback)(async e=>{V({id:e.id,organization_integration_id:e.organization_integration_id,orgSlug:null==f?void 0:f.slug})},[V,null==f?void 0:f.slug]),B=H>0&&void 0!==z?"\nYour Vercel connection has access to ".concat(H," Vercel Projects.\nYou can change the scope of the access for Supabase by configuring\n[here](").concat((0,I.U)(z),").\n"):"",D=(t?null==z?void 0:z.connections.filter(e=>e.supabase_project_ref===(null==s?void 0:s.ref)):null==z?void 0:z.connections)||[],U="".concat(D.length," project ").concat((0,C.td)(D.length,"connection")," ");return(0,a.jsx)(x.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"VercelSection","data-sentry-source-file":"VercelSection.tsx",children:(0,a.jsxs)(x.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsxs)(x.xp,{title:"Vercel Integration","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsx)(m.o,{content:"\n\nConnect your Vercel teams to your Supabase organization.\n","data-sentry-element":"Markdown","data-sentry-source-file":"VercelSection.tsx"}),(0,a.jsx)(A.U,{title:"vercel","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"VercelSection.tsx"})]}),(0,a.jsx)(x.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"VercelSection.tsx",children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.o,{content:"\n\n### How does the Vercel integration work?\n\nSupabase will keep your environment variables up to date in each of the projects you assign to a Supabase project.\nYou can also link multiple Vercel Projects to the same Supabase project.\n"}),z?(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Tt,{title:"Vercel",integration:z}),D.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Q7,{title:U,markdown:"Repository connections for Vercel"}),(0,a.jsx)("ul",{className:"flex flex-col",children:D.map(e=>(0,a.jsxs)("div",{className:(0,P.cn)(t&&"relative flex flex-col -gap-[1px] [&>li]:pb-0"),children:[(0,a.jsx)(d.S,{connection:e,disabled:j||!L,type:"Vercel",onDeleteConnection:O,className:(0,P.cn)(t&&"!rounded-b-none !mb-0")}),t?(0,a.jsx)("div",{className:"relative pl-8 ml-6 border-l border-muted pb-6",children:(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(M,{connection:e,integration:z,disabled:j||!L})})}):null]},e.id))})]}):(0,a.jsx)(u.Q7,{title:U,className:"pb-0",markdown:"Repository connections for Vercel"}),(0,a.jsx)(u.MJ,{disabled:j||!E,onClick:()=>T(z.id),children:"Add new project connection"})]},z.id):(0,a.jsx)("div",{children:(0,a.jsx)(R.$,{icon:(0,a.jsx)(r.A,{}),asChild:!j,type:"default",disabled:j,children:j?(0,a.jsx)("p",{children:"Install Vercel Integration"}):(0,a.jsx)(i(),{href:"https://vercel.com/integrations/supabase",target:"_blank",rel:"noreferrer",children:"Install Vercel Integration"})})}),B&&(0,a.jsx)(m.o,{extLinks:!0,content:B,className:"text-foreground-lighter"})]}):(0,a.jsx)(h.A,{resourceText:"view this organization's Vercel connections"})})]})})}},98300:(e,n,t)=>{"use strict";t.d(n,{A:()=>s});var a=t(80263),r=t(263);let s=e=>{let{resourceText:n,isFullPage:t=!1}=e,s=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(r.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",n]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(s,{})})}):(0,a.jsx)(s,{})}}}]);