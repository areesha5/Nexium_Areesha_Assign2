!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="48295d88-1cfc-4bdf-90e5-4396bc3c2dd3",e._sentryDebugIdIdentifier="sentry-dbid-48295d88-1cfc-4bdf-90e5-4396bc3c2dd3")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3145,4598,6841],{31733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ee});var n=s(80263),r=s(60045),a=s(76584),l=s(53239),i=s(73969),c=s(25481),o=s(47308),d=s(80948),u=s(98300),m=s(56259),x=s(32144),f=s(80251),p=s(48678);let h={list:e=>["projects",e,"edge_functions_secrets"]};async function j(e){let{projectRef:t,secrets:s}=e;if(!t)throw Error("Project ref is required");let{data:n,error:r}=await (0,p.yH)("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});return r&&(0,p.H4)(r),n}let y=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,x.jE)();return(0,f.n)(e=>j(e),{async onSuccess(t,s,r){let{projectRef:a}=s;await n.invalidateQueries(h.list(a)),await (null==e?void 0:e(t,s,r))},async onError(e,s,n){void 0===t?i.oR.error("Failed to delete secrets: ".concat(e.message)):t(e,s,n)},...s})};var g=s(56947);async function v(e,t){let{projectRef:s}=e;if(!s)throw Error("Project ref is required");let{data:n,error:r}=await (0,p.Jt)("/v1/projects/{ref}/secrets",{params:{path:{ref:s}},signal:t});return r&&(0,p.H4)(r),n}let w=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.I)(h.list(t),e=>{let{signal:s}=e;return v({projectRef:t},s)},{enabled:s&&void 0!==t,...n})};var N=s(19070),b=s(72470),S=s(17082),A=s(41768),E=s(54097),C=s(32981),T=s(87494),_=s(39353),F=s(41422);async function R(e){let{projectRef:t,secrets:s}=e;if(!t)throw Error("Project ref is required");let{data:n,error:r}=await (0,p.bE)("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});return r&&(0,p.H4)(r),n}let D=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,x.jE)();return(0,f.n)(e=>R(e),{async onSuccess(t,s,r){let{projectRef:a}=s;await n.invalidateQueries(h.list(a)),await (null==e?void 0:e(t,s,r))},async onError(e,s,n){void 0===t?i.oR.error("Failed to create secrets: ".concat(e.message)):t(e,s,n)},...s})};var k=s(32117),M=s(15777),I=s(74333);let P=e=>{let{visible:t,onCancel:s,onConfirm:r,isCreating:a,secretName:l}=e;return(0,n.jsx)(E.A,{visible:t,size:"medium",title:"Confirm replacing existing secret",confirmLabel:"Replace secret",confirmLabelLoading:"Replacing secret",variant:"warning",loading:a,onCancel:s,onConfirm:r,"data-sentry-element":"ConfirmationModal","data-sentry-component":"DuplicateSecretWarningModal","data-sentry-source-file":"DuplicateSecretWarningModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['A secret with the name "',l,'" already exists. Continuing will replace the existing secret with the new value. This action cannot be undone. Are you sure you want to proceed?']})})};var z=s(67963),L=s(37263);let H=_.Ay.object({secrets:_.Ay.array(_.Ay.object({name:_.Ay.string().min(1,"Please provide a name for your secret").refine(e=>!e.match(/^(SUPABASE_).*/),{message:"Name must not start with the SUPABASE_ prefix"}),value:_.Ay.string().min(1,"Please provide a value for your secret")}))}),B={secrets:[{name:"",value:""}]},Y=()=>{let{ref:e}=(0,c.g)(),[t,s]=(0,l.useState)(!1),[r,a]=(0,l.useState)(""),[o,d]=(0,l.useState)(null),u=(0,T.mN)({resolver:(0,C.u)(H),defaultValues:B}),{fields:m,append:x,remove:f}=(0,T.jz)({control:u.control,name:"secrets"}),{data:p}=w({projectRef:e}),{mutate:h,isLoading:j}=D({onSuccess:(e,t)=>{i.oR.success('Successfully created new secret "'.concat(t.secrets[0].name,'"')),setTimeout(()=>u.reset(),0)}}),y=async t=>{let s=(null==p?void 0:p.map(e=>e.name))||[],n=t.secrets.find(e=>s.includes(e.name));if(n){a(n.name),d(t);return}h({projectRef:e,secrets:t.secrets})};return(0,n.jsxs)(F.A,{"data-sentry-element":"Panel","data-sentry-component":"AddNewSecretForm","data-sentry-source-file":"AddNewSecretForm.tsx",children:[(0,n.jsxs)(F.A.Content,{className:"grid gap-4","data-sentry-element":"unknown","data-sentry-source-file":"AddNewSecretForm.tsx",children:[(0,n.jsx)("h2",{className:"text-sm",children:"Add new secrets"}),(0,n.jsx)(z.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"AddNewSecretForm.tsx",children:(0,n.jsxs)("form",{className:"w-full",onSubmit:u.handleSubmit(y),children:[m.map((e,r)=>(0,n.jsxs)("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-4 mb-4",children:[(0,n.jsx)(z.zB,{control:u.control,name:"secrets.".concat(r,".name"),render:e=>{let{field:t}=e;return(0,n.jsxs)(z.eI,{className:"w-full",children:[(0,n.jsx)(z.lR,{children:"Key"}),(0,n.jsx)(z.MJ,{children:(0,n.jsx)(A.p,{...t,placeholder:"e.g. CLIENT_KEY",onPaste:e=>(function(e){var t;e.preventDefault();let s=null==(t=e.clipboardData)?void 0:t.getData("text");if(!s)return;if(!s.includes("=")){let t=e.target.name;if(null==t?void 0:t.includes("secrets")){let[e,n,r]=t.match(/secrets\.(\d+)\.(\w+)/)||[];if(n&&r){let e=parseInt(n);u.setValue("secrets.".concat(e,".").concat(r),s);return}}}let n=[];try{let e=JSON.parse(s);Object.entries(e).forEach(e=>{let[t,s]=e;n.push({name:t,value:String(s)})})}catch(e){s.split(/\n/).forEach(e=>{let[t,...s]=e.split("=");t&&s.length&&n.push({name:t.trim(),value:s.join("=").trim()})})}if(n.length){let e=u.getValues("secrets").filter(e=>e.name||e.value);u.setValue("secrets",[...e,...n])}})(e.nativeEvent)})}),(0,n.jsx)(z.C5,{})]})}}),(0,n.jsx)(z.zB,{control:u.control,name:"secrets.".concat(r,".value"),render:e=>{let{field:r}=e;return(0,n.jsxs)(z.eI,{className:"w-full relative",children:[(0,n.jsx)(z.lR,{children:"Value"}),(0,n.jsx)(z.MJ,{children:(0,n.jsx)(A.p,{...r,type:t?"text":"password",actions:(0,n.jsx)("div",{className:"mr-1",children:(0,n.jsx)(L.$,{type:"text",className:"px-1",icon:t?(0,n.jsx)(k.A,{}):(0,n.jsx)(M.A,{}),onClick:()=>s(!t)})})})}),(0,n.jsx)(z.C5,{})]})}}),(0,n.jsx)(L.$,{type:"default",className:"h-[34px] mt-6",icon:(0,n.jsx)(I.A,{}),onClick:()=>m.length>1?f(r):u.reset(B)})]},e.id)),(0,n.jsx)(L.$,{type:"default",onClick:()=>{u.getValues("secrets").every(e=>!e.name&&!e.value)&&m.forEach((e,t)=>f(t)),x({name:"",value:""})},"data-sentry-element":"Button","data-sentry-source-file":"AddNewSecretForm.tsx",children:"Add another"}),(0,n.jsx)("div",{className:"flex items-center gap-2 col-span-2 -mx-6 px-6 border-t pt-4 mt-4",children:(0,n.jsx)(L.$,{type:"primary",htmlType:"submit",disabled:j,loading:j,"data-sentry-element":"Button","data-sentry-source-file":"AddNewSecretForm.tsx",children:j?"Saving...":"Save"})})]})})]}),(0,n.jsx)(P,{visible:!!r,onCancel:()=>{a(""),d(null)},onConfirm:()=>{o&&(h({projectRef:e,secrets:o.secrets}),a(""),d(null))},isCreating:j,secretName:r,"data-sentry-element":"DuplicateSecretWarningModal","data-sentry-source-file":"AddNewSecretForm.tsx"})]})};var $=s(98990),O=s(13933),V=s(92456);let U=e=>{let{secret:t,onSelectDelete:s}=e,a=(0,N.SE)(r.aG.SECRETS_WRITE,"*"),l=!!t.name.match(/^(SUPABASE_).*/);return(0,n.jsxs)(o.A.tr,{"data-sentry-element":"unknown","data-sentry-component":"EdgeFunctionSecret","data-sentry-source-file":"EdgeFunctionSecret.tsx",children:[(0,n.jsx)(o.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"EdgeFunctionSecret.tsx",children:(0,n.jsx)("p",{className:"truncate py-2",children:t.name})}),(0,n.jsx)(o.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"EdgeFunctionSecret.tsx",children:(0,n.jsx)("p",{className:"font-mono text-sm max-w-96 truncate",title:t.value,children:t.value})}),(0,n.jsx)(o.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"EdgeFunctionSecret.tsx",children:t.updated_at?(0,n.jsx)(V.T,{displayAs:"utc",utcTimestamp:t.updated_at,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"!text-sm"}):"-"}),(0,n.jsx)(o.A.td,{"data-sentry-element":"unknown","data-sentry-source-file":"EdgeFunctionSecret.tsx",children:(0,n.jsx)("div",{className:"flex items-center justify-end",children:(0,n.jsx)(O.G,{type:"text",icon:(0,n.jsx)($.A,{}),className:"px-1",disabled:!a||l,onClick:()=>s(),tooltip:{content:{side:"bottom",text:l?"This is a reserved secret and cannot be deleted":a?void 0:"You need additional permissions to delete edge function secrets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"EdgeFunctionSecret.tsx"})})})]})},W=()=>{var e;let{ref:t}=(0,c.g)(),[s,x]=(0,l.useState)(""),[f,p]=(0,l.useState)(),h=(0,N.SE)(r.aG.SECRETS_READ,"*"),j=(0,N.SE)(r.aG.SECRETS_WRITE,"*"),{data:g,error:v,isLoading:C,isSuccess:T,isError:_}=w({projectRef:t}),{mutate:F,isLoading:R}=y({onSuccess:()=>{i.oR.success("Successfully deleted ".concat(null==f?void 0:f.name)),p(void 0)}}),D=s.length>0?null!=(e=null==g?void 0:g.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())))?e:[]:null!=g?g:[],k=[(0,n.jsx)(o.A.th,{children:"Name"},"secret-name"),(0,n.jsxs)(o.A.th,{className:"flex items-center gap-x-2",children:["Digest"," ",(0,n.jsx)(b.E,{color:"scale",className:"font-mono",children:"SHA256"})]},"secret-value"),(0,n.jsx)(o.A.th,{children:"Updated at"},"secret-updated-at"),(0,n.jsx)(o.A.th,{},"actions")];return(0,n.jsxs)(n.Fragment,{children:[C&&(0,n.jsx)(m.y,{}),_&&(0,n.jsx)(d.A,{error:v,subject:"Failed to retrieve project secrets"}),T&&(0,n.jsxs)(n.Fragment,{children:[j?(0,n.jsxs)("div",{className:"grid gap-5",children:[(0,n.jsx)(Y,{}),(0,n.jsx)(S.w,{})]}):(0,n.jsx)(u.A,{resourceText:"manage this project's edge function secrets"}),j&&!h?(0,n.jsx)(u.A,{resourceText:"view this project's edge function secrets"}):h?(0,n.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,n.jsx)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:(0,n.jsx)(A.p,{size:"small",className:"w-full md:w-80",placeholder:"Search for a secret",value:s,onChange:e=>x(e.target.value),icon:(0,n.jsx)(a.A,{size:14})})}),(0,n.jsx)("div",{className:"w-full overflow-hidden overflow-x-auto",children:(0,n.jsx)(o.A,{head:k,body:D.length>0?D.map(e=>(0,n.jsx)(U,{secret:e,onSelectDelete:()=>p(e)},e.name)):0===D.length&&s.length>0?(0,n.jsx)(o.A.tr,{children:(0,n.jsxs)(o.A.td,{colSpan:k.length,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',s,'" did not return any results']})]})}):(0,n.jsx)(o.A.tr,{children:(0,n.jsxs)(o.A.td,{colSpan:k.length,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No secrets created"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are no secrets associated with your project yet"})]})})})})]}):null]}),(0,n.jsx)(E.A,{variant:"destructive",loading:R,visible:void 0!==f,confirmLabel:"Delete secret",confirmLabelLoading:"Deleting secret",title:'Confirm to delete secret "'.concat(null==f?void 0:f.name,'"'),onCancel:()=>p(void 0),onConfirm:()=>{void 0!==f&&F({projectRef:t,secrets:[f.name]})},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"EdgeFunctionSecrets.tsx",children:(0,n.jsx)("p",{className:"text-sm",children:"Before removing this secret, ensure none of your Edge Functions are actively using it. This action cannot be undone."})})]})};var G=s(54145),J=s(4649),Z=s(22084),q=s(34565),K=s(24717),Q=s(32211);let X=()=>(0,n.jsx)(K.eh,{size:"large",className:"pt-6","data-sentry-element":"ScaffoldContainer","data-sentry-component":"SecretsPage","data-sentry-source-file":"secrets.tsx",children:Q.pe?(0,n.jsx)(W,{}):(0,n.jsx)(G.Ad,{})});X.getLayout=e=>(0,n.jsx)(J.A,{children:(0,n.jsx)(Z.A,{children:(0,n.jsx)(q.M,{size:"large",title:"Edge Function Secrets",subtitle:"Manage the secrets for your project's Edge Functions",children:e})})});let ee=X},41768:(e,t,s)=>{"use strict";s.d(t,{p:()=>m});var n=s(80263),r=s(1933),a=s(53239),l=s(37356),i=s(82457),c=s(93263),o=s(37263),d=s(5548);function u(e){let{icon:t,className:s}=e;return(0,n.jsx)("div",{className:(0,i.cn)("absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-foreground-light",s),"data-sentry-component":"InputIconContainer","data-sentry-source-file":"InputIconContainer.tsx",children:t})}let m=(0,a.forwardRef)((e,t)=>{let{copy:s,showCopyOnHover:m=!1,icon:x,reveal:f=!1,actions:p,onCopy:h,iconContainerClassName:j,containerClassName:y,...g}=e,[v,w]=(0,a.useState)("Copy"),[N,b]=(0,a.useState)(!0),S=(0,d.A)("input"),A=[];return x&&A.push(S.with_icon),(0,n.jsxs)("div",{className:(0,i.cn)("relative group",y),children:[(0,n.jsx)(c.p,{ref:t,...g,onCopy:h,value:f&&N?"**** **** **** ****":g.value,className:(0,i.cn)(...A,g.className)}),x&&(0,n.jsx)(u,{icon:x,className:j}),s||p?(0,n.jsxs)("div",{className:S.actions_container,children:[s&&!(f&&N)?(0,n.jsx)(o.$,{size:"tiny",type:"default",className:(0,i.cn)(m&&"opacity-0 group-hover:opacity-100 transition"),icon:(0,n.jsx)(r.A,{size:16,className:"text-foreground-muted"}),onClick:()=>{var e;return e=g.value,void(0,l.l)(e,()=>{w("Copied"),setTimeout(function(){w("Copy")},3e3),null==h||h()})},children:v}):null,f&&N?(0,n.jsx)(o.$,{size:"tiny",type:"default",onClick:function(){b(!1)},children:"Reveal"}):null,p&&p]}):null]})})},68227:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/functions/secrets",function(){return s(31733)}])},74333:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(84497).A)("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]])},92456:(e,t,s)=>{"use strict";s.d(t,{K:()=>h,T:()=>g});var n=s(80263),r=s(53239),a=s(37356),l=s(82457),i=s(85462),c=s(53434),o=s.n(c),d=s(27344),u=s.n(d),m=s(37361),x=s.n(m);o().extend(u()),o().extend(x());let f=e=>o().unix(Number(e)/1e3/1e3).toISOString(),p=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},h=e=>{let{utcTimestamp:t,format:s}=e,n=p(t)?f(t):t;return o().utc(n).local().format(s)},j=e=>{let{utcTimestamp:t,format:s}=e,n=p(t)?f(t):t;return o().utc(n).format(s)},y=e=>{let{utcTimestamp:t}=e,s=p(t)?f(t):t;return o().utc(s).fromNow()},g=e=>{let{utcTimestamp:t,className:s,displayAs:c="local",format:o="DD MMM  HH:mm:ss",labelFormat:d="DD MMM HH:mm:ss"}=e,u=h({utcTimestamp:t,format:o}),m=j({utcTimestamp:t,format:o}),x=y({utcTimestamp:t}),[f,p]=(0,r.useState)("start"),g=(0,r.useRef)(null),v=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,r.useEffect)(()=>{let e=()=>{if(g.current){let e=g.current.getBoundingClientRect(),t=window.innerHeight;p(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let w=e=>{let{label:t,value:s}=e,[i,c]=(0,r.useState)(!1);return(0,n.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,a.l)(s,()=>{c(!0),setTimeout(()=>{c(!1)},1e3)})},className:(0,l.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":i}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,n.jsx)("p",{children:t}),(0,n.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,n.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,n.jsx)("div",{className:"border-t w-full border-dashed z-10"}),i&&(0,n.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,n.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:s})]})]})};return(0,n.jsxs)(i.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(i.k$,{asChild:!0,ref:g,className:"text-xs ".concat(s," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("span",{children:"local"===c?h({utcTimestamp:t,format:d}):j({utcTimestamp:t,format:d})})}),(0,n.jsxs)(i.ZI,{align:f,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(w,{label:"UTC",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(w,{label:v,value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(w,{label:"Relative",value:x,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(w,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},98300:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(80263),r=s(263);let a=e=>{let{resourceText:t,isFullPage:s=!1}=e,a=()=>(0,n.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)(r.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,n.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("div",{className:"w-[550px]",children:(0,n.jsx)(a,{})})}):(0,n.jsx)(a,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,8345,2491,3730,5982,6110,1185,5599,2041,1018,2409,4297,236,4515,1674,4942,2981,9480,4711,6137,4560,7795,3895,4109,2667,9846,2156,5500,4649,7104,3133,2865,8524,6526,6593,636,8792],()=>t(68227)),_N_E=e.O()}]);