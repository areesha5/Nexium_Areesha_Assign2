!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ef7e18ff-04a1-4fa0-9577-e09ed3a60133",e._sentryDebugIdIdentifier="sentry-dbid-ef7e18ff-04a1-4fa0-9577-e09ed3a60133")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7573],{6541:(e,t,s)=>{"use strict";s.d(t,{S:()=>n,t:()=>a});let a=(e,t,s,a,n)=>{let r=(null==a?void 0:a.find(a=>{var r,i;return(null==a||null==(r=a.metadata)?void 0:r.name)===e&&(null==a||null==(i=a.metadata)?void 0:i.schema)===n&&(null==a?void 0:a.name)===t&&s.includes(null==a?void 0:a.level)}))||null;return{hasLint:null!==r,count:+!!r,matchingLint:r}},n=(e,t)=>{if(0===t.length)return"";let s=e.columns.map(e=>'"'.concat(e.name,'"')).join(", "),a=t.map(t=>{let s={...t};"idx"in s&&delete s.idx;let a=Object.entries(s).map(t=>{var s;let[a,n]=t,{dataType:r,format:i}=null!=(s=e.columns.find(e=>e.name===a))?s:{};return null===n?"null":"ARRAY"===r?"'".concat(JSON.stringify(n).replace("[","{").replace(/.$/,"}"),"'"):(null==i?void 0:i.includes("json"))?"".concat(JSON.stringify(n).replace(/\\"/g,'"').replace(/'/g,"''").replace('"',"'").replace(/.$/,"'")):"'".concat(n,"'")});return"(".concat(a.join(", "),")")}).join(", ");return'INSERT INTO "'.concat(e.schema,'"."').concat(e.name,'" (').concat(s,") VALUES ").concat(a,";")}},7029:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var a=s(80263),n=s(10726),r=s(11203),i=s.n(r),l=s(53239),o=s(12185),c=s(64491),d=s(50526),u=s(5548),m=s(82457),p=s(48492);let x=(0,l.createContext)({onChange:e=>{},selected:void 0});var h=s(880);function f(e){let{children:t,className:s,buttonClassName:r,descriptionText:h,error:f,icon:g,id:b="",name:y="",label:v,labelOptional:j,layout:w,value:N,onChange:S,onFocus:k,onBlur:A,style:R,size:E="medium",defaultValue:T,validation:_,disabled:C,optionsWidth:L}=e,[z,I]=(0,l.useState)(void 0),[M,D]=(0,l.useState)({}),P=(0,u.A)("listbox"),O=(0,l.useRef)(null),{formContextOnChange:W,values:q,errors:H,handleBlur:B,touched:F,fieldLevelValidation:V}=(0,p.x)();q&&!N&&(N=q[b||y],T=q[b||y]),f||(H&&!f&&(f=H[b||y]),f=F&&F[b||y]?f:void 0),(0,l.useEffect)(()=>{void 0!==N&&I(N)},[N]),(0,l.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(L||(null==(e=O.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{var e;let s=i()(t);function a(e){return s.find(t=>t.props.value===e)}if(N){I(N);let e=a(N);D((null==e?void 0:e.props)?e.props:void 0);return}if(z){let e=a(z);D((null==e?void 0:e.props)?e.props:void 0);return}if(T){I(T);let e=a(z);D((null==e?void 0:e.props)?e.props:void 0);return}D(null==(e=s[0])?void 0:e.props)},[z]);let $=[P.container,P.base,r],U=[P.addOnBefore];return f&&$.push(P.variants.error),f||$.push(P.variants.standard),g&&U.push(P.with_icon),E&&$.push(P.size[E]),C&&$.push(P.disabled),(0,a.jsx)(o.H,{label:v,labelOptional:j,layout:w,id:b,error:f,descriptionText:h,className:s,style:R,size:E,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)(n.bL,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,a.jsx)(n.l9,{asChild:!0,disabled:C,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)("button",{"data-size":E,ref:O,className:(0,m.cn)($),onBlur:function(e){B&&B(e),A&&A(e)},onFocus:k,name:y,id:b,children:[(0,a.jsxs)("span",{className:(0,m.cn)(U),children:[g&&(0,a.jsx)(d.A,{size:E,icon:g}),(null==M?void 0:M.addOnBefore)&&(0,a.jsx)(M.addOnBefore,{}),(0,a.jsx)("span",{className:P.label,children:null==M?void 0:M.label})]}),(0,a.jsx)("span",{className:P.chevron_container,children:(0,a.jsx)("svg",{className:P.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,a.jsx)("div",{className:P.actions_container,children:f&&(0,a.jsx)(c.A,{size:E})})]})}),(0,a.jsx)(n.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:P.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("div",{children:(0,a.jsx)(x.Provider,{value:{onChange:function(e){S&&S(e),I(e);let t={};t.target={type:"select",name:y,id:b,value:e,checked:void 0},W&&W(t),_&&V(b,_(e))},selected:z},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:s,label:r,disabled:i=!1,children:l,className:o="",addOnBefore:c}=e,d=(0,u.A)("listbox");return(0,a.jsx)(x.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:r,selected:u}=e,p=u===s;return(0,a.jsxs)(n.q7,{className:(0,m.cn)(d.option,p?d.option_active:" ",i?d.option_disabled:" ",o),onSelect:()=>i?{}:r(s),children:[(0,a.jsxs)("div",{className:d.option_inner,children:[c&&c({active:p,selected:u}),(0,a.jsx)("span",{children:"function"==typeof l?l({active:p,selected:u}):l})]}),p?(0,a.jsx)("span",{className:(0,m.cn)(d.option_check,p?d.option_check_active:""),children:(0,a.jsx)(h.A,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let g=f},8278:(e,t,s)=>{"use strict";s.d(t,{Jv:()=>ex,RH:()=>eh,Ay:()=>ef});var a=s(80263),n=s(60045),r=s(95137),i=s.n(r),l=s(47330),o=s(2258),c=s(46249),d=s(98990),u=s(8758),m=s.n(u),p=s(77191),x=s.n(p),h=s(53239),f=s(73969),g=s(25481),b=s(59619),y=s(82937),v=s(57811),j=s(71147),w=s(63678);let N=(0,s(84497).A)("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);var S=s(6541),k=s(9895),A=s(30225),R=s(13933),E=s(84130),T=s(15922),_=s(71077),C=s(52346),L=s(93661),z=s(45404),I=s(50689),M=s(19070),D=s(11789),P=s(45628),O=s(70847),W=s(40418),q=s(85462),H=s(37263),B=s(82457),F=s(67928),V=s(98111),$=s(54097),U=s(99915),G=s(32144),Q=s(17162),J=s(94530),K=s(78859),Y=s(40691),X=s(79542),Z=s(81172);function ee(e){let{table:t,isAutofixViewSecurityModalOpen:s,setIsAutofixViewSecurityModalOpen:n}=e,{project:r}=(0,k.Om)(),i=(0,G.jE)(),{isSuccess:l,isLoading:o,data:c}=(0,Q.G_)({id:null==t?void 0:t.id,projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString},{enabled:s&&(0,L.b4)(t)}),{mutate:d}=(0,K.Y)({onSuccess:async()=>{f.oR.success("View security changed successfully"),n(!1),await i.invalidateQueries(J.O.lint(null==r?void 0:r.ref))},onError:e=>{f.oR.error("Failed to autofix view security: ".concat(e.message))}});return(0,L.b4)(t)?(0,a.jsxs)($.A,{visible:s,size:"xlarge",title:"Confirm autofixing view security",confirmLabel:"Confirm",onCancel:()=>n(!1),onConfirm:()=>(function(){let e='\n	ALTER VIEW "'.concat(t.schema,'"."').concat(t.name,'" SET (security_invoker = on);\n	');d({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,sql:e})})(),"data-sentry-element":"ConfirmationModal","data-sentry-component":"ViewEntityAutofixSecurityModal","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Setting ",(0,a.jsx)("code",{children:"security_invoker=on"})," ensures the View runs with the permissions of the querying user, reducing the risk of unintended data exposure."]}),(0,a.jsxs)("div",{className:"flex items-center gap-8 mt-8",children:[(0,a.jsxs)("div",{className:" border rounded-md w-1/2",children:[(0,a.jsx)("div",{className:"p-4 pb-0 bg-200 font-mono text-sm font-semibold",children:"Existing query"}),(0,a.jsxs)(Y.FK,{className:"h-[225px] px-4 py-2","data-sentry-element":"ScrollArea","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[o&&(0,a.jsx)(Z.y,{}),l&&(0,a.jsx)(X.X,{children:"create view ".concat(t.schema,".").concat(t.name," as\n ").concat(c)})]})]}),(0,a.jsxs)("div",{className:" border rounded-md w-1/2",children:[(0,a.jsx)("div",{className:"p-4 pb-0 bg-200 font-mono text-sm font-semibold",children:"Updated query"}),(0,a.jsxs)(Y.FK,{className:"h-[225px] px-4 py-2","data-sentry-element":"ScrollArea","data-sentry-source-file":"ViewEntityAutofixSecurityModal.tsx",children:[o&&(0,a.jsx)(Z.y,{}),l&&(0,a.jsx)(X.X,{children:"create view ".concat(t.schema,".").concat(t.name," with (security_invoker = on) as\n ").concat(c)})]})]})]})]}):null}let et=e=>{var t;let{table:s}=e,{ref:r}=(0,g.g)(),{project:i}=(0,k.Om)(),l=(0,P.a)(),{data:o=[]}=(0,C.b)({projectRef:null==i?void 0:i.ref}),c=(0,L.KO)(s),d=(0,L.bL)(s),u=(0,L.eg)(s),p=(0,L.rW)(s),x=(0,D.x)("realtime:all"),b=O.i.includes(s.schema),{mutate:y}=(0,z.e)({onError:e=>{f.oR.error("Failed to toggle RLS: ".concat(e.message))},onSettled:()=>{ey()}}),[G,Q]=(0,h.useState)(!1),[J,K]=(0,h.useState)(!1),[Y,X]=(0,h.useState)(!1),Z=0===(0,W.Ir)().selectedRows.size,et=null==i?void 0:i.ref,{data:es}=(0,E.j)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),ea=(null!=es?es:[]).filter(e=>e.schema===s.schema&&e.table===s.name),{data:en}=(0,T._)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),er=(null!=en?en:[]).find(e=>"supabase_realtime"===e.name),ei=null!=(t=null==er?void 0:er.tables)?t:[],el=ei.some(e=>e.id===(null==s?void 0:s.id)),{mutate:eo,isLoading:ec}=(0,_.H)({onSuccess:()=>{Q(!1)},onError:e=>{f.oR.error("Failed to toggle realtime for ".concat(s.name,": ").concat(e.message))}}),ed=(0,M.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"tables"),eu=(0,M.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"columns"),em="public"===s.schema,{hasLint:ep,matchingLint:ex}=(0,S.t)(s.name,"security_definer_view",["ERROR","WARN"],o,s.schema),{hasLint:eh,matchingLint:ef}=(0,S.t)(s.name,"materialized_view_in_api",["ERROR","WARN"],o,s.schema),{mutate:eg}=(0,I.h)(),eb=async()=>{var e,t;if(!i)return console.error("Project is required");if(!er)return console.error("Unable to find realtime publication");let a=ei.some(e=>e.id==s.id),n=a?ei.filter(e=>e.id!=s.id).map(e=>"".concat(e.schema,".").concat(e.name)):["".concat(s.schema,".").concat(s.name)].concat(ei.map(e=>"".concat(e.schema,".").concat(e.name)));eg({action:"realtime_toggle_table_clicked",properties:{newState:a?"disabled":"enabled",origin:"tableGridHeader"},groups:{project:null!=(e=null==i?void 0:i.ref)?e:"Unknown",organization:null!=(t=null==l?void 0:l.slug)?t:"Unknown"}}),eo({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:er.id,tables:n})},ey=()=>{K(!1)},ev=async()=>{let e={id:s.id,rls_enabled:!(c&&s.rls_enabled)};y({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:s.id,name:s.name,schema:s.schema,payload:e})};return(0,a.jsxs)("div",{className:"sb-grid-header__inner","data-sentry-component":"GridHeaderActions","data-sentry-source-file":"GridHeaderActions.tsx",children:[Z&&(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[!ed&&!eu&&(0,a.jsxs)(q.m_,{children:[(0,a.jsx)(q.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"border border-strong rounded bg-overlay-hover px-3 py-1 text-xs",children:"Viewing as read-only"})}),(0,a.jsx)(q.ZI,{side:"bottom",children:"You need additional permissions to manage your project's data"})]}),c&&!b?s.rls_enabled?(0,a.jsx)(a.Fragment,{children:ea.length<1&&!b?(0,a.jsx)(R.G,{asChild:!0,type:"default",className:"group",icon:(0,a.jsx)(v.A,{strokeWidth:1.5,className:"text-foreground-muted"}),tooltip:{content:{side:"bottom",className:"w-[280px]",text:"RLS is enabled for this table, but no policies are set. Select queries may return 0 results."}},children:(0,a.jsx)(m(),{passHref:!0,href:"/project/".concat(et,"/auth/policies?search=").concat(s.id,"&schema=").concat(s.schema),children:"Add RLS policy"})}):(0,a.jsx)(H.$,{asChild:!0,type:ea.length<1&&!b?"warning":"default",className:"group",icon:b||ea.length>0?(0,a.jsx)("div",{className:(0,B.cn)("flex items-center justify-center rounded-full bg-border-stronger h-[16px]",ea.length>9?" px-1":"w-[16px]",""),children:(0,a.jsx)("span",{className:"text-[11px] text-foreground font-mono text-center",children:ea.length})}):(0,a.jsx)(v.A,{strokeWidth:1.5}),children:(0,a.jsxs)(m(),{passHref:!0,href:"/project/".concat(et,"/auth/policies?search=").concat(s.id,"&schema=").concat(s.schema),children:["Auth ",ea.length>1?"policies":"policy"]})})}):(0,a.jsxs)(F.AM,{modal:!1,children:[(0,a.jsx)(F.Wv,{asChild:!0,children:(0,a.jsx)(H.$,{type:"warning",icon:(0,a.jsx)(j.A,{strokeWidth:1.5}),children:"RLS disabled"})}),(0,a.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{size:16})," Row Level Security (RLS)"]}),(0,a.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,a.jsx)("p",{children:"You can restrict and control who can read, write and update data in this table using Row Level Security."}),(0,a.jsx)("p",{children:"With RLS enabled, anonymous users will not be able to read/write data in the table."}),!b&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(H.$,{type:"default",onClick:()=>K(!J),children:"Enable RLS for this table"})})]})]})]}):null,u&&ep&&(0,a.jsxs)(F.AM,{modal:!1,children:[(0,a.jsx)(F.Wv,{asChild:!0,children:(0,a.jsx)(H.$,{type:"warning",icon:(0,a.jsx)(w.A,{strokeWidth:1.5}),children:"Security Definer view"})}),(0,a.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{size:16})," Secure your View"]}),(0,a.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,a.jsx)("p",{children:"This view is defined with the Security Definer property, giving it permissions of the view's creator (Postgres), rather than the permissions of the querying user."}),(0,a.jsx)("p",{children:"Since this view is in the public schema, it is accessible via your project's APIs."}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,a.jsx)(H.$,{type:"secondary",onClick:()=>{X(!0)},children:"Autofix"}),(0,a.jsx)(H.$,{type:"default",asChild:!0,children:(0,a.jsx)(m(),{target:"_blank",href:"/project/".concat(r,"/advisors/security?preset=").concat(null==ex?void 0:ex.level,"&id=").concat(null==ex?void 0:ex.cache_key),children:"Learn more"})})]})]})]})]}),p&&eh&&(0,a.jsxs)(F.AM,{modal:!1,children:[(0,a.jsx)(F.Wv,{asChild:!0,children:(0,a.jsx)(H.$,{type:"warning",icon:(0,a.jsx)(w.A,{strokeWidth:1.5}),children:"Security Definer view"})}),(0,a.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{size:16})," Secure your View"]}),(0,a.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,a.jsx)("p",{children:"This view is defined with the Security Definer property, giving it permissions of the view's creator (Postgres), rather than the permissions of the querying user."}),(0,a.jsx)("p",{children:"Since this view is in the public schema, it is accessible via your project's APIs."}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(H.$,{type:"default",asChild:!0,children:(0,a.jsx)(m(),{target:"_blank",href:"/project/".concat(r,"/advisors/security?preset=").concat(null==ef?void 0:ef.level,"&id=").concat(null==ef?void 0:ef.cache_key),children:"Learn more"})})})]})]})]}),d&&"public"===s.schema&&(0,a.jsxs)(F.AM,{modal:!1,children:[(0,a.jsx)(F.Wv,{asChild:!0,children:(0,a.jsx)(H.$,{type:"warning",icon:(0,a.jsx)(w.A,{strokeWidth:1.5}),children:"Unprotected Data API access"})}),(0,a.jsxs)(F.hl,{portal:!0,className:"min-w-[395px] text-sm",align:"end",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{size:16})," Secure Foreign table"]}),(0,a.jsxs)("div",{className:"grid gap-2 mt-4 text-foreground-light text-sm",children:[(0,a.jsxs)("p",{children:["Foreign tables do not enforce RLS, which may allow unrestricted access. To secure them, either move foreign tables to a private schema not exposed by PostgREST, or ",(0,a.jsx)("a",{href:"",children:"disable PostgREST access"})," entirely."]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(H.$,{type:"default",asChild:!0,children:(0,a.jsx)(m(),{target:"_blank",href:"https://supabase.com/docs/guides/database/extensions/wrappers/overview#security",children:"Learn more"})})})]})]})]}),(0,a.jsx)(U.g,{serviceRoleLabel:"postgres"}),c&&x&&(0,a.jsxs)(H.$,{type:"default",icon:(0,a.jsx)(N,{strokeWidth:1.5,className:el?"text-brand":"text-foreground-muted"}),onClick:()=>Q(!0),children:["Realtime ",el?"on":"off"]}),em&&(0,a.jsx)(A.A,{section:["entities",s.name]})]}),(0,a.jsx)($.A,{visible:G,loading:ec,title:"".concat(el?"Disable":"Enable"," realtime for ").concat(s.name),confirmLabel:"".concat(el?"Disable":"Enable"," realtime"),confirmLabelLoading:"".concat(el?"Disabling":"Enabling"," realtime"),onCancel:()=>Q(!1),onConfirm:()=>eb(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GridHeaderActions.tsx",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm",children:["Once realtime has been ",el?"disabled":"enabled",", the table will"," ",el?"no longer ":"","broadcast any changes to authorized subscribers."]}),!el&&(0,a.jsxs)("p",{className:"text-sm",children:["You may also select which events to broadcast to subscribers on the"," ",(0,a.jsx)(m(),{href:"/project/".concat(r,"/database/publications"),className:"text-brand",children:"database publications"})," ","settings."]})]})}),(0,a.jsx)(ee,{table:s,isAutofixViewSecurityModalOpen:Y,setIsAutofixViewSecurityModalOpen:X,"data-sentry-element":"ViewEntityAutofixSecurityModal","data-sentry-source-file":"GridHeaderActions.tsx"}),c&&(0,a.jsx)(V.A,{danger:s.rls_enabled,visible:J,title:"Confirm to enable Row Level Security",description:"Are you sure you want to enable Row Level Security for this table?",buttonLabel:"Enable RLS",buttonLoadingLabel:"Updating",onSelectCancel:ey,onSelectConfirm:ev})]})};var es=s(52042),ea=s(6256),en=s(45897),er=s(49508),ei=s(42206),el=s(96040),eo=s(17082),ec=s(2456),ed=s(55742);let eu=e=>{let{portal:t=!0}=e,{urlFilters:s,onApplyFilters:n}=(0,b.M)(),r=(0,h.useMemo)(()=>(0,ec.hl)(null!=s?s:[]),[s]);return(0,a.jsx)(ed.b,{portal:t,filters:r,onApplyFilters:n,"data-sentry-element":"FilterPopoverPrimitive","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx"})};var em=s(96652);let ep=e=>{var t;let{portal:s=!0}=e,{urlSorts:n,onApplySorts:r}=(0,y.G)(),i=(0,W.Ir)(),l=(null==i||null==(t=i.table)?void 0:t.name)||"",o=(0,h.useMemo)(()=>l&&n?(0,ec.FU)(l,n):[],[l,n]);return(0,a.jsx)(em.l,{portal:s,sorts:o,onApplySorts:r,"data-sentry-element":"SortPopoverPrimitive","data-sentry-component":"SortPopover","data-sentry-source-file":"SortPopover.tsx"})},ex=5e5,eh=(0,a.jsxs)(a.Fragment,{children:["Sorry! We're unable to support exporting row counts larger than $",ex.toLocaleString()," at the moment. Alternatively, you may consider using",(0,a.jsx)(m(),{href:"https://supabase.com/docs/reference/cli/supabase-db-dump",target:"_blank",children:"pg_dump"})," ","via our CLI instead."]}),ef=e=>{let{customHeader:t}=e,s=(0,W.Ir)();return(0,a.jsx)("div",{"data-sentry-component":"Header","data-sentry-source-file":"Header.tsx",children:(0,a.jsxs)("div",{className:"flex h-10 items-center justify-between bg-dash-sidebar dark:bg-surface-100 px-1.5 py-1.5 gap-2 overflow-x-auto ",children:[t||(s.selectedRows.size>0?(0,a.jsx)(eb,{}):(0,a.jsx)(eg,{})),(0,a.jsx)(et,{table:s.originalTable,"data-sentry-element":"GridHeaderActions","data-sentry-source-file":"Header.tsx"})]})})},eg=()=>{var e;let{ref:t}=(0,g.g)(),s=(0,er.ap)(),r=(0,W.Ir)(),i=(0,P.a)(),d=(0,M.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"columns"),{mutate:u}=(0,I.h)(),m=r.editable&&(null!=(e=r.table.columns)?e:[]).length>0?s.onAddRow:void 0,p=r.editable?s.onAddColumn:void 0,x=r.editable?s.onImportData:void 0;return(0,a.jsxs)("div",{className:"flex items-center gap-4","data-sentry-component":"DefaultHeader","data-sentry-source-file":"Header.tsx",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eu,{"data-sentry-element":"FilterPopover","data-sentry-source-file":"Header.tsx"}),(0,a.jsx)(ep,{"data-sentry-element":"SortPopover","data-sentry-source-file":"Header.tsx"})]}),(void 0!==m||void 0!==p)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-[20px] w-px border-r border-control"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:d&&(0,a.jsxs)(ei.rI,{children:[(0,a.jsx)(ei.ty,{asChild:!0,children:(0,a.jsx)(H.$,{"data-testid":"table-editor-insert-new-row",type:"primary",size:"tiny",icon:(0,a.jsx)(l.A,{strokeWidth:1.5}),children:"Insert"})}),(0,a.jsx)(ei.SQ,{side:"bottom",align:"start",children:[...void 0!==m?[(0,a.jsxs)(ei._2,{className:"group space-x-2",onClick:m,children:[(0,a.jsxs)("div",{className:"-mt-2 pr-1.5",children:[(0,a.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px]"}),(0,a.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px] my-[2px]"}),(0,a.jsx)("div",{className:(0,B.cn)(["border border-foreground-light w-[15px] h-[4px] translate-x-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-x-0"])})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Insert row"}),(0,a.jsxs)("p",{className:"text-foreground-light",children:["Insert a new row into ",r.table.name]})]})]},"add-row")]:[],...void 0!==p?[(0,a.jsxs)(ei._2,{className:"group space-x-2",onClick:p,children:[(0,a.jsxs)("div",{className:"flex -mt-2 pr-1.5",children:[(0,a.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px]"}),(0,a.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px] mx-[2px]"}),(0,a.jsx)("div",{className:(0,B.cn)(["border border-foreground-light w-[4px] h-[15px] -translate-y-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-y-0"])})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Insert column"}),(0,a.jsxs)("p",{className:"text-foreground-light",children:["Insert a new column into ",r.table.name]})]})]},"add-column")]:[],...void 0!==x?[(0,a.jsxs)(ei._2,{className:"group space-x-2",onClick:()=>{var e;x(),u({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!=t?t:"Unknown",organization:null!=(e=null==i?void 0:i.slug)?e:"Unknown"}})},children:[(0,a.jsxs)("div",{className:"relative -mt-2",children:[(0,a.jsx)(o.A,{size:18,strokeWidth:1.5,className:"-translate-x-[2px]"}),(0,a.jsx)(c.A,{className:(0,B.cn)("transition duration-200 absolute bottom-0 right-0 translate-y-1 opacity-0 bg-brand-400 rounded-full","group-data-[highlighted]:translate-y-0 group-data-[highlighted]:text-brand group-data-[highlighted]:opacity-100"),strokeWidth:3,size:12})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Import data from CSV"}),(0,a.jsx)("p",{className:"text-foreground-light",children:"Insert new rows from a CSV"})]})]},"import-data")]:[]]})]})})]})]})},eb=()=>{var e,t;let{project:s}=(0,k.Om)(),n=(0,er.ap)(),r=(0,W.Ir)(),o=(0,en.RY)(),c=void 0!==o.role,{filters:u}=(0,b.M)(),{sorts:m}=(0,y.G)(),[p,g]=(0,h.useState)(!1),{data:v}=(0,ea.vs)({projectRef:null==s?void 0:s.ref,connectionString:null==s?void 0:s.connectionString,tableId:r.table.id,sorts:m,filters:u,page:r.page,limit:n.rowsPerPage,roleImpersonationState:o}),{data:j}=(0,es.gt)({projectRef:null==s?void 0:s.ref,connectionString:null==s?void 0:s.connectionString,tableId:r.table.id,filters:u,enforceExactCount:r.enforceExactCount,roleImpersonationState:o},{keepPreviousData:!0}),w=null!=(e=null==v?void 0:v.rows)?e:[],N=null!=(t=null==j?void 0:j.count)?t:0,A=()=>{r.setSelectedRows(new Set(w.map(e=>e.idx)),!0)};async function E(){if(g(!0),r.allRowsSelected&&N>ex)return f.oR.error((0,a.jsx)("div",{className:"prose text-sm text-foreground",children:eh})),g(!1);if(!s)return f.oR.error("Project is required"),g(!1);let e=r.allRowsSelected?(0,f.oR)((0,a.jsx)(el.t,{progress:0,message:"Exporting all rows from ".concat(r.table.name)}),{closeButton:!1,duration:1/0}):f.oR.loading("Exporting ".concat(r.selectedRows.size," row").concat(r.selectedRows.size>1?"s":""," from ").concat(r.table.name)),t=r.allRowsSelected?await (0,ea.HQ)({projectRef:s.ref,connectionString:s.connectionString,table:r.table,filters:u,sorts:m,roleImpersonationState:o,progressCallback:t=>{let s=Math.min(t/N*100,100);(0,f.oR)((0,a.jsx)(el.t,{progress:s,message:"Exporting all rows from ".concat(r.table.name)}),{id:e,closeButton:!1,duration:1/0})}}):w.filter(e=>r.selectedRows.has(e.idx));if(0===t.length){f.oR.dismiss(e),f.oR.error("Export failed, please try exporting again"),g(!1);return}let n=t.map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e)),l=new Blob([x().unparse(n,{columns:r.table.columns.map(e=>e.name)})],{type:"text/csv;charset=utf-8;"});f.oR.success("Downloaded ".concat(t.length," rows to CSV"),{id:e,closeButton:!0,duration:4e3}),i()(l,"".concat(r.table.name,"_rows.csv")),g(!1)}async function T(){if(g(!0),r.allRowsSelected&&N>ex)return f.oR.error((0,a.jsx)("div",{className:"prose text-sm text-foreground",children:eh})),g(!1);if(!s)return f.oR.error("Project is required"),g(!1);if(r.allRowsSelected&&0===N)return f.oR.error("Export failed, please try exporting again"),g(!1);let e=r.allRowsSelected?(0,f.oR)((0,a.jsx)(el.t,{progress:0,message:"Exporting all rows from ".concat(r.table.name)}),{closeButton:!1,duration:1/0}):f.oR.loading("Exporting ".concat(r.selectedRows.size," row").concat(r.selectedRows.size>1?"s":""," from ").concat(r.table.name)),t=r.allRowsSelected?await (0,ea.HQ)({projectRef:s.ref,connectionString:s.connectionString,table:r.table,filters:u,sorts:m,roleImpersonationState:o,progressCallback:t=>{let s=Math.min(t/N*100,100);(0,f.oR)((0,a.jsx)(el.t,{progress:s,message:"Exporting all rows from ".concat(r.table.name)}),{id:e,closeButton:!1,duration:1/0})}}):w.filter(e=>r.selectedRows.has(e.idx));if(0===t.length){f.oR.error("Export failed, please exporting try again"),g(!1);return}let n=new Blob([(0,S.S)(r.table,t)],{type:"text/sql;charset=utf-8;"});f.oR.success("Downloading ".concat(t.length," rows to SQL"),{id:e,closeButton:!0,duration:4e3}),i()(n,"".concat(r.table.name,"_rows.sql")),g(!1)}return(0,en.sc)(()=>{(r.allRowsSelected||r.selectedRows.size>0)&&r.setSelectedRows(new Set)}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2","data-sentry-component":"RowHeader","data-sentry-source-file":"Header.tsx",children:[r.editable&&(0,a.jsx)(R.G,{type:"default",size:"tiny",icon:(0,a.jsx)(d.A,{}),onClick:()=>{let e=r.allRowsSelected?N:r.selectedRows.size,t=Array.from(r.selectedRows),s=w.filter(e=>t.includes(e.idx));n.onDeleteRows(s,{allRowsSelected:r.allRowsSelected,numRows:e,callback:()=>{r.setSelectedRows(new Set)}})},disabled:r.allRowsSelected&&c,tooltip:{content:{side:"bottom",text:r.allRowsSelected&&c?"Table truncation is not supported when impersonating a role":void 0}},children:r.allRowsSelected?"Delete all rows in table":r.selectedRows.size>1?"Delete ".concat(r.selectedRows.size," rows"):"Delete ".concat(r.selectedRows.size," row")}),(0,a.jsxs)(ei.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Header.tsx",children:[(0,a.jsx)(ei.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Header.tsx",children:(0,a.jsx)(H.$,{type:"default",size:"tiny",iconRight:(0,a.jsx)(l.A,{}),loading:p,disabled:p,"data-sentry-element":"Button","data-sentry-source-file":"Header.tsx",children:"Export"})}),(0,a.jsxs)(ei.SQ,{className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Header.tsx",children:[(0,a.jsx)(ei._2,{onClick:E,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:(0,a.jsx)("span",{className:"text-foreground-light",children:"Export to CSV"})}),(0,a.jsx)(ei._2,{onClick:T,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:"Export to SQL"})]})]}),!r.allRowsSelected&&N>w.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-6 ml-0.5",children:(0,a.jsx)(eo.w,{orientation:"vertical"})}),(0,a.jsx)(H.$,{type:"text",onClick:()=>A(),children:"Select all rows in table"})]})]})}},15922:(e,t,s)=>{"use strict";s.d(t,{_:()=>l});var a=s(56947),n=s(48678),r=s(29076);async function i(e,t){let{projectRef:s,connectionString:a}=e;if(!s)throw Error("projectRef is required");let r=new Headers;a&&r.set("x-connection-encrypted",a);let{data:i,error:l}=await (0,n.Jt)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":a},path:{ref:s}},headers:r,signal:t});return l&&(0,n.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:s}=e,{enabled:n=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.b.list(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:s},a)},{enabled:n&&void 0!==t,...l})}},17162:(e,t,s)=>{"use strict";s.d(t,{G_:()=>o});var a=s(56947),n=s(18232),r=s(67394);let i=e=>{let{id:t}=e;if(!t)throw Error("id is required");return"\n    with table_info as (\n      select \n        n.nspname::text as schema,\n        c.relname::text as name,\n        to_regclass(concat('\"', n.nspname, '\".\"', c.relname, '\"')) as regclass\n      from pg_class c\n      join pg_namespace n on n.oid = c.relnamespace\n      where c.oid = ".concat(t,"\n    )\n    select pg_get_viewdef(t.regclass, true) as definition\n    from table_info t\n  ").trim()};async function l(e,t){let{projectRef:s,connectionString:a,id:r}=e,l=i({id:r}),{result:o}=await (0,n.E)({projectRef:s,connectionString:a,sql:l,queryKey:["view-definition",r]},t);return o[0].definition.trim()}let o=function(e){let{projectRef:t,connectionString:s,id:n}=e,{enabled:i=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.c.viewDefinition(t,n),e=>{let{signal:a}=e;return l({projectRef:t,connectionString:s,id:n},a)},{enabled:i&&void 0!==t&&void 0!==n&&!isNaN(n),...o})}},18075:(e,t,s)=>{"use strict";s.d(t,{$:()=>_});var a=s(80263),n=s(74176),r=s(25481),i=s(53674),l=s(82457),o=s(72865),c=s(58789),d=s(14803),u=s(23480),m=s(85462);function p(e){let{hideTabs:t}=e,{showSidebar:s,setShowSidebar:n}=(0,u.qM)();return(0,a.jsxs)(m.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"CollapseButton","data-sentry-source-file":"CollapseButton.tsx",children:[(0,a.jsx)(m.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"CollapseButton.tsx",children:(0,a.jsx)("button",{className:(0,l.cn)("flex items-center justify-center w-10 h-10 hover:bg-surface-100 shrink-0",!t&&"border-b border-b-default"),onClick:()=>n(!s),children:s?(0,a.jsx)(c.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"}):(0,a.jsx)(d.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"})})}),(0,a.jsxs)(m.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"CollapseButton.tsx",children:["Collapse"," sidebar"]})]})}var x=s(26779),h=s(47625),f=s(88712),g=s(37055),b=s(55060),y=s(29260),v=s(87355),j=s(16425),w=s(91218),N=s(45159),S=s(87604),k=s(53239),A=s(25650);let R=e=>{var t;let{tab:s,index:n,openTabs:r,onClose:o}=e,c=(0,v.useRouter)().query.schema||"public",d=(0,i.zv)(),{attributes:u,listeners:m,setNodeRef:p,transform:x,transition:b,isDragging:w}=(0,h.gl)({id:s.id}),N={transform:S.Ks.Transform.toString(x),transition:b,zIndex:+!!w},R=(0,k.useMemo)(()=>"r"===s.type&&r.filter(e=>"r"===e.type).some(e=>{var t;return(null==(t=e.metadata)?void 0:t.schema)!==c}),[r,c,s.type]);return(0,a.jsxs)(g.P.div,{ref:p,style:N,...u,layoutId:s.id,transition:{duration:.045},animate:{opacity:+!w},className:(0,l.cn)("flex items-center h-10 first-of-type:border-l"),"data-sentry-element":"unknown","data-sentry-component":"SortableTab","data-sentry-source-file":"SortableTab.tsx",children:[(0,a.jsxs)(j.Xi,{value:s.id,onDoubleClick:()=>d.makeTabPermanent(s.id),className:(0,l.cn)("flex items-center gap-2 pl-3 pr-2.5 text-xs","bg-dash-sidebar/50 dark:bg-surface-100/50","data-[state=active]:bg-dash-sidebar dark:data-[state=active]:bg-surface-100","border-b border-default","data-[state=active]:border-b-background-dash-sidebar dark:data-[state=active]:border-b-background-surface-100","relative group h-full","hover:bg-surface-300 dark:hover:bg-surface-100",s.isPreview&&"italic font-light"),...m,"data-sentry-element":"TabsTrigger_Shadcn_","data-sentry-source-file":"SortableTab.tsx",children:[(0,a.jsx)(A.L,{type:s.type,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"SortableTab.tsx"}),(0,a.jsxs)("div",{className:"flex items-center gap-0",children:[(0,a.jsx)(f.N,{mode:"popLayout",initial:!0,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"SortableTab.tsx",children:R&&(0,a.jsxs)(g.P.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"text-foreground-muted group-data-[state=active]:text-foreground-lighter",children:[null==s||null==(t=s.metadata)?void 0:t.schema,"."]})}),(0,a.jsx)("span",{children:s.label||"Untitled"})]}),(0,a.jsx)("span",{role:"button",onClick:e=>{e.preventDefault(),e.stopPropagation()},className:"p-0.5 ml-1 opacity-0 group-hover:opacity-100 hover:bg-200 rounded-sm cursor-pointer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onPointerDown:e=>{e.preventDefault(),e.stopPropagation(),o(s.id)},children:(0,a.jsx)(y.A,{size:12,className:"text-foreground-light","data-sentry-element":"X","data-sentry-source-file":"SortableTab.tsx"})}),(0,a.jsx)("div",{className:"absolute w-full top-0 left-0 right-0 h-px bg-foreground opacity-0 group-data-[state=active]:opacity-100"})]}),n<r.length&&(0,a.jsx)("div",{role:"separator",className:"h-full w-px bg-border"},"separator-".concat(s.id))]})},E=e=>{let{tab:t}=e,{ref:s}=(0,r.g)(),n=(0,i.zv)().tabsMap[t];return n?(0,a.jsxs)(g.P.div,{layoutId:t,transition:{duration:.045},animate:{opacity:.7},className:"flex relative items-center gap-2 px-3 text-xs bg-dash-sidebar dark:bg-surface-100 shadow-lg rounded-sm h-10","data-sentry-element":"unknown","data-sentry-component":"TabPreview","data-sentry-source-file":"TabPreview.tsx",children:[(0,a.jsx)(A.L,{type:n.type,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"TabPreview.tsx"}),(0,a.jsx)("span",{children:n.label||"Untitled"}),(0,a.jsx)("div",{className:"absolute w-full top-0 left-0 right-0 h-px bg-foreground-muted"})]}):null},T=()=>{var e;let{ref:t,id:s}=(0,r.g)(),n=(0,v.useRouter)(),o=(0,u.qM)(),c=(0,N.l)(),d=(0,i.zv)(),m=(0,x.FR)((0,x.MS)(x.AN,{activationConstraint:{distance:1}})),S=d.openTabs.map(e=>d.tabsMap[e]).filter(e=>void 0!==e),k=n.asPath.includes("/new"),A=c?S.filter(e=>{var t;return null==(t=i.qm[c])?void 0:t.includes(e.type)}):[],T=()=>{t&&c&&o.setDashboardHistory(t,"table"===c?"editor":c,void 0)},_=e=>{d.handleTabClose({id:e,router:n,editor:c,onClearDashboardHistory:T})},C=()=>{if(c){let e="table"===c?d.openTabs.filter(e=>!e.startsWith("sql")):d.openTabs.filter(e=>e.startsWith("sql"));d.removeTabs(e),T(),n.push("/project/".concat(t,"/").concat("table"===c?"editor":"sql"))}},L=e=>{if(c){let a="table"===c?d.openTabs.filter(t=>!t.startsWith("sql")&&t!==e):d.openTabs.filter(t=>t.startsWith("sql")&&t!==e);d.removeTabs(a),T();let r="table"===c?e.split("-")[1]:e.split("sql-")[1];s!==r&&n.push("/project/".concat(t,"/").concat("table"===c?"editor":"sql","/").concat(r))}},z=e=>{if(c){let t="table"===c?d.openTabs.filter(e=>!e.startsWith("sql")):d.openTabs.filter(e=>e.startsWith("sql")),s=t.indexOf(e),a=t.slice(s+1);d.removeTabs(a)}};return(0,a.jsxs)(x.Mp,{sensors:m,onDragEnd:e=>{let{active:t,over:s}=e;if(!s||t.id===s.id)return;let a=d.openTabs.indexOf(t.id.toString()),r=d.openTabs.indexOf(s.id.toString());a!==r&&d.handleTabDragEnd(a,r,t.id.toString(),n)},"data-sentry-element":"DndContext","data-sentry-component":"EditorTabs","data-sentry-source-file":"Tabs.tsx",children:[(0,a.jsxs)(j.tU,{className:"w-full flex",value:k?"new":null!=(e=d.activeTab)?e:void 0,onValueChange:e=>{d.handleTabNavigation(e,n)},"data-sentry-element":"Tabs_Shadcn_","data-sentry-source-file":"Tabs.tsx",children:[(0,a.jsx)(p,{hideTabs:!1,"data-sentry-element":"CollapseButton","data-sentry-source-file":"Tabs.tsx"}),(0,a.jsxs)(j.j7,{className:(0,l.cn)("rounded-b-none gap-0 h-10 flex items-center w-full z-[1]","bg-surface-200 dark:bg-alternative border-none overflow-clip overflow-x-auto"),"data-sentry-element":"TabsList_Shadcn_","data-sentry-source-file":"Tabs.tsx",children:[(0,a.jsx)(h.gB,{items:A.map(e=>e.id),strategy:h.m$,"data-sentry-element":"SortableContext","data-sentry-source-file":"Tabs.tsx",children:A.map((e,t)=>(0,a.jsxs)(w.tz,{children:[(0,a.jsx)(w.Rc,{children:(0,a.jsx)(R,{tab:e,index:t,openTabs:S,onClose:()=>_(e.id)},e.id)}),(0,a.jsxs)(w.Ip,{children:[(0,a.jsx)(w.kt,{onClick:()=>_(e.id),children:"Close"}),(0,a.jsx)(w.kt,{onClick:()=>L(e.id),children:"Close Others"}),(0,a.jsx)(w.kt,{onClick:()=>z(e.id),children:"Close to the Right"}),(0,a.jsx)(w.kt,{onClick:C,children:"Close All"})]})]}))}),k&&(0,a.jsxs)(j.Xi,{value:"new",className:(0,l.cn)("flex items-center gap-2 px-3 text-xs","bg-dash-sidebar/50 dark:bg-surface-100/50","data-[state=active]:bg-dash-sidebar dark:data-[state=active]:bg-surface-100","relative group h-full border-t-2 !border-b-0","hover:bg-surface-300 dark:hover:bg-surface-100"),children:[(0,a.jsx)(b.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter"}),(0,a.jsx)("div",{className:"flex items-center gap-0",children:(0,a.jsx)("span",{children:"New"})}),(0,a.jsx)("span",{role:"button",onClick:e=>{e.preventDefault(),e.stopPropagation()},className:"ml-1 opacity-0 group-hover:opacity-100 hover:bg-200 rounded-sm cursor-pointer",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onPointerDown:e=>{e.preventDefault(),e.stopPropagation(),_("new")},children:(0,a.jsx)(y.A,{size:12,className:"text-foreground-light"})})," ",(0,a.jsx)("div",{className:"absolute w-full -bottom-[1px] left-0 right-0 h-px bg-dash-sidebar dark:bg-surface-100 opacity-0 group-data-[state=active]:opacity-100"})]}),(0,a.jsx)(f.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"Tabs.tsx",children:!k&&(0,a.jsx)(g.P.button,{className:"flex items-center justify-center w-10 h-10 hover:bg-surface-100 shrink-0 border-b",onClick:()=>n.push("/project/".concat(n.query.ref,"/").concat("table"===c?"editor":"sql","/new?skip=true")),initial:{opacity:0,scale:.8,x:-10},animate:{opacity:1,scale:1,x:0},transition:{duration:.2},children:(0,a.jsx)(b.A,{size:16,strokeWidth:1.5,className:"text-foreground-lighter hover:text-foreground-light"})})}),(0,a.jsx)("div",{className:"grow h-full border-b pr-6"})]})]}),(0,a.jsx)(x.Hd,{dropAnimation:null,"data-sentry-element":"DragOverlay","data-sentry-source-file":"Tabs.tsx",children:d.activeTab?(0,a.jsx)(E,{tab:d.activeTab}):null})]})},_=e=>{let{children:t,title:s,product:c,...d}=e,{ref:u}=(0,r.g)(),m=(0,n.usePathname)(),x=(0,N.l)(),h=(0,i.zv)(),f="table"===x&&0===h.openTabs.filter(e=>!e.startsWith("sql")).length,g=m==="/project/".concat(u,"/editor")||m==="/project/".concat(u,"/sql")||f;return(0,a.jsx)(o.S,{resizableSidebar:!0,title:s,product:c,...d,"data-sentry-element":"ProjectLayoutWithAuth","data-sentry-component":"EditorBaseLayout","data-sentry-source-file":"EditorBaseLayout.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:(0,l.cn)("h-10 flex items-center",g?"bg-surface-100":"bg-surface-200 dark:bg-alternative"),children:g?(0,a.jsx)(p,{hideTabs:g}):(0,a.jsx)(T,{})}),(0,a.jsx)("div",{className:"h-full",children:t})]})})}},24391:(e,t,s)=>{"use strict";s.d(t,{k:()=>a});let a={list:e=>["projects",e,"views"],listBySchema:(e,t)=>[...a.list(e),t]}},25650:(e,t,s)=>{"use strict";s.d(t,{L:()=>d});var a=s(80263),n=s(36662),r=s(69399),i=s(73451),l=s(15777),o=s(23601),c=s(82457);let d=e=>{var t,s,d;let{type:u,size:m=15,strokeWidth:p=1.5,isActive:x}=e;return"sql"===u?(0,a.jsx)(o.ty,{size:m,className:(0,c.cn)("transition-colors","fill-foreground-muted","group-aria-selected:fill-foreground","w-4 h-4","-ml-0.5"),strokeWidth:p}):u===n.z.TABLE?(0,a.jsx)(r.A,{size:m,strokeWidth:p,className:(0,c.cn)("text-foreground-muted group-hover:text-foreground-lighter group-aria-selected:text-foreground",x&&"text-foreground-light","transition-colors")}):"schema"===u?(0,a.jsx)(i.A,{size:m,strokeWidth:p}):u===n.z.VIEW?(0,a.jsx)(l.A,{size:m,strokeWidth:p,className:(0,c.cn)("text-foreground-muted group-hover:text-foreground-lighter",x&&"text-foreground-lighter","transition-colors")}):(0,a.jsx)("div",{className:(0,c.cn)("flex items-center justify-center text-xs h-4 w-4 rounded-[2px] font-bold",u===n.z.FOREIGN_TABLE&&"text-yellow-900 bg-yellow-500",u===n.z.MATERIALIZED_VIEW&&"text-purple-1000 bg-purple-500",u===n.z.PARTITIONED_TABLE&&"text-foreground-light bg-border-stronger"),"data-sentry-component":"EntityTypeIcon","data-sentry-source-file":"EntityTypeIcon.tsx",children:null==(d=Object.entries(n.z).find(e=>{let[,t]=e;return t===u}))||null==(s=d[0])||null==(t=s[0])?void 0:t.toUpperCase()})}},29076:(e,t,s)=>{"use strict";s.d(t,{b:()=>a});let a={list:e=>["projects",e,"database-publications"]}},30225:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(80263),n=s(35421),r=s(23480),i=s(37263);let l=e=>{let{section:t}=e,s=(0,r.qM)();return(0,a.jsx)(i.$,{size:"tiny",type:"default",onClick:()=>{t&&s.setActiveDocsSection(t),s.setShowProjectApiDocs(!0)},icon:(0,a.jsx)(n.A,{strokeWidth:1.5,className:"text-foreground-muted"}),"data-sentry-element":"Button","data-sentry-component":"APIDocsButton","data-sentry-source-file":"APIDocsButton.tsx",children:"API Docs"})}},32178:(e,t,s)=>{"use strict";s.d(t,{A:()=>ef});var a=s(80263),n=s(60045),r=s(53667),i=s.n(r),l=s(55060),o=s(77474),c=s(53239),d=s(25481),u=s(8974),m=s(97769),p=s(36500),x=s(80948),h=s(13933),f=s(41560),g=s(40882),b=s(89635),y=s(36662),v=s(6079),j=s(11291),w=s(19070),N=s(19214),S=s(49372),k=s(70847),A=s(49508),R=s(96773),E=s(37263),T=s(67928),_=s(75382),C=s(97337),L=s(46160),z=s(9895),I=s(99130),M=s(95137),D=s.n(M),P=s(58667),O=s(7298),W=s(669),q=s(1933),H=s(71147),B=s(432),F=s(98990),V=s(63678),$=s(8758),U=s.n($),G=s(77191),Q=s.n(G),J=s(73969),K=s(8278),Y=s(2456),X=s(6541),Z=s(25650),ee=s(93949),et=s(52346),es=s(55335),ea=s(93661),en=s(6256),er=s(48252),ei=s(53674),el=s(82457),eo=s(23601),ec=s(85462),ed=s(42206),eu=s(37356);let em=e=>{let{entity:t,isActive:s,tableHasLints:n,viewHasLints:r,materializedViewHasLints:i}=e,l="";switch(t.type){case y.z.TABLE:n&&(l="RLS disabled");break;case y.z.VIEW:r&&(l="Security definer view");break;case y.z.MATERIALIZED_VIEW:i&&(l="Security definer view");break;case y.z.FOREIGN_TABLE:l="RLS is not enforced on foreign tables"}return l?(0,a.jsxs)(ec.m_,{disableHoverableContent:!0,children:[(0,a.jsx)(ec.k$,{className:"min-w-4",children:(0,a.jsx)(V.A,{size:14,strokeWidth:2,className:(0,el.cn)("min-w-4",s?"text-warning-600":"text-warning-500")})}),(0,a.jsx)(ec.ZI,{side:"bottom",children:(0,a.jsx)("span",{children:l})})]}):null},ep=e=>{let{id:t,projectRef:s,item:n,isLocked:r,isActive:i}=e,{project:l}=(0,z.Om)(),o=(0,A.ap)(),{selectedSchema:c}=(0,S.k)(),u=(0,ei.lW)(n.type,{id:n.id}),m=(0,ei.zv)(),p=m.previewTabId===u,x=Object.values(m.tabsMap).some(e=>{var t;return(null==(t=e.metadata)?void 0:t.tableId)===n.id}),h=Number(t)===n.id,f=h&&!r,{data:g=[]}=(0,et.b)({projectRef:null==l?void 0:l.ref}),b=(0,X.t)(n.name,"rls_disabled_in_public",["ERROR"],g,c).hasLint,v=(0,X.t)(n.name,"security_definer_view",["ERROR","WARN"],g,c).hasLint,w=(0,X.t)(n.name,"materialized_view_in_api",["ERROR","WARN"],g,c).hasLint,N=async()=>{if(d.pe&&!(null==l?void 0:l.connectionString))return console.error("Connection string is required");let e=J.oR.loading("Exporting ".concat(n.name," as CSV..."));try{let t=await (0,j.Ap)({id:n.id,projectRef:s,connectionString:null==l?void 0:l.connectionString});if((0,ea.KO)(t)&&t.live_rows_estimate>K.Jv)return J.oR.error((0,a.jsx)("div",{className:"text-foreground prose text-sm",children:K.RH}),{id:e});let r=t&&(0,Y.rH)(t);if(!r)return J.oR.error("Failed to export table: ".concat(n.name),{id:e});let i=(await (0,en.HQ)({projectRef:s,connectionString:null==l?void 0:l.connectionString,table:r})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(i.length>0){let e=Q().unparse(i,{columns:r.columns.map(e=>e.name)}),t=new Blob([e],{type:"text/csv;charset=utf-8;"});D()(t,"".concat(n.name,"_rows.csv"))}J.oR.success("Successfully exported ".concat(n.name," as CSV"),{id:e})}catch(t){J.oR.error("Failed to export table: ".concat(t.message),{id:e})}},k=async()=>{if(d.pe&&!(null==l?void 0:l.connectionString))return console.error("Connection string is required");let e=J.oR.loading("Exporting ".concat(n.name," as SQL..."));try{let t=await (0,j.Ap)({id:n.id,projectRef:s,connectionString:null==l?void 0:l.connectionString});if((0,ea.KO)(t)&&t.live_rows_estimate>K.Jv)return J.oR.error((0,a.jsx)("div",{className:"text-foreground prose text-sm",children:K.RH}),{id:e});let r=t&&(0,Y.rH)(t);if(!r)return J.oR.error("Failed to export table: ".concat(n.name),{id:e});let i=(await (0,en.HQ)({projectRef:s,connectionString:null==l?void 0:l.connectionString,table:r})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(i.length>0){let e=(0,X.S)(r,i),t=new Blob([e],{type:"text/sql;charset=utf-8;"});D()(t,"".concat(n.name,"_rows.sql"))}J.oR.success("Successfully exported ".concat(n.name," as SQL"),{id:e})}catch(t){J.oR.error("Failed to export table: ".concat(t.message),{id:e})}};return(0,a.jsx)(es.tv,{title:n.name,id:String(n.id),href:"/project/".concat(s,"/editor/").concat(n.id,"?schema=").concat(n.schema),role:"button","aria-label":"View ".concat(n.name),className:(0,el.cn)((0,eo.u2)({isSelected:h&&!p,isOpened:x&&!p,isPreview:p}),"px-4"),onDoubleClick:e=>{e.preventDefault();let t=(0,ei.lW)(n.type,{id:n.id});m.makeTabPermanent(t)},"data-sentry-element":"EditorTablePageLink","data-sentry-component":"EntityListItem","data-sentry-source-file":"EntityListItem.tsx",children:(0,a.jsxs)(a.Fragment,{children:[h&&(0,a.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,a.jsxs)(ec.m_,{disableHoverableContent:!0,"data-sentry-element":"Tooltip","data-sentry-source-file":"EntityListItem.tsx",children:[(0,a.jsx)(ec.k$,{className:"min-w-4","data-sentry-element":"TooltipTrigger","data-sentry-source-file":"EntityListItem.tsx",children:(0,a.jsx)(Z.L,{type:n.type,isActive:h,"data-sentry-element":"EntityTypeIcon","data-sentry-source-file":"EntityListItem.tsx"})}),(0,a.jsx)(ec.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"EntityListItem.tsx",children:(e=>{var t,s,a,n;return null==(n=Object.entries(y.z).find(t=>{let[,s]=t;return s===e}))||null==(a=n[0])||null==(s=a.toLowerCase())||null==(t=s.split("_"))?void 0:t.join(" ")})(n.type)})]}),(0,a.jsxs)("div",{className:(0,el.cn)("truncate","overflow-hidden text-ellipsis whitespace-nowrap flex items-center gap-2 relative w-full",h&&"text-foreground"),children:[(0,a.jsx)("span",{className:(0,el.cn)(h?"text-foreground":"text-foreground-light group-hover:text-foreground","text-sm","transition","truncate"),children:n.name}),(0,a.jsx)(em,{entity:n,isActive:h,tableHasLints:b,viewHasLints:v,materializedViewHasLints:w,"data-sentry-element":"EntityTooltipTrigger","data-sentry-source-file":"EntityListItem.tsx"})]}),f&&(0,a.jsxs)(ed.rI,{children:[(0,a.jsx)(ed.ty,{className:"text-foreground-lighter transition-all text-transparent group-hover:text-foreground data-[state=open]:text-foreground",children:(0,a.jsx)(P.A,{size:14,strokeWidth:2})}),(0,a.jsxs)(ed.SQ,{side:"bottom",align:"start",className:"w-44",children:[(0,a.jsxs)(ed._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),(0,eu.l)(n.name)},children:[(0,a.jsx)(O.A,{size:12}),(0,a.jsx)("span",{children:"Copy name"})]},"copy-name"),function(e){return(null==e?void 0:e.type)===y.z.TABLE||(null==e?void 0:e.type)===y.z.PARTITIONED_TABLE}(n)&&(0,a.jsxs)(ed._2,{className:"space-x-2",onClick:async e=>{e.stopPropagation();let t=J.oR.loading("Getting table schema..."),s=await (0,ee.I)({id:n.id,projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString});if(!s)return J.oR.error("Failed to get table schema",{id:t});try{let e=(0,er.A)(s);await (0,eu.l)(e),J.oR.success("Table schema copied to clipboard",{id:t})}catch(e){J.oR.error("Failed to copy schema: "+(e.message||e),{id:t})}},children:[(0,a.jsx)(O.A,{size:12}),(0,a.jsx)("span",{children:"Copy table schema"})]},"copy-schema"),n.type===y.z.TABLE&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ed.mB,{}),(0,a.jsxs)(ed._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),o.onEditTable()},children:[(0,a.jsx)(W.A,{size:12}),(0,a.jsx)("span",{children:"Edit table"})]},"edit-table"),(0,a.jsxs)(ed._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),o.onDuplicateTable()},children:[(0,a.jsx)(q.A,{size:12}),(0,a.jsx)("span",{children:"Duplicate table"})]},"duplicate-table"),(0,a.jsx)(ed._2,{className:"space-x-2",asChild:!0,children:(0,a.jsxs)(U(),{href:"/project/".concat(s,"/auth/policies?schema=").concat(c,"&search=").concat(n.id),children:[(0,a.jsx)(H.A,{size:12}),(0,a.jsx)("span",{children:"View policies"})]},"view-policies")},"view-policies"),(0,a.jsxs)(ed.lv,{children:[(0,a.jsxs)(ed.nV,{className:"gap-x-2",children:[(0,a.jsx)(B.A,{size:12}),"Export data"]}),(0,a.jsxs)(ed.M5,{children:[(0,a.jsx)(ed._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),N()},children:(0,a.jsx)("span",{children:"Export table as CSV"})},"download-table-csv"),(0,a.jsx)(ed._2,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),k()},children:(0,a.jsx)("span",{children:"Export table as SQL"})},"download-table-sql")]})]}),(0,a.jsx)(ed.mB,{}),(0,a.jsxs)(ed._2,{className:"gap-x-2",onClick:e=>{e.stopPropagation(),o.onDeleteTable()},children:[(0,a.jsx)(F.A,{size:12}),(0,a.jsx)("span",{children:"Delete table"})]},"delete-table")]})]})]})]})})};var ex=s(71425);let eh=()=>(0,a.jsx)(L.Q5,{title:"No tables or views",description:"Any tables or views you create will be listed here.",className:"mx-4","data-sentry-element":"InnerSideBarEmptyPanel","data-sentry-component":"TableMenuEmptyState","data-sentry-source-file":"TableMenuEmptyState.tsx",children:(0,a.jsx)("div",{className:"top-0 left-6 flex flex-col opacity-50 cursor-not-allowed bg-dash-sidebar h-content -mb-7 pointer-events-none scale-75",children:(0,a.jsxs)("div",{className:"relative h-content",children:[(0,a.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-10",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-transparent from-80% to-100% to-background-surface-100 dark:to-background-surface-75"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent from-50% to-100% to-background-surface-100 dark:to-background-surface-75"})]}),(0,a.jsx)("div",{className:"absolute left-[150px] bottom-[21px] text-foreground-muted z-10 pointer-events-none",children:(0,a.jsx)(ex.A,{size:16,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"Pointer","data-sentry-source-file":"TableMenuEmptyState.tsx"})}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"border-l pointer-events-none",children:(0,a.jsxs)("div",{className:(0,el.cn)("group",(0,eo.u2)({isSelected:2===t,isOpened:2===t,isPreview:!1}),"px-4 min-w-40"),"aria-selected":2===t,children:[2===t&&(0,a.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),(0,a.jsx)(Z.L,{type:"r"}),"postgres_table_".concat(t)]})},"some-".concat(t)))]})})}),ef=()=>{var e,t,s;let{id:r}=(0,d.g)(),M=r?Number(r):void 0,D=(0,A.ap)(),{selectedSchema:P,setSelectedSchema:O}=(0,S.k)(),W=(0,u.d)(),[q,H]=(0,c.useState)(!1),[B,F]=(0,c.useState)(""),[V,$]=(0,c.useState)(Object.values(y.z)),[U,G]=(0,N.M)("table-editor-sort","alphabetical"),{project:Q}=(0,z.Om)(),{data:J,isLoading:K,isSuccess:Y,isError:X,error:Z,hasNextPage:ee,isFetchingNextPage:et,fetchNextPage:es}=(0,v.kD)({projectRef:null==Q?void 0:Q.ref,connectionString:null==Q?void 0:Q.connectionString,schemas:[P],search:B.trim()||void 0,sort:U,filterTypes:V},{keepPreviousData:!!B}),ea=(0,c.useMemo)(()=>null==J?void 0:J.pages.flatMap(e=>e.data.entities),[null==J?void 0:J.pages]),{data:en}=(0,b.w$)({projectRef:null==Q?void 0:Q.ref,connectionString:null==Q?void 0:Q.connectionString}),er=null==en?void 0:en.find(e=>e.name===P),ei=(0,w.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"tables"),[el]=i()((null!=en?en:[]).sort((e,t)=>e.name.localeCompare(t.name)),e=>{var t;return k.i.includes(null!=(t=null==e?void 0:e.name)?t:"")}),eo=el.some(e=>e.id===(null==er?void 0:er.id)),{data:ec}=(0,j.Pk)({projectRef:null==Q?void 0:Q.ref,connectionString:null==Q?void 0:Q.connectionString,id:M});(0,c.useEffect)(()=>{(null==ec?void 0:ec.schema)&&O(ec.schema)},[null==ec?void 0:ec.schema]);let ed=(0,I.B)();return(0,c.useEffect)(()=>{ea&&!B&&ed({schemas:[P],entities:ea})},[ea,B,P,ed]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col flex-grow gap-5 pt-5 h-full",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-1.5",children:[(0,a.jsx)(g.A,{className:"mx-4",selectedSchemaName:P,onSelectSchema:e=>{F(""),O(e)},onSelectCreateSchema:()=>D.onAddSchema(),"data-sentry-element":"SchemaSelector","data-sentry-source-file":"TableEditorMenu.tsx"}),(0,a.jsx)("div",{className:"grid gap-3 mx-4",children:eo?(0,a.jsxs)(R.Fc,{children:[(0,a.jsx)(R.XL,{className:"text-sm",children:"Viewing protected schema"}),(0,a.jsxs)(R.TN,{className:"text-xs",children:[(0,a.jsx)("p",{className:"mb-2",children:"This schema is managed by Supabase and is read-only through the table editor"}),(0,a.jsx)(E.$,{type:"default",size:"tiny",onClick:()=>H(!0),children:"Learn more"})]})]}):(0,a.jsx)(h.G,{block:!0,title:"Create a new table",name:"New table",disabled:!ei,size:"tiny",icon:(0,a.jsx)(l.A,{size:14,strokeWidth:1.5,className:"text-foreground-muted"}),type:"default",className:"justify-start",onClick:D.onAddTable,tooltip:{content:{side:"bottom",text:ei?void 0:"You need additional permissions to create tables"}},children:"New table"})})]}),(0,a.jsxs)("div",{className:"flex flex-auto flex-col gap-2 pb-4",children:[(0,a.jsxs)(L.a0,{className:"mx-2","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,a.jsx)(L.RK,{autoFocus:!W,name:"search-tables",value:B,placeholder:"Search tables...","aria-labelledby":"Search tables",onChange:e=>F(e.target.value),"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,a.jsxs)(L.i9,{value:U,onValueChange:e=>G(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,a.jsx)(L.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,a.jsx)(L.Pl,{value:"grouped-alphabetical","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"TableEditorMenu.tsx",children:"Entity Type"},"grouped-alphabetical")]})}),(0,a.jsxs)(T.AM,{"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:[(0,a.jsx)(T.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,a.jsx)(E.$,{type:5!==V.length?"default":"dashed",className:"h-[32px] md:h-[28px] px-1.5",icon:(0,a.jsx)(o.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"TableEditorMenu.tsx"})}),(0,a.jsx)(T.hl,{className:"p-0 w-56",side:"bottom",align:"center","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TableEditorMenu.tsx",children:(0,a.jsxs)("div",{className:"px-3 pt-3 pb-2 flex flex-col gap-y-2",children:[(0,a.jsx)("p",{className:"text-xs",children:"Show entity types"}),(0,a.jsx)("div",{className:"flex flex-col",children:Object.entries(y.z).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"group flex items-center justify-between py-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(_.S,{id:t,name:t,checked:V.includes(s),onCheckedChange:()=>{V.includes(s)?$(V.filter(e=>e!==s)):$(V.concat([s]))}}),(0,a.jsx)(C.J,{htmlFor:t,className:"capitalize text-xs",children:t.toLowerCase().replace("_"," ")})]}),(0,a.jsx)(E.$,{size:"tiny",type:"default",onClick:()=>$([s]),className:"transition opacity-0 group-hover:opacity-100 h-auto px-1 py-0.5",children:"Select only"})]},t)})})]})})]})]}),K&&(0,a.jsx)(p.A,{}),X&&(0,a.jsx)("div",{className:"mx-4",children:(0,a.jsx)(x.A,{error:null!=Z?Z:null,subject:"Failed to retrieve tables"})}),Y&&(0,a.jsxs)(a.Fragment,{children:[0===B.length&&(null!=(e=null==ea?void 0:ea.length)?e:0)<=0&&(0,a.jsx)(eh,{}),B.length>0&&(null!=(t=null==ea?void 0:ea.length)?t:0)<=0&&(0,a.jsx)(L.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(B,'" did not return any results')}),(null!=(s=null==ea?void 0:ea.length)?s:0)>0&&(0,a.jsx)("div",{className:"flex flex-1 flex-grow","data-testid":"tables-list",children:(0,a.jsx)(f.A,{items:ea,ItemComponent:ep,itemProps:{projectRef:null==Q?void 0:Q.ref,id:Number(M),isLocked:eo},getItemSize:()=>28,hasNextPage:ee,isLoadingNextPage:et,onLoadNextPage:()=>es()})})]})]})]}),(0,a.jsx)(m.b,{visible:q,onClose:()=>H(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"TableEditorMenu.tsx"})]})}},36500:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(80263),n=s(53239),r=s(35644);let i=(0,n.memo)(function(){return(0,a.jsx)("div",{className:"px-4 flex flex-col gap-0",children:[{width:"w-40",opacity:"opacity-100"},{width:"w-32",opacity:"opacity-100"},{width:"w-20",opacity:"opacity-75"},{width:"w-40",opacity:"opacity-50"},{width:"w-20",opacity:"opacity-25"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-row h-6 items-center gap-3 ".concat(e.opacity),children:[(0,a.jsx)(r.E,{className:"h-4 w-5"}),(0,a.jsx)(r.E,{className:"h-4 ".concat(e.width)})]},t))})})},37859:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]])},38494:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(80263),n=s(82457);let r=e=>{let{max:t=100,value:s=0,barClass:r="bg-foreground",bgClass:i="",type:l="vertical",borderClass:o="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:m=""}=e;if("horizontal"===l){let e=Number(s/t*100),l=c||u;return(0,a.jsxs)("div",{className:"flex flex-col w-full",children:[l&&(0,a.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,a.jsx)("p",{className:(0,n.cn)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,a.jsx)("p",{className:(0,n.cn)("text-foreground-light text-sm",m),children:u})]}),(0,a.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(i||"bg-surface-400"," ").concat(o||"border-none"),children:(0,a.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(r," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(s/t*35);return e<2&&(e=2),(0,a.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(i||"bg-gray-400"," ").concat(o||"border-none"),style:{height:35},children:(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(r),style:{height:e}})})}}},40140:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(56947),n=s(48678),r=s(27395);async function i(e,t){let{projectRef:s,connectionString:a}=e;if(!s)throw Error("projectRef is required");let r=new Headers;a&&r.set("x-connection-encrypted",a);let{data:i,error:l}=await (0,n.Jt)("/platform/pg-meta/{ref}/types",{params:{header:{"x-connection-encrypted":a},path:{ref:s}},headers:Object.fromEntries(r),signal:t});return l&&(0,n.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:s}=e,{enabled:n=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.K.list(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:s},a)},{enabled:n&&void 0!==t,...l})}},40882:(e,t,s)=>{"use strict";s.d(t,{A:()=>b});var a=s(80263),n=s(60045),r=s(45969),i=s(880),l=s(55060),o=s(53239),c=s(9895),d=s(89635),u=s(19070),m=s(37263),p=s(35644),x=s(96773),h=s(67928),f=s(85936),g=s(40691);let b=e=>{let{className:t,disabled:s=!1,size:b="tiny",showError:y=!0,selectedSchemaName:v,supportSelectAll:j=!1,excludedSchemas:w=[],onSelectSchema:N,onSelectCreateSchema:S,portal:k=!0}=e,[A,R]=(0,o.useState)(!1),E=(0,u.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:T}=(0,c.Om)(),{data:_,isLoading:C,isSuccess:L,isError:z,error:I,refetch:M}=(0,d.w$)({projectRef:null==T?void 0:T.ref,connectionString:null==T?void 0:T.connectionString}),D=(_||[]).filter(e=>!w.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,a.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[C&&(0,a.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:b,disabled:!0,children:(0,a.jsx)(p.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),y&&z&&(0,a.jsxs)(x.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(x.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(x.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,a.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>M(),children:"Reload schemas"})]}),L&&(0,a.jsxs)(h.AM,{open:A,onOpenChange:R,modal:!1,children:[(0,a.jsx)(h.Wv,{asChild:!0,children:(0,a.jsx)(m.$,{size:b,disabled:s,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema"})})})}),(0,a.jsx)(h.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:k,sameWidthAsTrigger:!0,children:(0,a.jsxs)(f.uB,{children:[(0,a.jsx)(f.G7,{placeholder:"Find schema..."}),(0,a.jsxs)(f.oI,{children:[(0,a.jsx)(f.xL,{children:"No schemas found"}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(g.FK,{className:(D||[]).length>7?"h-[210px]":"",children:[j&&(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N("*"),R(!1)},onClick:()=>{N("*"),R(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===v&&(0,a.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==D?void 0:D.map(e=>(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{N(e.name),R(!1)},onClick:()=>{N(e.name),R(!1)},children:[(0,a.jsx)("span",{children:e.name}),v===e.name&&(0,a.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.fx,{}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),R(!1)},onClick:()=>{S(),R(!1)},children:[(0,a.jsx)(l.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},46160:(e,t,s)=>{"use strict";s.d(t,{OJ:()=>v,Pl:()=>A,Pq:()=>b,Q5:()=>R,RK:()=>S,a0:()=>N,ag:()=>w,hm:()=>g,i9:()=>k,qP:()=>y,ue:()=>j});var a=s(80263),n=s(57728),r=s(58394),i=s(76584),l=s(37859),o=s(8758),c=s.n(o),d=s(53239),u=s(9079),m=s(82457),p=s(23601),x=s(93263),h=s(42206),f=s(85462);let g=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsx)(u.Nt,{ref:t,...s,className:(0,m.cn)("w-full px-2 group",s.className)})}),b=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsxs)(u.R6,{ref:t,...s,className:(0,m.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",s.className),children:[(0,a.jsx)(n.A,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,a.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:s.title})]})}),y=(0,d.forwardRef)((e,t)=>{let{...s}=e;return(0,a.jsx)(u.Ke,{ref:t,...s,className:(0,m.cn)("w-full flex flex-col gap-0",s.className)})}),v=(0,d.forwardRef)((e,t)=>(0,a.jsx)("div",{ref:t,...e,className:(0,m.cn)("h-px bg-border-muted",e.className)})),j=(0,d.forwardRef)((e,t)=>{let{className:s,isActive:n,forceHoverState:r,...i}=e;return(0,a.jsx)(c(),{ref:t,...i,"aria-current":n,className:(0,m.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",n?"bg-selection":"hover:bg-surface-200",r&&"bg-surface-200",n?"text-foreground":"text-foreground-light hover:text-foreground",s)})}),w=(0,d.forwardRef)((e,t)=>{let{isActive:s=!0,forceHoverState:n,isPreview:r,isOpened:i=!0,...l}=e;return(0,a.jsxs)(c(),{ref:t,...l,"aria-current":s,className:(0,m.cn)((0,p.u2)({isSelected:s&&!r,isOpened:i&&!r,isPreview:r}),"px-4",l.className),children:[!r&&s&&(0,a.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),l.children]})}),N=(0,d.forwardRef)((e,t)=>(0,a.jsx)("div",{ref:t,...e,className:(0,m.cn)("flex px-2 gap-2 items-center",e.className)})),S=(0,d.forwardRef)((e,t)=>{let{children:s,isLoading:n=!1,...l}=e;return(0,a.jsxs)("label",{htmlFor:l.name,className:"relative w-full",children:[(0,a.jsx)("span",{className:"sr-only",children:l["aria-labelledby"]}),(0,a.jsx)(x.p,{ref:t,type:"text",className:(0,m.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",l.className),...l}),s,n?(0,a.jsx)(r.A,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,a.jsx)(i.A,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),k=(0,d.forwardRef)((e,t)=>{let{value:s,onValueChange:n,contentClassName:r,triggerClassName:i,...o}=e;return(0,a.jsxs)(h.rI,{modal:!1,children:[(0,a.jsxs)(f.m_,{delayDuration:0,children:[(0,a.jsx)(h.ty,{asChild:!0,className:(0,m.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",i),children:(0,a.jsx)(f.k$,{children:(0,a.jsx)(l.A,{size:18,strokeWidth:1})})}),(0,a.jsx)(f.ZI,{side:"bottom",children:"Sort By"})]}),(0,a.jsx)(h.SQ,{side:"bottom",align:"end",className:(0,m.cn)("w-48",r),children:(0,a.jsx)(h.Hr,{value:s,onValueChange:n,children:o.children})})]})}),A=(0,d.forwardRef)((e,t)=>(0,a.jsx)(h.Ht,{ref:t,...e})),R=(0,d.forwardRef)((e,t)=>{let{illustration:s,title:n,description:r,actions:i,...l}=e;return(0,a.jsx)("div",{ref:t,...l,className:(0,m.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",l.className),children:(0,a.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[s,n&&(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:n}),r&&(0,a.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:r}),i&&(0,a.jsx)("div",{className:"mt-2",children:i}),l.children]})})})},49372:(e,t,s)=>{"use strict";s.d(t,{k:()=>l});var a=s(45982),n=s(53239),r=s(25481);let i=e=>(0,a.ZA)("schema",a.tU.withDefault(e)),l=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[s,a]=i((0,n.useMemo)(()=>t,[e]));return(0,n.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),s)},[s,e]),{selectedSchema:s,setSelectedSchema:a}}},53165:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>l});var a=s(80263),n=s(90709);s(53239);var r=s(5548);let i=e=>{let{open:t,children:s,className:r,...i}=e;return(0,a.jsx)(n.bL,{asChild:i.asChild,defaultOpen:i.defaultOpen,open:t,onOpenChange:i.onOpenChange,disabled:i.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:s})};i.Trigger=function(e){let{children:t,asChild:s}=e;return(0,a.jsx)(n.l9,{asChild:s,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},i.Content=function(e){let{asChild:t,children:s,className:i}=e,l=(0,r.A)("collapsible");return(0,a.jsx)(n.UC,{asChild:t,className:[l.content,i].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:s})};let l=i},56404:(e,t,s)=>{"use strict";s.d(t,{Mj:()=>m,d7:()=>r});var a=s(53239);function n(e,t){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:t}))}function r(e,t){let[s,n]=a.useState(e);return a.useEffect(()=>{let s=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(s)}},[e,t]),s}let i={past:[],present:null,future:[]},l=(e,t)=>{let s=JSON.stringify(t);window.localStorage.setItem(e,s),n(e,s)},o=e=>{window.localStorage.removeItem(e),n(e,null)},c=e=>window.localStorage.getItem(e),d=e=>(window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)),u=()=>{throw Error("useLocalStorage is a client-only hook")};function m(e,t){let s=a.useSyncExternalStore(d,()=>c(e),u),n=a.useCallback(t=>{try{let a="function"==typeof t?t(JSON.parse(s)):t;null==a?o(e):l(e,a)}catch(e){console.warn(e)}},[e,s]);return a.useEffect(()=>{null===c(e)&&void 0!==t&&l(e,t)},[e,t]),[s?JSON.parse(s):t,n]}let p=()=>navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection},57811:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},58396:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]])},58667:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},63740:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},65393:(e,t,s)=>{"use strict";s.d(t,{AL:()=>c,J5:()=>u,J_:()=>o,N1:()=>l,aw:()=>d,fX:()=>g,mL:()=>m,mN:()=>p,wB:()=>x,wy:()=>f,x0:()=>h});var a=s(86631),n=s.n(a),r=s(14506),i=s.n(r);let l=["int2","int4","int8","float4","float8","numeric","double precision"],o=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],p=n()(d,u,m),x=["uuid","bool","vector","bytea"],h=i()(n()(l,o,c,p,x)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},g=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},70883:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},71077:(e,t,s)=>{"use strict";s.d(t,{H:()=>d});var a=s(17331),n=s(32144),r=s(80251),i=s(73969),l=s(18232),o=s(29076);async function c(e){let{projectRef:t,connectionString:s,id:n,tables:r,publish_insert:i,publish_update:o,publish_delete:c,publish_truncate:d}=e,{sql:u}=a.A.publications.update(n,{tables:r,publish_insert:i,publish_update:o,publish_delete:c,publish_truncate:d}),{result:m}=await (0,l.E)({projectRef:t,connectionString:s,sql:u,queryKey:["publication","update",n]});return m}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,n.jE)();return(0,r.n)(e=>c(e),{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(o.b.list(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?i.oR.error("Failed to update database publication: ".concat(e.message)):t(e,s,a)},...s})}},71425:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("Pointer",[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]])},73451:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},84130:(e,t,s)=>{"use strict";s.d(t,{j:()=>c});var a=s(56947),n=s(48678),r=s(97008),i=s(32211),l=s(34971);async function o(e,t,s){let{projectRef:a,connectionString:r,schema:i}=e;if(!a)throw Error("projectRef is required");let l=new Headers(s);r&&l.set("x-connection-encrypted",r);let{data:o,error:c}=await (0,n.Jt)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":r},path:{ref:a},query:{included_schemas:i||"",excluded_schemas:""}},headers:l,signal:t});return c&&(0,n.H4)(c),o}let c=function(e){let{projectRef:t,connectionString:s,schema:n}=e,{enabled:c=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=(0,r.KT)(),m=(null==u?void 0:u.status)===i.BU.ACTIVE_HEALTHY;return(0,a.I)(l.S.list(t,n),e=>{let{signal:a}=e;return o({projectRef:t,connectionString:s,schema:n},a)},{enabled:c&&void 0!==t&&m,...d})}},88757:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(84497).A)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]])},92456:(e,t,s)=>{"use strict";s.d(t,{K:()=>f,T:()=>y});var a=s(80263),n=s(53239),r=s(37356),i=s(82457),l=s(85462),o=s(53434),c=s.n(o),d=s(27344),u=s.n(d),m=s(37361),p=s.n(m);c().extend(u()),c().extend(p());let x=e=>c().unix(Number(e)/1e3/1e3).toISOString(),h=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},f=e=>{let{utcTimestamp:t,format:s}=e,a=h(t)?x(t):t;return c().utc(a).local().format(s)},g=e=>{let{utcTimestamp:t,format:s}=e,a=h(t)?x(t):t;return c().utc(a).format(s)},b=e=>{let{utcTimestamp:t}=e,s=h(t)?x(t):t;return c().utc(s).fromNow()},y=e=>{let{utcTimestamp:t,className:s,displayAs:o="local",format:c="DD MMM  HH:mm:ss",labelFormat:d="DD MMM HH:mm:ss"}=e,u=f({utcTimestamp:t,format:c}),m=g({utcTimestamp:t,format:c}),p=b({utcTimestamp:t}),[x,h]=(0,n.useState)("start"),y=(0,n.useRef)(null),v=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,n.useEffect)(()=>{let e=()=>{if(y.current){let e=y.current.getBoundingClientRect(),t=window.innerHeight;h(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let j=e=>{let{label:t,value:s}=e,[l,o]=(0,n.useState)(!1);return(0,a.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,r.l)(s,()=>{o(!0),setTimeout(()=>{o(!1)},1e3)})},className:(0,i.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":l}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,a.jsx)("p",{children:t}),(0,a.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,a.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,a.jsx)("div",{className:"border-t w-full border-dashed z-10"}),l&&(0,a.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,a.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:s})]})]})};return(0,a.jsxs)(l.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(l.k$,{asChild:!0,ref:y,className:"text-xs ".concat(s," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("span",{children:"local"===o?f({utcTimestamp:t,format:d}):g({utcTimestamp:t,format:d})})}),(0,a.jsxs)(l.ZI,{align:x,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(j,{label:"UTC",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(j,{label:v,value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(j,{label:"Relative",value:p,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(j,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},93949:(e,t,s)=>{"use strict";s.d(t,{$:()=>c,I:()=>o});var a=s(56947),n=s(18232),r=s(37773),i=s(67394);let l=e=>{let{id:t}=e;return"\n    ".concat(r.n,"\n\n    with table_info as (\n      select \n        n.nspname::text as schema,\n        c.relname::text as name\n      from pg_class c\n      join pg_namespace n on n.oid = c.relnamespace\n      where c.oid = ").concat(t,"\n    )\n    select pg_temp.pg_get_tabledef (\n      t.schema,\n      t.name,\n      false,\n      'FKEYS_INTERNAL',\n      'INCLUDE_TRIGGERS'\n    ) as definition\n    from table_info t;\n  ").trim()};async function o(e,t){let{projectRef:s,connectionString:a,id:r}=e;if(!r)throw Error("id is required");let i=l({id:r}),{result:o}=await (0,n.E)({projectRef:s,connectionString:a,sql:i,queryKey:["table-definition",r]},t);return o[0].definition.trim()}let c=function(e){let{projectRef:t,connectionString:s,id:n}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(i.c.tableDefinition(t,n),e=>{let{signal:a}=e;return o({projectRef:t,connectionString:s,id:n},a)},{enabled:r&&void 0!==t&&void 0!==n&&!isNaN(n),...l})}},95137:function(e,t,s){var a,n;void 0===(n="function"==typeof(a=function(){"use strict";function t(e,t,s){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){l(a.response,t,s)},a.onerror=function(){console.error("could not download file")},a.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s.g&&s.g.global===s.g?s.g:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,s,i){var l=r.URL||r.webkitURL,o=document.createElement("a");o.download=s=s||e.name||"download",o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?n(o):a(o.href)?t(e,s,i):n(o,o.target="_blank")):(o.href=l.createObjectURL(e),setTimeout(function(){l.revokeObjectURL(o.href)},4e4),setTimeout(function(){n(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,s,r){if(s=s||e.name||"download","string"!=typeof e){var i;navigator.msSaveOrOpenBlob((void 0===(i=r)?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),s)}else if(a(e))t(e,s,r);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout(function(){n(l)})}}:function(e,s,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,s,a);var l="application/octet-stream"===e.type,o=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||l&&o||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,m=u.createObjectURL(e);n?n.location=m:location.href=m,n=null,setTimeout(function(){u.revokeObjectURL(m)},4e4)}});r.saveAs=l.saveAs=l,e.exports=l})?a.apply(t,[]):a)||(e.exports=n)},98111:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(80263),n=s(53239),r=s(94277),i=s(12523),l=s(37263);let o=e=>{let{visible:t=!1,danger:s=!1,title:o="",description:c="",size:d="small",buttonLabel:u="",buttonLoadingLabel:m="",onSelectCancel:p=()=>{},onSelectConfirm:x=()=>{}}=e;(0,n.useEffect)(()=>{t&&f(!1)},[t]);let[h,f]=(0,n.useState)(!1),g=()=>{f(!0),x()};return(0,a.jsx)(r.A,{header:o,visible:t,title:o,description:c,size:d,hideFooter:!0,onCancel:p,"data-sentry-element":"Modal","data-sentry-component":"ConfirmModal","data-sentry-source-file":"ConfirmDialog.tsx",children:(0,a.jsx)(i.A,{initialValues:{},validateOnBlur:!0,onSubmit:()=>g(),validate:()=>[],"data-sentry-element":"Form","data-sentry-source-file":"ConfirmDialog.tsx",children:()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(r.A.Content,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.$,{block:!0,htmlType:"button",type:"default",onClick:p,disabled:h,children:"Cancel"}),(0,a.jsx)(l.$,{htmlType:"submit",block:!0,type:s?"danger":"primary",disabled:h,loading:h,children:m&&h?m:u||"Confirm"})]})})})})})}},98180:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(80263),n=s(60045),r=s(98300),i=s(19070),l=s(72865);let o=e=>{let{children:t}=e,s=(0,i.Lh)(),o=(0,i.SE)(n.aG.TENANT_SQL_ADMIN_READ,"tables");return s&&!o?(0,a.jsx)(l.S,{isBlocking:!1,children:(0,a.jsx)(r.A,{isFullPage:!0,resourceText:"view tables from this project"})}):(0,a.jsx)(a.Fragment,{children:t})}},98300:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(80263),n=s(263);let r=e=>{let{resourceText:t,isFullPage:s=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}},99130:(e,t,s)=>{"use strict";s.d(t,{B:()=>i,x:()=>l});var a=s(26413),n=s(53239),r=s(53674);function i(){let e=(0,r.zv)(),t=(0,a.A)(e.tabsMap),s=(0,a.A)(e.recentItems),i=(0,a.A)(e.openTabs);return(0,n.useCallback)(a=>{let{schemas:n,entities:l}=a,o=l.map(e=>(0,r.lW)(e.type,{id:e.id})),c=[];for(let e of n)c.push(...s.current.filter(t=>{var s;return(null==(s=t.metadata)?void 0:s.schema)===e}).map(e=>e.id));let d=[...c.filter(e=>!o.includes(e))];e.removeRecentItems(d);let u=[];for(let e of n)u.push(...i.current.filter(s=>{var a;return(null==(a=t.current[s].metadata)?void 0:a.schema)===e}));let m=[...u.filter(e=>!e.startsWith("sql")&&!e.startsWith("schema")&&!o.includes(e))];e.removeTabs(m),i.current.map(e=>t.current[e]).filter(e=>{var t;return null==(t=r.qm.table)?void 0:t.includes(e.type)}).forEach(t=>{let s=null==l?void 0:l.find(e=>{var s;return(null==(s=t.metadata)?void 0:s.tableId)===e.id});s&&s.name!==t.label&&e.updateTab(t.id,{label:s.name})})},[])}function l(){let e=(0,r.zv)(),t=(0,a.A)(e.tabsMap),s=(0,a.A)(e.openTabs);return(0,n.useCallback)(a=>{let{snippets:n}=a,i=[...n.filter(e=>"sql"===e.type).map(e=>(0,r.lW)("sql",{id:e.id})),"sql-templates","sql-quickstarts"],l=s.current.filter(e=>e.startsWith("sql")&&!i.includes(e));e.removeTabs(l);let o=e.getRecentItemsByType("sql");e.removeRecentItems(o?o.filter(e=>!i.includes(e.id)).map(e=>e.id):[]),s.current.map(e=>t.current[e]).filter(e=>{var t;return null==(t=r.qm.sql)?void 0:t.includes(e.type)}).forEach(t=>{let s=null==n?void 0:n.find(e=>{var s;return(null==(s=t.metadata)?void 0:s.sqlId)===e.id});s&&s.name!==t.label&&e.updateTab(t.id,{label:s.name})})},[])}}}]);