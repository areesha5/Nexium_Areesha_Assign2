!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ef89f9fc-b849-48c6-9e54-c7ccb68acc48",e._sentryDebugIdIdentifier="sentry-dbid-ef89f9fc-b849-48c6-9e54-c7ccb68acc48")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3024,4598,6841],{73794:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(80263),r=s(34565),n=s(24717),l=s(25481);let i=e=>{let{children:t}=e,{ref:s}=(0,l.g)();return(0,a.jsx)(r.M,{title:"API Keys",subtitle:"Configure API keys to securely control access to your project",navigationItems:[{label:"Legacy API Keys",href:"/project/".concat(s,"/settings/api-keys"),id:"legacy-keys"},{label:"API Keys",href:"/project/".concat(s,"/settings/api-keys/new"),id:"new-keys"}],"data-sentry-element":"PageLayout","data-sentry-component":"ApiKeysLayout","data-sentry-source-file":"APIKeysLayout.tsx",children:(0,a.jsx)(n.eh,{className:"flex flex-col py-8 gap-8",bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"APIKeysLayout.tsx",children:t})})}},92633:(e,t,s)=>{"use strict";s.d(t,{M:()=>l});var a=s(80263),r=s(82457),n=s(86165);let l=e=>{let{title:t,description:s,docsUrl:l,actions:i,className:o}=e;return(0,a.jsxs)("div",{className:(0,r.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),s&&(0,a.jsx)("div",{className:"prose text-sm max-w-2xl",children:s})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==l&&(0,a.jsx)(n.A,{href:l}),i]})]})}},92765:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eC});var a=s(80263),r=s(18567),n=s(90354),l=s(25481),i=s(75592),o=s(35443),d=s(78131),c=s(37263),y=s(17082),u=s(60045),x=s(32144),m=s(88712),p=s(37055),f=s(15777),h=s(53239),g=s(73969),j=s(93263),A=s(83907),b=s(56947),I=s(48678),w=s(66768);async function v(e,t){let{projectRef:s,id:a,reveal:r}=e;if(void 0===s)throw Error("projectRef is required");if(void 0===a)throw Error("Content ID is required");let{data:n,error:l}=await (0,I.Jt)("/v1/projects/{ref}/api-keys/{id}",{params:{path:{ref:s,id:a},query:{reveal:r}},signal:t});return l&&(0,I.H4)(l),n}let P=function(e){let{projectRef:t,id:s,reveal:a}=e,{enabled:r=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,b.I)(w.f.single(t,s),e=>{let{signal:r}=e;return v({projectRef:t,id:s,reveal:a},r)},{enabled:r&&void 0!==t&&void 0!==s,...n})};var N=s(19070),k=s(82457),K=s(85462);function S(e){let{apiKey:t}=e,s=(0,x.jE)(),{ref:r}=(0,l.g)(),[n,i]=(0,h.useState)(!1),o="secret"===t.type,{can:d,isLoading:y}=(0,N.hl)(u.aG.READ,"service_api_keys"),{data:b,error:I,refetch:v}=P({projectRef:r,id:t.id,reveal:!0},{enabled:n,staleTime:0,cacheTime:0});async function S(){(!o||d)&&(y||i(!0))}async function C(){var e,a;if(null==b?void 0:b.api_key)return null!=(e=null==b?void 0:b.api_key)?e:"";try{let e=await v();if(s.removeQueries({queryKey:w.f.single(r,t.id),exact:!0}),e.isSuccess)return null!=(a=e.data.api_key)?a:"";if(I)return g.oR.error("Failed to copy secret API key"),""}catch(e){return console.error("Failed to fetch API key:",e),""}return t.api_key}(0,h.useEffect)(()=>{if(n&&(null==b?void 0:b.api_key)){let e=setTimeout(()=>{i(!1),s.removeQueries({queryKey:w.f.single(r,t.id),exact:!0})},1e4);return()=>clearTimeout(e)}},[n,null==b?void 0:b.api_key,r,s,t.id]);let _=o&&!d;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.N,{mode:"wait",initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"ApiKeyPill.tsx",children:(0,a.jsx)("div",{className:(0,k.cn)((0,j.L)({size:"tiny"}),"flex-1 grow gap-0 font-mono rounded-full",o?"overflow-hidden":"",n?"ring-1 ring-foreground-lighter ring-opacity-50":"ring-0 ring-opacity-0","transition-all","max-w-[100px] sm:max-w-[140px] md:max-w-[180px] lg:max-w-[340px]","cursor-text","relative"),style:{userSelect:"all"},children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:null==t?void 0:t.api_key.slice(0,15)}),(0,a.jsx)(p.P.span,{initial:{opacity:0,y:n?16:-16},animate:{opacity:1,y:0},exit:{opacity:0,y:n?16:-16},transition:{duration:.1,y:{type:"spring",stiffness:1e3,damping:55}},children:n&&(null==b?void 0:b.api_key)?null==b?void 0:b.api_key.slice(15):"••••••••••••••••"},n?"shown":"hidden")]}):(0,a.jsx)("span",{children:null==t?void 0:t.api_key})})}),o&&(0,a.jsx)(m.N,{initial:!1,children:!n&&(0,a.jsx)(p.P.div,{initial:{opacity:0,scale:1,width:0},animate:{opacity:1,scale:1,width:"auto"},exit:{opacity:0,scale:1,width:0},transition:{duration:.12},style:{overflow:"hidden"},children:(0,a.jsxs)(K.m_,{children:[(0,a.jsx)(K.k$,{asChild:!0,children:(0,a.jsx)(c.$,{type:"outline",className:"rounded-full px-2 pointer-events-auto cursor-default",icon:(0,a.jsx)(f.A,{strokeWidth:2}),onClick:S,disabled:_})}),(0,a.jsx)(K.ZI,{side:"bottom",children:_?"You need additional permissions to reveal secret API keys":y?"Loading permissions...":"Reveal API key"})]})})}),(0,a.jsxs)(K.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"ApiKeyPill.tsx",children:[(0,a.jsx)(K.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"ApiKeyPill.tsx",children:(0,a.jsx)(A.A,{type:"default",asyncText:C,iconOnly:!0,className:"rounded-full px-2 pointer-events-auto cursor-default",disabled:_||y,"data-sentry-element":"CopyButton","data-sentry-source-file":"ApiKeyPill.tsx"})}),(0,a.jsx)(K.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"ApiKeyPill.tsx",children:_?"You need additional permissions to copy secret API keys":y?"Loading permissions...":"Copy API key"})]})]})}var C=s(80251);async function _(e){if(!e.projectRef)throw Error("projectRef is required");let{data:t,error:s}=await (0,I.bE)("/v1/projects/{ref}/api-keys",{params:{path:{ref:e.projectRef},query:{reveal:!1}},body:{..."secret"===e.type?{secret_jwt_template:{role:"service_role"}}:name,type:e.type,name:e.name,description:e.description||null}});return s&&(0,I.H4)(s),t}let D=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,x.jE)();return(0,C.n)(e=>_(e),{async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries(w.f.list(n)),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?g.oR.error("Failed to create API key: ".concat(e.message)):t(e,s,a)},...s})};var T=s(8538);let E=()=>{let{ref:e}=(0,l.g)(),[t,s]=(0,h.useState)(!1),[r,n]=(0,h.useState)(!1),{mutate:i}=D(),o=async()=>{if(e){n(!0);try{await i({projectRef:e,type:"publishable",name:"default"}),await i({projectRef:e,type:"secret",name:"default"}),s(!1)}catch(e){console.error("Failed to create API keys:",e)}finally{n(!1)}}};return(0,a.jsxs)(T.Lt,{open:t,onOpenChange:s,"data-sentry-element":"AlertDialog","data-sentry-component":"CreateNewAPIKeysButton","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(c.$,{onClick:()=>s(!0),"data-sentry-element":"Button","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Create new API keys"}),(0,a.jsxs)(T.EO,{"data-sentry-element":"AlertDialogContent","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsxs)(T.wd,{"data-sentry-element":"AlertDialogHeader","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(T.r7,{"data-sentry-element":"AlertDialogTitle","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Create new API keys"}),(0,a.jsxs)(T.$v,{"data-sentry-element":"AlertDialogDescription","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:["This will create a default publishable key and a default secret key named"," ",(0,a.jsx)("code",{children:"default"}),". These keys are required to connect your application to your Supabase project."]})]}),(0,a.jsxs)(T.ck,{"data-sentry-element":"AlertDialogFooter","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(T.Zr,{"data-sentry-element":"AlertDialogCancel","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Cancel"}),(0,a.jsx)(T.Rx,{onClick:o,disabled:r,"data-sentry-element":"AlertDialogAction","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:r?"Creating...":"Create keys"})]})]})]})};var R=s(32794),L=s(65475);function F(){let{ref:e}=(0,l.g)(),t=(0,N.SE)(u.aG.READ,"api_keys"),s=(0,L._P)("basicApiKeys"),{data:a,isLoading:r}=(0,R.I)({projectRef:e,reveal:!1}),n=(0,h.useMemo)(()=>{var e;return null!=(e=null==a?void 0:a.filter(e=>{let{type:t}=e;return"publishable"===t}))?e:[]},[a]).length>0;return{isInRollout:s,hasApiKeys:n,isLoading:r,canReadAPIKeys:t,canInitApiKeys:s&&t&&!r&&!n,shouldDisableUI:!s||!n}}let B=[{id:"mock-id-2",type:"publishable",api_key:"sb_publishable_ltaNA7nnVozoSCOcZIjg",name:"web"},{id:"mock-id-3",type:"publishable",api_key:"sb_publishable_YpotEpinEWsC2dI7FIKI",name:"mobile"},{id:"mock-id-1",type:"secret",api_key:"sb_secret_8I4Se•••••••••••••",name:"backend_api"}],H=()=>(0,a.jsx)(o.Zp,{className:"w-full overflow-hidden opacity-60 pointer-events-none bg-surface-100","data-sentry-element":"Card","data-sentry-component":"ApiKeysTableIllustration","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsx)(o.Wu,{className:"p-0","data-sentry-element":"CardContent","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)(d.XI,{className:"p-5","data-sentry-element":"Table","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsx)(d.A0,{"data-sentry-element":"TableHeader","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)(d.Hj,{className:"bg-200","data-sentry-element":"TableRow","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 overflow-hidden w-[180px]","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:"Name"},""),(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 pr-0","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:"API Key"}),(0,a.jsx)(d.nd,{className:"text-right font-mono uppercase text-xs text-foreground-lighter h-auto py-2","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx"},"actions")]})}),(0,a.jsx)(d.BF,{"data-sentry-element":"TableBody","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:B.map(e=>(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nA,{className:"py-2 w-[180px]",children:e.name}),(0,a.jsx)(d.nA,{className:"py-2",children:(0,a.jsx)("div",{className:"flex flex-row gap-2",children:(0,a.jsx)(S,{apiKey:e})})}),(0,a.jsx)(d.nA,{})]},e.id))})]})})}),M=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-1/2 xl:h-full xl:inset-x-auto xl:-right-16 xl:top-3 w-full xl:w-2/3 bg-gradient-to-t xl:bg-gradient-to-l from-background-alternative via-background-alternative/90 via-[5%] to-transparent z-[3] pointer-events-none xl:max-w-[500px]"}),(0,a.jsx)("div",{className:"absolute scale-100 left-10 -bottom-14 w-[720px] xl:w-[500px] xl:left-auto xl:-right-[200px] 2xl:-right-16 xl:top-[21px] xl:scale-75",children:(0,a.jsx)(H,{"data-sentry-element":"ApiKeysTableIllustration","data-sentry-source-file":"ApiKeysIllustrations.tsx"})})]}),z=()=>(0,a.jsx)(i.T,{illustration:(0,a.jsx)(M,{}),bgAlt:!0,"data-sentry-element":"FeatureBanner","data-sentry-component":"ApiKeysComingSoonBanner","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col gap-0 z-[2]",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"New API keys are coming soon"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter lg:max-w-sm 2xl:max-w-none",children:"We're rolling out new API keys to better support your application needs."}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(c.$,{type:"default",icon:(0,a.jsx)(r.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsx)("a",{href:"https://github.com/orgs/supabase/discussions/29260",target:"_blank",rel:"noreferrer",children:"Learn more"})})})]})}),q=()=>{let{canInitApiKeys:e}=F();return e?(0,a.jsx)(i.T,{illustration:(0,a.jsx)(M,{}),bgAlt:!0,"data-sentry-element":"FeatureBanner","data-sentry-component":"ApiKeysCreateCallout","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col gap-0 z-[2]",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"Create API keys"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter lg:max-w-sm 2xl:max-w-none",children:"Use keys to authenticate requests to your app"}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(E,{"data-sentry-element":"CreateNewAPIKeysButton","data-sentry-source-file":"ApiKeysIllustrations.tsx"})})]})}):null},O=()=>{let{hasApiKeys:e,isInRollout:t}=F();return t&&e?(0,a.jsxs)(i.T,{storageKey:l.rS.API_KEYS_FEEDBACK_DISMISSED,className:"!p-0 flex flex-col gap-0",dismissable:!0,"data-sentry-element":"FeatureBanner","data-sentry-component":"ApiKeysFeedbackBanner","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"Your new API keys are here"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["We've updated our API keys to better support your application needs."," ",(0,a.jsxs)("a",{href:"https://github.com/orgs/supabase/discussions/29260",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-foreground",children:["Join the discussion on GitHub ",(0,a.jsx)(n.A,{size:14,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"ApiKeysIllustrations.tsx"})]})]})]}),(0,a.jsx)(y.w,{className:"w-full","data-sentry-element":"Separator","data-sentry-source-file":"ApiKeysIllustrations.tsx"}),(0,a.jsx)("div",{className:"px-5 py-2 bg-surface-200/30",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Having trouble with the new API keys?"," ",(0,a.jsx)("a",{href:"/dashboard/support/new?category=Problem&subject=Help%20with%20API%20keys&message=I'm%20experiencing%20problems%20with%20the%20new%20API%20keys%20feature.%20Please%20describe%20your%20specific%20issue%20here.",className:"inline-flex items-center gap-1 text-foreground",children:"Contact support"})]})})]}):null};var W=s(92633),Y=s(35644),$=s(58173);let U=()=>{let{ref:e}=(0,l.g)(),{data:t,isLoading:s,error:r}=(0,R.I)({projectRef:e,reveal:!1}),n=(0,h.useMemo)(()=>{var e;return null!=(e=null==t?void 0:t.filter(e=>{let{type:t}=e;return"publishable"===t}))?e:[]},[t]),i=!(0,N.Lh)(),o=(0,N.SE)(u.aG.TENANT_SQL_ADMIN_WRITE,"*"),d=n[0];return(0,a.jsxs)("div",{"data-sentry-component":"PublishableAPIKeys","data-sentry-source-file":"PublishableAPIKeys.tsx",children:[(0,a.jsx)(W.M,{title:"Publishable key",description:"This key is safe to use in a browser if you have enabled Row Level Security (RLS) for your tables and configured policies.","data-sentry-element":"FormHeader","data-sentry-source-file":"PublishableAPIKeys.tsx"}),(0,a.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,a.jsxs)("div",{className:"-space-y-px w-full lg:w-content lg:w-fit",children:[(0,a.jsxs)("div",{className:"bg-surface-100 px-5 py-2 flex items-center gap-5 first:rounded-t-md border",children:[(0,a.jsx)("span",{className:"text-sm",children:"Publishable key"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G,{"data-sentry-element":"ApiKeyInput","data-sentry-source-file":"PublishableAPIKeys.tsx"}),(0,a.jsx)(A.A,{disabled:i||s||!o,type:"default",text:null==d?void 0:d.api_key,iconOnly:!0,size:"tiny",className:"px-2 rounded-full","data-sentry-element":"CopyButton","data-sentry-source-file":"PublishableAPIKeys.tsx"})]})]}),r&&o?(0,a.jsx)("div",{className:"text-xs bg-warning-200 last:rounded-b-md border border-warning-400 px-5 text-foreground-lighter py-1",children:(0,a.jsxs)("div",{className:"text-warning",children:["Failed to load publishable key: ",null==r?void 0:r.message]})}):(0,a.jsx)("div",{className:"text-xs bg-200 last:rounded-b-md border px-5 text-foreground-lighter py-1",children:"The publishable key can be safely shared publicly"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-2 max-w-64"})]})]})};function G(){let{ref:e}=(0,l.g)(),{data:t,isLoading:s,error:r}=(0,R.I)({projectRef:e,reveal:!1}),n=(0,h.useMemo)(()=>{var e;return null!=(e=null==t?void 0:t.filter(e=>{let{type:t}=e;return"publishable"===t}))?e:[]},[t]),i=!(0,N.Lh)(),o=(0,N.SE)(u.aG.TENANT_SQL_ADMIN_WRITE,"*"),d=n[0],c="flex-1 grow gap-1 rounded-full min-w-0 max-w-[200px] sm:max-w-[300px] md:max-w-[400px] lg:min-w-[24rem]",y="tiny";return s||i?(0,a.jsx)("div",{className:(0,k.cn)((0,j.L)({size:y}),c,"items-center"),children:(0,a.jsx)(Y.E,{className:"h-2 w-48 rounded-full bg-foreground-muted"})}):o?r?(0,a.jsxs)("div",{className:(0,k.cn)((0,j.L)({size:y}),c,"items-center gap-2 font-normal"),children:[(0,a.jsx)($.id,{}),"Failed to load publishable key"]}):(0,a.jsx)(j.p,{size:y,className:(0,k.cn)(c,"font-mono"),value:null==d?void 0:d.api_key,"data-sentry-element":"Input_Shadcn_","data-sentry-component":"ApiKeyInput","data-sentry-source-file":"PublishableAPIKeys.tsx"},null==d?void 0:d.id):(0,a.jsxs)("div",{className:(0,k.cn)((0,j.L)({size:y}),c,"items-center gap-2 font-normal"),children:[(0,a.jsx)($.aR,{}),"You do not have permission to read API Key"]})}var Q=s(53434),Z=s.n(Q),X=s(64741),J=s.n(X),V=s(27344),ee=s.n(V),et=s(7188),es=s(69416),ea=s(42206),er=s(15893),en=s(83543);async function el(e){if(!e.projectRef)throw Error("projectRef is required");let{data:t,error:s}=await (0,I.yH)("/v1/projects/{ref}/api-keys/{id}",{params:{path:{ref:e.projectRef,id:e.id},query:{reveal:!1}}});return s&&(0,I.H4)(s),t}let ei=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,x.jE)();return(0,C.n)(e=>el(e),{async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries(w.f.list(n)),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?g.oR.error("Failed to delete API key: ".concat(e.message)):t(e,s,a)},...s})};var eo=s(20227);let ed=e=>{let{apiKey:t,lastSeen:s}=e,{ref:r}=(0,en.g)(),[n,l]=(0,h.useState)(!1),i=(0,N.SE)(u.aG.TENANT_SQL_ADMIN_WRITE,"*"),{mutate:o,isLoading:d}=ei({onSuccess:()=>{g.oR.success("Successfully deleted API key"),l(!1)}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ea._2,{className:"flex gap-2 !pointer-events-auto",onClick:async e=>{i&&(e.preventDefault(),l(!0))},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"APIKeyDeleteDialog.tsx",children:[(0,a.jsx)(er.A,{className:"size-4 text-destructive",strokeWidth:1.5,"data-sentry-element":"Trash2","data-sentry-source-file":"APIKeyDeleteDialog.tsx"})," Delete API key"]}),(0,a.jsx)(eo.A,{visible:n,onCancel:()=>l(!1),onConfirm:()=>{if(!r)return console.error("Project ref is required");o({projectRef:r,id:t.id})},title:"Delete ".concat(t.type," API key: ").concat(t.name),confirmString:t.name,confirmLabel:"Yes, irreversibly delete this API key",confirmPlaceholder:"Type the name of the API key to confirm",loading:d,variant:"destructive",alert:{title:"This cannot be undone",description:s?"This API key was used ".concat(s.timestamp,". Make sure all backend components using it have been updated. Deletion will cause them to receive HTTP 401 Unauthorized status codes on all Supabase APIs."):"This API key has not been used in the past 24 hours. Make sure you've updated all backend components using it before deletion."},"data-sentry-element":"TextConfirmModal","data-sentry-source-file":"APIKeyDeleteDialog.tsx"})]})},ec=e=>{var t;let{apiKey:s,lastSeen:r}=e,n=(0,p.P)(d.Hj);return(0,a.jsxs)(n,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"spring",stiffness:500,damping:50,mass:1},"data-sentry-element":"MotionTableRow","data-sentry-component":"APIKeyRow","data-sentry-source-file":"APIKeyRow.tsx",children:[(0,a.jsx)(d.nA,{className:"py-2","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium",children:s.name}),(0,a.jsx)("div",{className:"text-sm text-foreground-lighter",children:s.description||(0,a.jsx)("span",{className:"text-foreground-muted",children:"No description"})})]})}),(0,a.jsx)(d.nA,{className:"py-2","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)("div",{className:"flex flex-row gap-2",children:(0,a.jsx)(S,{apiKey:s,"data-sentry-element":"ApiKeyPill","data-sentry-source-file":"APIKeyRow.tsx"})})}),(0,a.jsx)(d.nA,{className:"py-2 min-w-0 whitespace-nowrap hidden lg:table-cell","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)("div",{className:"truncate",title:(null==r?void 0:r.timestamp)||"Never used",children:null!=(t=null==r?void 0:r.timestamp)?t:(0,a.jsx)("span",{className:"text-foreground-lighter",children:"Never used"})})}),(0,a.jsx)(d.nA,{className:"flex justify-end","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsxs)(ea.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"APIKeyRow.tsx",children:[(0,a.jsx)(ea.ty,{className:"px-1 focus-visible:outline-none",asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)(c.$,{type:"text",size:"tiny",icon:(0,a.jsx)(es.A,{size:"14",className:"text-foreground-light hover:text-foreground"}),"data-sentry-element":"Button","data-sentry-source-file":"APIKeyRow.tsx"})}),(0,a.jsx)(ea.SQ,{className:"max-w-40",align:"end","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)(ed,{apiKey:s,lastSeen:r,"data-sentry-element":"APIKeyDeleteDialog","data-sentry-source-file":"APIKeyRow.tsx"})})]})})]})};var ey=s(32981),eu=s(87494),ex=s(73957),em=s(67963),ep=s(96773),ef=s(87916),eh=s(39353),eg=s(55060);let ej=(0,s(84497).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),eA=eh.Yj().min(4,"Name must be at least 4 characters").max(64,"Name can't be more than 64 characters long").regex(/^[a-z0-9_]+$/,"Name can only contain lowercased letters, digits and underscore").refine(e=>!e.match(/^[0-9].+$/),"Name must not start with a digit").refine(e=>"anon"!==e&&"service_role"!==e,'Using "anon" or "service_role" for API key name is not possible'),eb="create-secret-api-key",eI=eh.Ik({name:eA,description:eh.Yj().max(256,"Description shouldn't be too long").trim()}),ew=()=>{let[e,t]=(0,h.useState)(!1),{ref:s}=(0,l.g)(),r=e=>{t(e)},n=(0,eu.mN)({resolver:(0,ey.u)(eI),defaultValues:{name:"",description:""}}),{mutate:i,isLoading:o}=D(),d=async e=>{i({projectRef:s,type:"secret",name:e.name,description:e.description},{onSuccess:e=>{g.oR.success("Your secret API key ".concat(e.prefix,"... is ready.")),r(!1)}})};return(0,a.jsxs)(ex.lG,{open:e,onOpenChange:r,"data-sentry-element":"Dialog","data-sentry-component":"CreateSecretAPIKeyDialog","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(ex.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)(c.$,{type:"default",className:"mt-2",icon:(0,a.jsx)(eg.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Add new secret key"})}),(0,a.jsxs)(ex.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsxs)(ex.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(ex.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Create new secret API key"}),(0,a.jsx)(ex.rr,{className:"grid gap-y-2","data-sentry-element":"DialogDescription","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)("p",{children:"Secret API keys allow elevated access to your project's data, bypassing Row-Level security."})})]}),(0,a.jsx)(ex.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"}),(0,a.jsxs)(ex.OO,{className:"flex flex-col gap-4","data-sentry-element":"DialogSection","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(em.lV,{...n,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsxs)("form",{className:"flex flex-col gap-4",id:eb,onSubmit:n.handleSubmit(d),children:[(0,a.jsx)(em.zB,{name:"name",control:n.control,render:e=>{let{field:t}=e;return(0,a.jsx)(ef.M,{label:"Name",description:"A short, unique name of lowercased letters, digits and underscore",children:(0,a.jsx)(em.MJ,{children:(0,a.jsx)(j.p,{...t,placeholder:"Example: my_super_secret_key_123"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"},"name"),(0,a.jsx)(em.zB,{name:"description",control:n.control,render:e=>{let{field:t}=e;return(0,a.jsx)(ef.M,{label:"Description",labelOptional:"Optional",children:(0,a.jsx)(em.MJ,{children:(0,a.jsx)(j.p,{...t,placeholder:"Short notes on how or where this key will be used"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"},"description")]})}),(0,a.jsxs)(ep.Fc,{variant:"warning","data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(ej,{"data-sentry-element":"ShieldCheck","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"}),(0,a.jsx)(ep.XL,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Securing your API key"}),(0,a.jsx)(ep.TN,{className:"","data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsxs)("ul",{className:"list-disc",children:[(0,a.jsx)("li",{children:"Keep this key secret."}),(0,a.jsx)("li",{children:"Do not use on the web, in mobile or desktop apps."}),(0,a.jsx)("li",{children:"Don't post it publicly or commit in source control."}),(0,a.jsx)("li",{children:"This key provides elevated access to your data, bypassing Row-Level Security."}),(0,a.jsx)("li",{children:"If it leaks or is revealed, swap it with a new secret API key and then delete it."}),(0,a.jsx)("li",{children:"If used in a browser, it will always return HTTP 401 Unauthorized. Delete immediately."})]})})]})]}),(0,a.jsx)(ex.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)(c.$,{form:eb,htmlType:"submit",loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Create API key"})})]})]})};Z().extend(J()),Z().extend(ee());let ev=()=>{let{ref:e}=(0,l.g)(),{data:t,isLoading:s,error:r}=(0,R.I)({projectRef:e,reveal:!1}),n=!(0,N.Lh)(),i=(0,N.SE)(u.aG.TENANT_SQL_ADMIN_WRITE,"*"),c=function(e){let t=(0,h.useRef)(new Date).current,s=(0,et.A)(e,{iso_timestamp_start:new Date(t.getTime()-864e5).toISOString(),iso_timestamp_end:t.toISOString(),sql:"-- last-used-secret-api-keys\nSELECT unix_millis(max(timestamp)) as timestamp, apikey.`hash` FROM edge_logs cross join unnest(metadata) as m cross join unnest(m.request) as request cross join unnest(request.sb) as sb cross join unnest(sb.apikey) as sbapikey cross join unnest(sbapikey.apikey) as apikey WHERE apikey.error is null and apikey.`hash` is not null and apikey.prefix like 'sb_secret_%' GROUP BY apikey.`hash`"});return(0,h.useMemo)(()=>{if(s.isLoading||!s.logData)return{};let e=Z()();return s.logData.reduce((t,s)=>(t[s.hash]={timestamp:"".concat(Z().duration(e.diff(Z()(s.timestamp))).humanize(!1)," ago")},t),{})},[s])}(e),y=(0,h.useMemo)(()=>{var e;return null!=(e=null==t?void 0:t.filter(e=>"secret"===e.type))?e:[]},[t]),x=(null==y?void 0:y.length)===0&&!s&&!n,m=()=>(0,a.jsxs)(d.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"RowLoading","data-sentry-source-file":"SecretAPIKeys.tsx",children:[(0,a.jsx)(d.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsx)(Y.E,{className:"max-w-12 h-4 rounded-full","data-sentry-element":"Skeleton","data-sentry-source-file":"SecretAPIKeys.tsx"})}),(0,a.jsx)(d.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsx)(Y.E,{className:"max-w-60 h-4 rounded-full","data-sentry-element":"Skeleton","data-sentry-source-file":"SecretAPIKeys.tsx"})}),(0,a.jsx)(d.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsx)(Y.E,{className:"max-w-60 h-4 rounded-full","data-sentry-element":"Skeleton","data-sentry-source-file":"SecretAPIKeys.tsx"})}),(0,a.jsx)(d.nA,{"data-sentry-element":"TableCell","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsx)(Y.E,{className:"w-2 h-4 rounded-full","data-sentry-element":"Skeleton","data-sentry-source-file":"SecretAPIKeys.tsx"})})]}),p=e=>{let{children:t}=e;return(0,a.jsxs)("div",{className:"pb-30","data-sentry-component":"TableContainer","data-sentry-source-file":"SecretAPIKeys.tsx",children:[(0,a.jsx)(W.M,{title:"Secret keys",description:"These API keys allow privileged access to your project's APIs. Use in servers, functions, workers or other backend components of your application.",actions:(0,a.jsx)(ew,{}),"data-sentry-element":"FormHeader","data-sentry-source-file":"SecretAPIKeys.tsx"}),(0,a.jsx)(o.Zp,{className:(0,k.cn)("w-full overflow-hidden",!x&&"bg-surface-100"),"data-sentry-element":"Card","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsx)(o.Wu,{className:"p-0","data-sentry-element":"CardContent","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsxs)(d.XI,{className:"p-5 table-auto","data-sentry-element":"Table","data-sentry-source-file":"SecretAPIKeys.tsx",children:[(0,a.jsx)(d.A0,{"data-sentry-element":"TableHeader","data-sentry-source-file":"SecretAPIKeys.tsx",children:(0,a.jsxs)(d.Hj,{className:(0,k.cn)("bg-200",x&&"hidden"),"data-sentry-element":"TableRow","data-sentry-source-file":"SecretAPIKeys.tsx",children:[(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2","data-sentry-element":"TableHead","data-sentry-source-file":"SecretAPIKeys.tsx",children:"Name"}),(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 pr-0","data-sentry-element":"TableHead","data-sentry-source-file":"SecretAPIKeys.tsx",children:"API Key"}),(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 hidden lg:table-cell","data-sentry-element":"TableHead","data-sentry-source-file":"SecretAPIKeys.tsx",children:"Last Seen"}),(0,a.jsx)(d.nd,{className:"text-right font-mono uppercase text-xs text-foreground-lighter h-auto py-2","data-sentry-element":"TableHead","data-sentry-source-file":"SecretAPIKeys.tsx"})]})}),(0,a.jsx)(d.BF,{className:"","data-sentry-element":"TableBody","data-sentry-source-file":"SecretAPIKeys.tsx",children:t})]})})})]})};return s||n?(0,a.jsxs)(p,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(m,{})]}):i?r?(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"!rounded-b-md overflow-hidden py-12 flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)($.id,{}),(0,a.jsx)("p",{className:"text-sm text-warning-600",children:"Error loading Secret API Keys"}),(0,a.jsx)("p",{className:"text-warning/75",children:r.message})]})}):x?(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"!rounded-b-md overflow-hidden py-12 flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No secret API keys found"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project is not accessible via secret keys—there are no active secret keys created."})]})}):(0,a.jsx)(p,{"data-sentry-element":"TableContainer","data-sentry-component":"SecretAPIKeys","data-sentry-source-file":"SecretAPIKeys.tsx",children:y.map(e=>(0,a.jsx)(ec,{apiKey:e,lastSeen:c[e.hash]},e.id))}):(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"!rounded-b-md overflow-hidden py-12 flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)($.aR,{}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:"You do not have permission to read API Secret Keys"}),(0,a.jsx)("p",{className:"text-foreground-light",children:"Contact your organization owner/admin to request access."})]})})};var eP=s(73794),eN=s(4649),ek=s(17835);let eK=(0,h.forwardRef)((e,t)=>{let{disabled:s,style:r,className:n,...l}=e;return(0,a.jsx)("div",{ref:t,...l,className:(0,k.cn)(s&&"opacity-50 pointer-events-none",n),style:{...s&&{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},...r}})});eK.displayName="DisableInteraction";let eS=()=>{let{isInRollout:e,shouldDisableUI:t,canInitApiKeys:s}=F();return(0,a.jsxs)(a.Fragment,{children:[!e&&(0,a.jsx)(z,{}),s&&(0,a.jsx)(q,{}),(0,a.jsx)(O,{"data-sentry-element":"ApiKeysFeedbackBanner","data-sentry-source-file":"new.tsx"}),(0,a.jsxs)(eK,{disabled:t,className:"flex flex-col gap-8","data-sentry-element":"DisableInteraction","data-sentry-source-file":"new.tsx",children:[(0,a.jsx)(U,{"data-sentry-element":"PublishableAPIKeys","data-sentry-source-file":"new.tsx"}),(0,a.jsx)(y.w,{"data-sentry-element":"Separator","data-sentry-source-file":"new.tsx"}),(0,a.jsx)(ev,{"data-sentry-element":"SecretAPIKeys","data-sentry-source-file":"new.tsx"})]})]})};eS.getLayout=e=>(0,a.jsx)(eN.A,{children:(0,a.jsx)(ek.A,{children:(0,a.jsx)(eP.A,{children:e})})});let eC=eS},99332:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/api-keys/new",function(){return s(92765)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[89,8345,2491,3730,5982,6110,1185,5599,2041,1018,2409,4297,236,4515,1674,4942,2981,9480,4711,6137,4560,7795,3895,4109,2667,9846,2156,5500,4649,7104,3133,2865,7820,6593,636,8792],()=>t(99332)),_N_E=e.O()}]);